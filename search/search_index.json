{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Celery Notes","text":"<p>\u6b61\u8fce\u4f86\u5230 Celery Notes\uff0c\u9019\u662f\u4e00\u500b\u95dc\u65bc Celery\u3001RabbitMQ\u3001Celery Beat \u548c Kombu \u7684\u5168\u9762\u5b78\u7fd2\u7b46\u8a18\u3002\u7121\u8ad6\u60a8\u662f\u60f3\u4e86\u89e3\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u9084\u662f\u6df1\u5165\u61c9\u7528\u7570\u6b65\u8655\u7406\u6280\u8853\uff0c\u672c\u7b46\u8a18\u5c07\u70ba\u60a8\u63d0\u4f9b\u7cfb\u7d71\u5316\u7684\u5b78\u7fd2\u8cc7\u6e90\u3002</p>"},{"location":"#_1","title":"\u5b78\u7fd2\u8def\u5f91","text":"<p>\u672c\u7b46\u8a18\u6309\u7167\u4ee5\u4e0b\u5b78\u7fd2\u8def\u5f91\u7d44\u7e54\uff1a</p> <ol> <li>\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u57fa\u790e - \u4e86\u89e3\u7570\u6b65\u8655\u7406\u548c\u6d88\u606f\u968a\u5217\u7684\u57fa\u672c\u6982\u5ff5</li> <li>RabbitMQ \u6838\u5fc3 - \u6df1\u5165\u5b78\u7fd2 RabbitMQ \u7684\u5de5\u4f5c\u539f\u7406\u548c\u914d\u7f6e</li> <li>Celery \u57fa\u790e - \u638c\u63e1 Celery \u7684\u6838\u5fc3\u529f\u80fd\u548c\u7528\u6cd5</li> <li>Celery \u9032\u968e\u529f\u80fd - \u5b78\u7fd2 Celery \u7684\u9ad8\u7d1a\u7279\u6027\u548c\u5de5\u4f5c\u6d41</li> <li>Celery Beat - \u7406\u89e3\u548c\u914d\u7f6e\u5b9a\u6642\u4efb\u52d9</li> <li>Kombu \u6df1\u5165\u5b78\u7fd2 - \u63a2\u7d22 Kombu \u7684\u67b6\u69cb\u548c\u81ea\u5b9a\u7fa9\u529f\u80fd</li> <li>\u6574\u5408\u8207\u6700\u4f73\u5be6\u8e10 - \u5b78\u7fd2\u5982\u4f55\u5c07\u9019\u4e9b\u6280\u8853\u6574\u5408\u5230\u5be6\u969b\u9805\u76ee\u4e2d</li> <li>\u9032\u968e\u4e3b\u984c\u8207\u5be6\u6230 - \u8655\u7406\u8907\u96dc\u5834\u666f\u548c\u5927\u898f\u6a21\u90e8\u7f72</li> </ol>"},{"location":"#_2","title":"\u5982\u4f55\u4f7f\u7528\u672c\u7b46\u8a18","text":"<ul> <li>\u6309\u7167\u9806\u5e8f\u5b78\u7fd2\uff0c\u9010\u6b65\u6df1\u5165</li> <li>\u6bcf\u500b\u7ae0\u7bc0\u90fd\u5305\u542b\u7406\u8ad6\u77e5\u8b58\u548c\u5be6\u8e10\u793a\u4f8b</li> <li>\u4ee3\u78bc\u793a\u4f8b\u53ef\u4ee5\u76f4\u63a5\u8907\u88fd\u4f7f\u7528</li> <li>\u9047\u5230\u554f\u984c\u53ef\u4ee5\u53c3\u8003\u9644\u9304\u4e2d\u7684\u5e38\u898b\u554f\u984c\u89e3\u7b54</li> </ul>"},{"location":"#_3","title":"\u74b0\u5883\u8981\u6c42","text":"<ul> <li>Python 3.7+</li> <li>RabbitMQ 3.8+</li> <li>Celery 5.0+</li> </ul> <p>\u63d0\u793a\uff1a\u6709\u95dc\u74b0\u5883\u8a2d\u7f6e\u7684\u8a73\u7d30\u6307\u5357\uff0c\u8acb\u53c3\u95b1\u300cRabbitMQ \u5b89\u88dd\u8207\u914d\u7f6e\u300d\u53ca\u300cCelery \u57fa\u790e\u300d\u7ae0\u7bc0\u3002</p>"},{"location":"advanced/","title":"\u9032\u968e\u4e3b\u984c\u8207\u5be6\u6230","text":"<p>\u5728\u638c\u63e1\u4e86 Celery\u3001Kombu \u548c RabbitMQ \u7684\u57fa\u790e\u77e5\u8b58\u4ee5\u53ca\u6574\u5408\u6700\u4f73\u5be6\u8e10\u5f8c\uff0c\u662f\u6642\u5019\u6df1\u5165\u63a2\u8a0e\u9019\u4e9b\u5de5\u5177\u5728\u66f4\u8907\u96dc\u5834\u666f\u4e2d\u7684\u61c9\u7528\u3002\u672c\u90e8\u5206\u5c07\u5e36\u60a8\u9032\u5165\u9032\u968e\u4e3b\u984c\uff0c\u6db5\u84cb\u5982\u4f55\u5728\u8907\u96dc\u696d\u52d9\u5834\u666f\u4e2d\u4f7f\u7528\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u3001\u5982\u4f55\u5728\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u6574\u5408\u9019\u4e9b\u5de5\u5177\uff0c\u4ee5\u53ca\u5982\u4f55\u5728\u5927\u898f\u6a21\u90e8\u7f72\u548c\u5bb9\u5668\u5316\u74b0\u5883\u4e2d\u61c9\u7528\u5b83\u5011\u3002</p> <p>\u672c\u7ae0\u7bc0\u9069\u5408\u6709\u4e00\u5b9a\u57fa\u790e\u7684\u958b\u767c\u8005\u548c\u67b6\u69cb\u5e2b\uff0c\u65e8\u5728\u5e6b\u52a9\u60a8\u89e3\u6c7a\u5be6\u969b\u9805\u76ee\u4e2d\u7684\u6311\u6230\uff0c\u4e26\u5c07\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u6f5b\u529b\u767c\u63ee\u5230\u6975\u81f4\u3002\u4ee5\u4e0b\u662f\u672c\u90e8\u5206\u7684\u5167\u5bb9\u6982\u89bd\uff1a</p>"},{"location":"advanced/#_2","title":"\u5167\u5bb9\u5c0e\u89bd","text":"<ul> <li>\u8907\u96dc\u696d\u52d9\u5834\u666f\u5be6\u73fe</li> <li>\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u7684\u61c9\u7528</li> <li>\u5927\u898f\u6a21\u90e8\u7f72</li> <li>\u5bb9\u5668\u5316\u8207 Kubernetes \u90e8\u7f72</li> </ul>"},{"location":"advanced/complex-business-scenarios/","title":"\u8907\u96dc\u696d\u52d9\u5834\u666f\u5be6\u73fe","text":"<p>\u5728\u5be6\u969b\u9805\u76ee\u4e2d\uff0c\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u5f80\u5f80\u9700\u8981\u61c9\u5c0d\u8907\u96dc\u7684\u696d\u52d9\u9700\u6c42\uff0c\u4f8b\u5982\u591a\u6b65\u9a5f\u5de5\u4f5c\u6d41\u3001\u4efb\u52d9\u4f9d\u8cf4\u7ba1\u7406\u3001\u52d5\u614b\u4efb\u52d9\u8abf\u5ea6\u7b49\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 Celery\u3001Kombu \u548c RabbitMQ \u5be6\u73fe\u9019\u4e9b\u8907\u96dc\u696d\u52d9\u5834\u666f\uff0c\u4e26\u63d0\u4f9b\u5177\u9ad4\u7684\u4ee3\u78bc\u793a\u4f8b\u548c\u6700\u4f73\u5be6\u8e10\u3002</p>"},{"location":"advanced/complex-business-scenarios/#_2","title":"\u591a\u6b65\u9a5f\u5de5\u4f5c\u6d41\u5be6\u73fe","text":"<p>\u8a31\u591a\u696d\u52d9\u5834\u666f\u9700\u8981\u591a\u500b\u4efb\u52d9\u6309\u9806\u5e8f\u6216\u4e26\u884c\u57f7\u884c\uff0c\u5f62\u6210\u4e00\u500b\u5b8c\u6574\u7684\u5de5\u4f5c\u6d41\u3002Celery \u63d0\u4f9b\u4e86 <code>chain</code>\u3001<code>group</code> \u548c <code>chord</code> \u7b49\u5de5\u5177\u4f86\u5be6\u73fe\u9019\u985e\u9700\u6c42\u3002</p>"},{"location":"advanced/complex-business-scenarios/#chain","title":"\u4f7f\u7528 <code>chain</code> \u5be6\u73fe\u9806\u5e8f\u4efb\u52d9","text":"<p>\u7576\u4efb\u52d9\u9700\u8981\u6309\u7279\u5b9a\u9806\u5e8f\u57f7\u884c\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>chain</code> \u5c07\u591a\u500b\u4efb\u52d9\u4e32\u806f\u8d77\u4f86\uff1a</p> <pre><code>from celery import chain\n\n# \u5b9a\u7fa9\u4e00\u500b\u5de5\u4f5c\u6d41\uff1a\u5148\u8655\u7406\u6578\u64da\uff0c\u7136\u5f8c\u767c\u9001\u901a\u77e5\nworkflow = chain(process_data.s(data), send_notification.s())\nresult = workflow.apply_async()\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_3","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u6bcf\u500b\u4efb\u52d9\u7684\u8f38\u51fa\u683c\u5f0f\u8207\u4e0b\u4e00\u500b\u4efb\u52d9\u7684\u8f38\u5165\u683c\u5f0f\u517c\u5bb9\u3002</li> <li>\u4f7f\u7528 <code>link_error</code> \u8a2d\u5b9a\u932f\u8aa4\u56de\u8abf\uff0c\u8655\u7406\u5de5\u4f5c\u6d41\u4e2d\u65b7\u7684\u60c5\u6cc1\uff1a</li> </ul> <pre><code>workflow = chain(process_data.s(data), send_notification.s()).on_error(handle_error.s())\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#group","title":"\u4f7f\u7528 <code>group</code> \u5be6\u73fe\u4e26\u884c\u4efb\u52d9","text":"<p>\u7576\u591a\u500b\u4efb\u52d9\u53ef\u4ee5\u4e26\u884c\u57f7\u884c\u6642\uff0c\u4f7f\u7528 <code>group</code> \u4f86\u63d0\u9ad8\u6548\u7387\uff1a</p> <pre><code>from celery import group\n\n# \u4e26\u884c\u8655\u7406\u591a\u500b\u6578\u64da\u96c6\ntasks = group(process_data.s(data) for data in datasets)\nresult = tasks.apply_async()\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_4","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u4e26\u884c\u4efb\u52d9\u4e4b\u9593\u7121\u4f9d\u8cf4\u95dc\u4fc2\uff0c\u907f\u514d\u7af6\u722d\u689d\u4ef6\u3002</li> <li>\u76e3\u63a7\u4e26\u884c\u4efb\u52d9\u7684\u8cc7\u6e90\u4f7f\u7528\uff0c\u907f\u514d\u904e\u8f09\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#chord","title":"\u4f7f\u7528 <code>chord</code> \u5be6\u73fe\u805a\u5408\u4efb\u52d9","text":"<p>\u7576\u4e00\u7d44\u4efb\u52d9\u5b8c\u6210\u5f8c\u9700\u8981\u57f7\u884c\u4e00\u500b\u805a\u5408\u4efb\u52d9\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>chord</code>\uff1a</p> <pre><code>from celery import chord\n\n# \u4e00\u7d44\u4efb\u52d9\u5b8c\u6210\u5f8c\u57f7\u884c\u532f\u7e3d\nworkflow = chord(\n    [process_data.s(data) for data in datasets],\n    aggregate_results.s()\n)\nresult = workflow.apply_async()\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_5","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u805a\u5408\u4efb\u52d9\u80fd\u8655\u7406\u6240\u6709\u5b50\u4efb\u52d9\u7684\u7d50\u679c\uff0c\u5305\u62ec\u90e8\u5206\u5931\u6557\u7684\u60c5\u6cc1\u3002</li> <li>\u8a2d\u5b9a\u5408\u7406\u7684\u8d85\u6642\u6642\u9593\uff0c\u907f\u514d\u56e0\u55ae\u500b\u4efb\u52d9\u5ef6\u9072\u5c0e\u81f4\u6574\u500b\u5de5\u4f5c\u6d41\u5361\u4f4f\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#_6","title":"\u4efb\u52d9\u4f9d\u8cf4\u7ba1\u7406","text":"<p>\u5728\u8907\u96dc\u696d\u52d9\u4e2d\uff0c\u4efb\u52d9\u4e4b\u9593\u5f80\u5f80\u5b58\u5728\u4f9d\u8cf4\u95dc\u4fc2\uff0c\u4f8b\u5982\u4efb\u52d9 B \u5fc5\u9808\u5728\u4efb\u52d9 A \u5b8c\u6210\u5f8c\u624d\u80fd\u57f7\u884c\u3002</p>"},{"location":"advanced/complex-business-scenarios/#_7","title":"\u52d5\u614b\u4efb\u52d9\u4f9d\u8cf4","text":"<p>\u4f7f\u7528 Celery \u7684\u7d50\u679c\u5f8c\u7aef\u8ffd\u8e64\u4efb\u52d9\u72c0\u614b\uff0c\u5be6\u73fe\u52d5\u614b\u4f9d\u8cf4\uff1a</p> <pre><code>from celery import Celery\n\napp = Celery('tasks', broker='amqp://localhost', backend='rpc://')\n\n@app.task\ndef task_a():\n    # \u57f7\u884c\u4efb\u52d9 A\n    return \"Task A completed\"\n\n@app.task\ndef task_b(dependency_result):\n    # \u4f9d\u8cf4\u4efb\u52d9 A \u7684\u7d50\u679c\n    print(f\"Task B received: {dependency_result}\")\n    return \"Task B completed\"\n\n# \u8abf\u7528\u6642\u9023\u63a5\u4efb\u52d9\nresult_a = task_a.delay()\nresult_a.get()  # \u7b49\u5f85\u4efb\u52d9 A \u5b8c\u6210\ntask_b.delay(result_a.get())\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_8","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u7d50\u679c\u5f8c\u7aef\u5132\u5b58\u4efb\u52d9\u72c0\u614b\uff0c\u907f\u514d\u76f4\u63a5\u963b\u585e\u7b49\u5f85\u7d50\u679c\u3002</li> <li>\u70ba\u95dc\u9375\u4f9d\u8cf4\u4efb\u52d9\u8a2d\u5b9a\u91cd\u8a66\u6a5f\u5236\uff0c\u78ba\u4fdd\u53ef\u9760\u6027\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#canvas","title":"\u4f7f\u7528 Canvas \u8a2d\u8a08\u8907\u96dc\u4f9d\u8cf4","text":"<p>Celery \u7684 Canvas \u6a21\u7d44\u5141\u8a31\u8a2d\u8a08\u66f4\u8907\u96dc\u7684\u4efb\u52d9\u4f9d\u8cf4\u5716\uff1a</p> <pre><code>from celery.canvas import chain, group\n\n# \u8a2d\u8a08\u4e00\u500b\u8907\u96dc\u5de5\u4f5c\u6d41\nworkflow = chain(\n    task_a.s(),\n    group(task_b1.s(), task_b2.s()),\n    task_c.s()\n)\nresult = workflow.apply_async()\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_9","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c07\u8907\u96dc\u5de5\u4f5c\u6d41\u62c6\u5206\u6210\u5c0f\u6a21\u584a\uff0c\u65b9\u4fbf\u6e2c\u8a66\u548c\u8abf\u8a66\u3002</li> <li>\u4f7f\u7528\u65e5\u8a8c\u8a18\u9304\u6bcf\u500b\u4efb\u52d9\u7684\u57f7\u884c\u72c0\u614b\uff0c\u65b9\u4fbf\u6392\u67e5\u554f\u984c\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#_10","title":"\u52d5\u614b\u4efb\u52d9\u8abf\u5ea6","text":"<p>\u696d\u52d9\u9700\u6c42\u53ef\u80fd\u8981\u6c42\u6839\u64da\u689d\u4ef6\u52d5\u614b\u8abf\u5ea6\u4efb\u52d9\uff0c\u4f8b\u5982\u6839\u64da\u7528\u6236\u884c\u70ba\u89f8\u767c\u4e0d\u540c\u4efb\u52d9\u3002</p>"},{"location":"advanced/complex-business-scenarios/#_11","title":"\u689d\u4ef6\u89f8\u767c\u4efb\u52d9","text":"<p>\u6839\u64da\u696d\u52d9\u908f\u8f2f\u52d5\u614b\u9078\u64c7\u4efb\u52d9\uff1a</p> <pre><code>@app.task\ndef route_task(user_data):\n    if user_data['type'] == 'premium':\n        premium_task.delay(user_data)\n    else:\n        standard_task.delay(user_data)\n    return \"Task routed\"\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_12","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c07\u8def\u7531\u908f\u8f2f\u8207\u5177\u9ad4\u4efb\u52d9\u5206\u96e2\uff0c\u4fdd\u6301\u4ee3\u78bc\u6e05\u6670\u3002</li> <li>\u8a18\u9304\u8def\u7531\u6c7a\u7b56\uff0c\u65b9\u4fbf\u5206\u6790\u696d\u52d9\u908f\u8f2f\u662f\u5426\u6b63\u78ba\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#_13","title":"\u57fa\u65bc\u6642\u9593\u7684\u8abf\u5ea6","text":"<p>\u4f7f\u7528 Celery Beat \u5be6\u73fe\u57fa\u65bc\u6642\u9593\u7684\u4efb\u52d9\u8abf\u5ea6\uff1a</p> <pre><code>pip install celery[redis] django-celery-beat\n</code></pre> <p>\u8a2d\u5b9a\u5b9a\u6642\u4efb\u52d9\uff08\u5047\u8a2d\u4f7f\u7528 Django\uff09\uff1a</p> <pre><code>from celery.schedules import crontab\nfrom django_celery_beat.models import PeriodicTask, CrontabSchedule\n\n# \u5275\u5efa\u4e00\u500b\u6bcf\u5c0f\u6642\u57f7\u884c\u7684\u4efb\u52d9\nschedule, _ = CrontabSchedule.objects.get_or_create(\n    minute='0',\n    hour='*',\n    day_of_week='*',\n    day_of_month='*',\n    month_of_year='*',\n)\nPeriodicTask.objects.create(\n    crontab=schedule,\n    name='hourly_task',\n    task='your_app.tasks.hourly_task',\n)\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_14","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u907f\u514d\u5b9a\u6642\u4efb\u52d9\u904e\u65bc\u983b\u7e41\uff0c\u9632\u6b62\u8cc7\u6e90\u722d\u7528\u3002</li> <li>\u70ba\u5b9a\u6642\u4efb\u52d9\u8a2d\u5b9a\u76e3\u63a7\uff0c\u78ba\u4fdd\u6309\u6642\u57f7\u884c\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#_15","title":"\u5206\u5e03\u5f0f\u9396\u8207\u8cc7\u6e90\u7af6\u722d","text":"<p>\u5728\u5206\u6563\u5f0f\u74b0\u5883\u4e2d\uff0c\u591a\u500b Worker \u53ef\u80fd\u540c\u6642\u8655\u7406\u76f8\u540c\u8cc7\u6e90\uff0c\u9700\u4f7f\u7528\u9396\u6a5f\u5236\u907f\u514d\u7af6\u722d\u3002</p>"},{"location":"advanced/complex-business-scenarios/#redis","title":"\u4f7f\u7528 Redis \u5be6\u73fe\u5206\u5e03\u5f0f\u9396","text":"<p>\u4f7f\u7528 Redis \u4f5c\u70ba\u9396\u5f8c\u7aef\uff0c\u78ba\u4fdd\u4efb\u52d9\u9593\u8cc7\u6e90\u5b89\u5168\uff1a</p> <pre><code>from redis import Redis\nfrom time import sleep\n\nredis = Redis(host='localhost', port=6379, db=0)\n\n@app.task\ndef critical_task(resource_id):\n    lock_key = f\"lock:{resource_id}\"\n    # \u5617\u8a66\u7372\u53d6\u9396\n    if redis.setnx(lock_key, 1):\n        try:\n            redis.expire(lock_key, 30)  # \u8a2d\u5b9a\u9396\u904e\u671f\u6642\u9593\n            # \u57f7\u884c\u95dc\u9375\u64cd\u4f5c\n            sleep(5)  # \u6a21\u64ec\u9577\u6642\u9593\u64cd\u4f5c\n            return \"Task completed\"\n        finally:\n            redis.delete(lock_key)  # \u91cb\u653e\u9396\n    else:\n        return \"Resource locked, task skipped\"\n</code></pre>"},{"location":"advanced/complex-business-scenarios/#_16","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u9396\u7684\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u6b7b\u9396\u3002</li> <li>\u4f7f\u7528 <code>finally</code> \u78ba\u4fdd\u9396\u91cb\u653e\uff0c\u5373\u4f7f\u4efb\u52d9\u5931\u6557\u3002</li> </ul>"},{"location":"advanced/complex-business-scenarios/#_17","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u5de5\u4f5c\u6d41\u8a2d\u8a08\uff1a\u4f7f\u7528 <code>chain</code>\u3001<code>group</code> \u548c <code>chord</code> \u5be6\u73fe\u591a\u6b65\u9a5f\u696d\u52d9\u908f\u8f2f\uff0c\u78ba\u4fdd\u6e05\u6670\u548c\u53ef\u7dad\u8b77\u3002</li> <li>\u4f9d\u8cf4\u7ba1\u7406\uff1a\u52d5\u614b\u8655\u7406\u4efb\u52d9\u4f9d\u8cf4\uff0c\u7d50\u5408\u7d50\u679c\u5f8c\u7aef\u548c Canvas \u6a21\u7d44\u61c9\u5c0d\u8907\u96dc\u5834\u666f\u3002</li> <li>\u52d5\u614b\u8abf\u5ea6\uff1a\u6839\u64da\u696d\u52d9\u689d\u4ef6\u548c\u6642\u9593\u52d5\u614b\u8abf\u5ea6\u4efb\u52d9\uff0c\u63d0\u5347\u9748\u6d3b\u6027\u3002</li> <li>\u8cc7\u6e90\u5b89\u5168\uff1a\u4f7f\u7528\u5206\u5e03\u5f0f\u9396\u907f\u514d\u7af6\u722d\uff0c\u78ba\u4fdd\u6578\u64da\u4e00\u81f4\u6027\u3002</li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u61c9\u5c0d\u8907\u96dc\u696d\u52d9\u5834\u666f\uff0c\u5c07 Celery \u548c RabbitMQ \u7684\u80fd\u529b\u61c9\u7528\u5230\u5be6\u969b\u9805\u76ee\u4e2d\u3002</p>"},{"location":"advanced/containerization-kubernetes/","title":"\u5bb9\u5668\u5316\u8207 Kubernetes \u90e8\u7f72","text":"<p>\u5bb9\u5668\u5316\u6280\u8853\uff08\u5982 Docker\uff09\u548c\u5bb9\u5668\u7de8\u6392\u5de5\u5177\uff08\u5982 Kubernetes\uff09\u662f\u5927\u898f\u6a21\u90e8\u7f72\u548c\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u7684\u91cd\u8981\u5de5\u5177\u3002Celery\u3001Kombu \u548c RabbitMQ \u53ef\u4ee5\u901a\u904e\u5bb9\u5668\u5316\u5be6\u73fe\u9748\u6d3b\u7684\u90e8\u7f72\u548c\u7ba1\u7406\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u5c07\u9019\u4e9b\u5de5\u5177\u5bb9\u5668\u5316\uff0c\u4e26\u5728 Kubernetes \u4e0a\u9032\u884c\u90e8\u7f72\uff0c\u63d0\u4f9b\u5177\u9ad4\u6b65\u9a5f\u548c\u6700\u4f73\u5be6\u8e10\u3002</p>"},{"location":"advanced/containerization-kubernetes/#_1","title":"\u5bb9\u5668\u5316\u7684\u512a\u52e2","text":"<p>\u5bb9\u5668\u5316\u70ba\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\u5e36\u4f86\u4ee5\u4e0b\u512a\u52e2\uff1a - \u4e00\u81f4\u6027\uff1a\u958b\u767c\u3001\u6e2c\u8a66\u548c\u751f\u7522\u74b0\u5883\u4e00\u81f4\uff0c\u907f\u514d\u74b0\u5883\u5dee\u7570\u3002 - \u53ef\u79fb\u690d\u6027\uff1a\u5bb9\u5668\u53ef\u4ee5\u5728\u4efb\u4f55\u652f\u6301 Docker \u7684\u5e73\u53f0\u4e0a\u904b\u884c\u3002 - \u8cc7\u6e90\u9694\u96e2\uff1a\u6bcf\u500b\u5bb9\u5668\u7368\u7acb\u904b\u884c\uff0c\u907f\u514d\u8cc7\u6e90\u722d\u7528\u3002 - \u5feb\u901f\u90e8\u7f72\uff1a\u901a\u904e\u6620\u50cf\u5feb\u901f\u555f\u52d5\u548c\u64f4\u5c55\u670d\u52d9\u3002</p>"},{"location":"advanced/containerization-kubernetes/#docker","title":"Docker \u5bb9\u5668\u5316","text":"<p>\u9996\u5148\uff0c\u6211\u5011\u9700\u8981\u70ba Celery\u3001RabbitMQ \u548c\u76f8\u95dc\u7d44\u4ef6\u5275\u5efa Docker \u6620\u50cf\u3002</p>"},{"location":"advanced/containerization-kubernetes/#rabbitmq","title":"RabbitMQ \u5bb9\u5668\u5316","text":"<p>\u4f7f\u7528\u5b98\u65b9 RabbitMQ \u6620\u50cf\uff0c\u914d\u7f6e\u6301\u4e45\u5316\u548c\u96c6\u7fa4\u652f\u6301\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#dockerfile","title":"Dockerfile \u793a\u4f8b","text":"<pre><code>FROM rabbitmq:3.9-management\n\n# \u555f\u7528\u7ba1\u7406\u63d2\u4ef6\nRUN rabbitmq-plugins enable --offline rabbitmq_management\n\n# \u914d\u7f6e\u6301\u4e45\u5316\u76ee\u9304\nVOLUME /var/lib/rabbitmq\n\n# \u66b4\u9732\u7aef\u53e3\nEXPOSE 5672 15672\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_2","title":"\u555f\u52d5\u5bb9\u5668","text":"<pre><code>docker run -d --name rabbitmq \\\n  -p 5672:5672 -p 15672:15672 \\\n  -v rabbitmq-data:/var/lib/rabbitmq \\\n  rabbitmq-image\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_3","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u5377\uff08Volume\uff09\u6301\u4e45\u5316\u6578\u64da\uff0c\u907f\u514d\u5bb9\u5668\u91cd\u555f\u5c0e\u81f4\u6578\u64da\u4e1f\u5931\u3002</li> <li>\u914d\u7f6e\u74b0\u5883\u8b8a\u6578\u8a2d\u5b9a\u7528\u6236\u548c\u5bc6\u78bc\uff1a</li> </ul> <pre><code>docker run -d --name rabbitmq \\\n  -e RABBITMQ_DEFAULT_USER=user \\\n  -e RABBITMQ_DEFAULT_PASS=password \\\n  rabbitmq-image\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#celery-worker","title":"Celery Worker \u5bb9\u5668\u5316","text":"<p>\u70ba Celery Worker \u5275\u5efa\u81ea\u5b9a\u7fa9 Docker \u6620\u50cf\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#dockerfile_1","title":"Dockerfile \u793a\u4f8b","text":"<pre><code>FROM python:3.9-slim\n\n# \u5b89\u88dd\u4f9d\u8cf4\nRUN pip install celery kombu redis\n\n# \u8907\u88fd\u61c9\u7528\u7a0b\u5f0f\u4ee3\u78bc\nWORKDIR /app\nCOPY . /app\n\n# \u555f\u52d5 Worker\nCMD [\"celery\", \"-A\", \"your_module\", \"worker\", \"--concurrency=4\", \"--loglevel=info\"]\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_4","title":"\u555f\u52d5\u5bb9\u5668","text":"<pre><code>docker run -d --name celery-worker \\\n  --link rabbitmq:rabbitmq \\\n  -e CELERY_BROKER_URL=amqp://user:password@rabbitmq:5672// \\\n  celery-worker-image\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_5","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 <code>--link</code> \u6216\u81ea\u5b9a\u7fa9\u7db2\u7d61\u9023\u63a5 RabbitMQ \u5bb9\u5668\u3002</li> <li>\u6839\u64da\u786c\u9ad4\u8cc7\u6e90\u8abf\u6574 <code>concurrency</code> \u53c3\u6578\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#docker-compose","title":"\u4f7f\u7528 Docker Compose \u7ba1\u7406\u591a\u5bb9\u5668","text":"<p>\u4f7f\u7528 Docker Compose \u7ba1\u7406 RabbitMQ\u3001Celery Worker \u548c\u7d50\u679c\u5f8c\u7aef\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#docker-composeyml","title":"docker-compose.yml \u793a\u4f8b","text":"<pre><code>version: '3'\nservices:\n  rabbitmq:\n    image: rabbitmq:3.9-management\n    ports:\n      - \"5672:5672\"\n      - \"15672:15672\"\n    volumes:\n      - rabbitmq-data:/var/lib/rabbitmq\n    environment:\n      - RABBITMQ_DEFAULT_USER=user\n      - RABBITMQ_DEFAULT_PASS=password\n\n  redis:\n    image: redis:6.2\n    ports:\n      - \"6379:6379\"\n\n  celery-worker:\n    build: .\n    depends_on:\n      - rabbitmq\n      - redis\n    environment:\n      - CELERY_BROKER_URL=amqp://user:password@rabbitmq:5672//\n      - CELERY_RESULT_BACKEND=redis://redis:6379/0\n    command: [\"celery\", \"-A\", \"your_module\", \"worker\", \"--concurrency=4\"]\n\nvolumes:\n  rabbitmq-data:\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_6","title":"\u555f\u52d5\u670d\u52d9","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_7","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 <code>depends_on</code> \u78ba\u4fdd\u670d\u52d9\u555f\u52d5\u9806\u5e8f\u3002</li> <li>\u5b9a\u7fa9\u5377\u548c\u7db2\u7d61\uff0c\u78ba\u4fdd\u6578\u64da\u6301\u4e45\u5316\u548c\u5bb9\u5668\u9593\u901a\u4fe1\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#kubernetes_1","title":"Kubernetes \u90e8\u7f72","text":"<p>Kubernetes \u63d0\u4f9b\u5bb9\u5668\u7de8\u6392\u529f\u80fd\uff0c\u9069\u5408\u5927\u898f\u6a21\u90e8\u7f72\u548c\u7ba1\u7406 Celery \u8207 RabbitMQ\u3002</p>"},{"location":"advanced/containerization-kubernetes/#rabbitmq-kubernetes","title":"RabbitMQ \u5728 Kubernetes \u4e0a\u90e8\u7f72","text":"<p>\u4f7f\u7528 StatefulSet \u90e8\u7f72 RabbitMQ \u96c6\u7fa4\uff0c\u78ba\u4fdd\u6578\u64da\u6301\u4e45\u5316\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#rabbitmq-statefulset","title":"RabbitMQ StatefulSet \u793a\u4f8b","text":"<pre><code>apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: rabbitmq\nspec:\n  serviceName: rabbitmq\n  replicas: 3\n  selector:\n    matchLabels:\n      app: rabbitmq\n  template:\n    metadata:\n      labels:\n        app: rabbitmq\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.9-management\n        ports:\n        - containerPort: 5672\n        - containerPort: 15672\n        env:\n        - name: RABBITMQ_ERLANG_COOKIE\n          value: \"secret-cookie\"\n        volumeMounts:\n        - name: rabbitmq-data\n          mountPath: /var/lib/rabbitmq\n  volumeClaimTemplates:\n  - metadata:\n      name: rabbitmq-data\n    spec:\n      accessModes: [\"ReadWriteOnce\"]\n      resources:\n        requests:\n          storage: 10Gi\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\nspec:\n  selector:\n    app: rabbitmq\n  ports:\n  - port: 5672\n    targetPort: 5672\n    name: amqp\n  - port: 15672\n    targetPort: 15672\n    name: management\n  clusterIP: None  # Headless Service for StatefulSet\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_8","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 StatefulSet \u78ba\u4fdd RabbitMQ \u7bc0\u9ede\u7a69\u5b9a\u6027\u548c\u9806\u5e8f\u555f\u52d5\u3002</li> <li>\u914d\u7f6e\u6301\u4e45\u5316\u5377\uff08PVC\uff09\u5132\u5b58\u6578\u64da\uff0c\u907f\u514d Pod \u91cd\u555f\u5c0e\u81f4\u6578\u64da\u4e1f\u5931\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#celery-worker-kubernetes","title":"Celery Worker \u5728 Kubernetes \u4e0a\u90e8\u7f72","text":"<p>\u4f7f\u7528 Deployment \u90e8\u7f72 Celery Worker\uff0c\u652f\u6301\u81ea\u52d5\u64f4\u5c55\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#celery-worker-deployment","title":"Celery Worker Deployment \u793a\u4f8b","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: celery-worker\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: celery-worker\n  template:\n    metadata:\n      labels:\n        app: celery-worker\n    spec:\n      containers:\n      - name: celery-worker\n        image: your-celery-image:latest\n        env:\n        - name: CELERY_BROKER_URL\n          value: \"amqp://user:password@rabbitmq:5672//\"\n        - name: CELERY_RESULT_BACKEND\n          value: \"redis://redis:6379/0\"\n        resources:\n          limits:\n            cpu: \"1\"\n            memory: \"512Mi\"\n          requests:\n            cpu: \"0.5\"\n            memory: \"256Mi\"\n        command: [\"celery\", \"-A\", \"your_module\", \"worker\", \"--concurrency=4\"]\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: celery-worker\nspec:\n  selector:\n    app: celery-worker\n  ports:\n  - port: 80\n    targetPort: 80\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_9","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u8cc7\u6e90\u9650\u5236\uff08<code>resources</code>\uff09\uff0c\u907f\u514d Worker \u904e\u8f09 Kubernetes \u7bc0\u9ede\u3002</li> <li>\u4f7f\u7528 HorizontalPodAutoscaler\uff08HPA\uff09\u6839\u64da CPU \u6216\u968a\u5217\u9577\u5ea6\u81ea\u52d5\u64f4\u5c55\uff1a</li> </ul> <pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: celery-worker-hpa\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: celery-worker\n  minReplicas: 3\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: Utilization\n        averageUtilization: 70\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#redis-kubernetes","title":"Redis \u7d50\u679c\u5f8c\u7aef\u5728 Kubernetes \u4e0a\u90e8\u7f72","text":"<p>\u4f7f\u7528 Helm Chart \u5feb\u901f\u90e8\u7f72 Redis \u96c6\u7fa4\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#_10","title":"\u90e8\u7f72\u6b65\u9a5f","text":"<ol> <li>\u5b89\u88dd Helm\uff08\u5982\u679c\u672a\u5b89\u88dd\uff09\uff1a    <pre><code>curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash\n</code></pre></li> <li>\u4f7f\u7528 Helm \u5b89\u88dd Redis\uff1a    <pre><code>helm repo add bitnami https://charts.bitnami.com/bitnami\nhelm install redis bitnami/redis --set architecture=cluster\n</code></pre></li> </ol>"},{"location":"advanced/containerization-kubernetes/#_11","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 Redis \u96c6\u7fa4\u6a21\u5f0f\u652f\u6301\u9ad8\u53ef\u7528\u6027\u548c\u5206\u7247\u3002</li> <li>\u914d\u7f6e\u670d\u52d9\u5730\u5740\uff0c\u78ba\u4fdd Celery Worker \u80fd\u6b63\u78ba\u9023\u63a5\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#kubernetes_2","title":"Kubernetes \u9032\u968e\u914d\u7f6e","text":""},{"location":"advanced/containerization-kubernetes/#_12","title":"\u5065\u5eb7\u6aa2\u67e5\u8207\u91cd\u555f\u7b56\u7565","text":"<p>\u70ba RabbitMQ \u548c Celery Worker \u914d\u7f6e\u5065\u5eb7\u6aa2\u67e5\uff0c\u78ba\u4fdd\u670d\u52d9\u7a69\u5b9a\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#_13","title":"\u914d\u7f6e\u793a\u4f8b","text":"<p>\u5728 Celery Worker \u7684 Deployment \u4e2d\u6dfb\u52a0\u5065\u5eb7\u6aa2\u67e5\uff1a <pre><code>containers:\n- name: celery-worker\n  image: your-celery-image:latest\n  livenessProbe:\n    exec:\n      command: [\"celery\", \"inspect\", \"ping\"]\n    initialDelaySeconds: 30\n    periodSeconds: 10\n  readinessProbe:\n    exec:\n      command: [\"celery\", \"inspect\", \"ping\"]\n    initialDelaySeconds: 5\n    periodSeconds: 5\n</code></pre></p>"},{"location":"advanced/containerization-kubernetes/#_14","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u5408\u7406\u7684\u6aa2\u67e5\u9593\u9694\u548c\u5ef6\u9072\uff0c\u907f\u514d\u983b\u7e41\u91cd\u555f\u3002</li> <li>\u7d50\u5408\u91cd\u555f\u7b56\u7565\uff08<code>restartPolicy</code>\uff09\uff0c\u78ba\u4fdd Pod \u5728\u6545\u969c\u6642\u80fd\u81ea\u52d5\u6062\u5fa9\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#_15","title":"\u7db2\u7d61\u7b56\u7565\u8207\u5b89\u5168","text":"<p>\u4f7f\u7528 Kubernetes \u7db2\u7d61\u7b56\u7565\u9650\u5236\u5bb9\u5668\u9593\u8a2a\u554f\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#_16","title":"\u7db2\u7d61\u7b56\u7565\u793a\u4f8b","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: celery-rabbitmq-policy\nspec:\n  podSelector:\n    matchLabels:\n      app: celery-worker\n  policyTypes:\n  - Egress\n  egress:\n  - to:\n    - podSelector:\n        matchLabels:\n          app: rabbitmq\n    ports:\n    - port: 5672\n      protocol: TCP\n</code></pre>"},{"location":"advanced/containerization-kubernetes/#_17","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u9650\u5236\u4e0d\u5fc5\u8981\u7684\u7db2\u7d61\u8a2a\u554f\uff0c\u589e\u5f37\u7cfb\u7d71\u5b89\u5168\u6027\u3002</li> <li>\u4f7f\u7528 Kubernetes Secrets \u7ba1\u7406\u654f\u611f\u4fe1\u606f\uff08\u5982 RabbitMQ \u5bc6\u78bc\uff09\uff1a</li> </ul> <pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: rabbitmq-credentials\ntype: Opaque\ndata:\n  username: dXNlcg==  # base64 encoded 'user'\n  password: cGFzc3dvcmQ=  # base64 encoded 'password'\n</code></pre> <p>\u7136\u5f8c\u5728 Deployment \u4e2d\u5f15\u7528\uff1a <pre><code>env:\n- name: RABBITMQ_USERNAME\n  valueFrom:\n    secretKeyRef:\n      name: rabbitmq-credentials\n      key: username\n- name: RABBITMQ_PASSWORD\n  valueFrom:\n    secretKeyRef:\n      name: rabbitmq-credentials\n      key: password\n</code></pre></p>"},{"location":"advanced/containerization-kubernetes/#_18","title":"\u65e5\u8a8c\u8207\u76e3\u63a7","text":"<p>\u5728 Kubernetes \u4e2d\u6536\u96c6\u548c\u5206\u6790\u65e5\u8a8c\uff0c\u76e3\u63a7\u7cfb\u7d71\u72c0\u614b\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#_19","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 EFK\uff08Elasticsearch, Fluentd, Kibana\uff09\u6216 Loki \u6536\u96c6\u548c\u67e5\u8a62\u65e5\u8a8c\u3002</li> <li>\u6574\u5408 Prometheus \u548c Grafana \u76e3\u63a7 RabbitMQ \u548c Celery \u7684\u95dc\u9375\u6307\u6a19\uff1a</li> </ul> <pre><code>apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: rabbitmq-monitor\n  labels:\n    release: prometheus\nspec:\n  selector:\n    matchLabels:\n      app: rabbitmq\n  endpoints:\n  - port: management\n    path: /metrics\n    interval: 30s\n</code></pre> <ul> <li>\u70ba Celery Worker \u914d\u7f6e Flower \u9032\u884c\u4efb\u52d9\u76e3\u63a7\uff0c\u4e26\u66b4\u9732\u70ba Kubernetes \u670d\u52d9\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#cicd","title":"\u81ea\u52d5\u5316\u8207 CI/CD \u6574\u5408","text":"<p>\u5c07 Kubernetes \u90e8\u7f72\u6574\u5408\u5230 CI/CD \u6d41\u7a0b\u4e2d\uff0c\u5be6\u73fe\u81ea\u52d5\u5316\u66f4\u65b0\uff1a</p>"},{"location":"advanced/containerization-kubernetes/#_20","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 Helm Chart \u6253\u5305\u61c9\u7528\uff0c\u7c21\u5316\u90e8\u7f72\u6d41\u7a0b\u3002</li> <li>\u5728 CI/CD \u7ba1\u9053\u4e2d\u904b\u884c\u55ae\u5143\u6e2c\u8a66\u548c\u96c6\u6210\u6e2c\u8a66\uff0c\u78ba\u4fdd\u4ee3\u78bc\u8cea\u91cf\u3002</li> <li>\u4f7f\u7528 GitOps \u5de5\u5177\uff08\u5982 ArgoCD\uff09\u7ba1\u7406 Kubernetes \u8cc7\u6e90\uff0c\u5be6\u73fe\u6301\u7e8c\u90e8\u7f72\u3002</li> </ul>"},{"location":"advanced/containerization-kubernetes/#_21","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u5bb9\u5668\u5316\u512a\u52e2\uff1a\u4f7f\u7528 Docker \u78ba\u4fdd\u74b0\u5883\u4e00\u81f4\u6027\uff0c\u5feb\u901f\u90e8\u7f72 Celery \u548c RabbitMQ\u3002</li> <li>Kubernetes \u7de8\u6392\uff1a\u5229\u7528 Kubernetes \u7684 StatefulSet \u548c Deployment \u7ba1\u7406 RabbitMQ \u96c6\u7fa4\u548c Celery Worker\u3002</li> <li>\u9032\u968e\u914d\u7f6e\uff1a\u914d\u7f6e\u5065\u5eb7\u6aa2\u67e5\u3001\u7db2\u7d61\u7b56\u7565\u548c\u76e3\u63a7\uff0c\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u6027\u548c\u5b89\u5168\u6027\u3002</li> <li>\u81ea\u52d5\u5316\u90e8\u7f72\uff1a\u6574\u5408 CI/CD \u548c GitOps \u5de5\u5177\uff0c\u63d0\u5347\u90e8\u7f72\u6548\u7387\u3002</li> </ul> <p>\u901a\u904e\u5bb9\u5668\u5316\u548c Kubernetes \u90e8\u7f72\uff0c\u60a8\u53ef\u4ee5\u69cb\u5efa\u4e00\u500b\u9748\u6d3b\u3001\u53ef\u64f4\u5c55\u4e14\u9ad8\u53ef\u7528\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\uff0c\u61c9\u5c0d\u8907\u96dc\u7684\u751f\u7522\u74b0\u5883\u9700\u6c42\u3002</p>"},{"location":"advanced/large-scale-deployment/","title":"\u5927\u898f\u6a21\u90e8\u7f72","text":"<p>\u7576\u60a8\u7684\u61c9\u7528\u7a0b\u5f0f\u9700\u8981\u8655\u7406\u6578\u5341\u842c\u751a\u81f3\u6578\u767e\u842c\u7684\u4efb\u52d9\u6642\uff0cCelery\u3001Kombu \u548c RabbitMQ \u7684\u90e8\u7f72\u65b9\u5f0f\u9700\u8981\u91dd\u5c0d\u5927\u898f\u6a21\u5834\u666f\u9032\u884c\u512a\u5316\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\u90e8\u7f72\u9019\u4e9b\u5de5\u5177\uff0c\u5f9e\u67b6\u69cb\u8a2d\u8a08\u5230\u8cc7\u6e90\u7ba1\u7406\uff0c\u63d0\u4f9b\u5177\u9ad4\u7684\u7b56\u7565\u548c\u5efa\u8b70\u3002</p>"},{"location":"advanced/large-scale-deployment/#_2","title":"\u5927\u898f\u6a21\u90e8\u7f72\u7684\u6311\u6230","text":"<p>\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\uff0c\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\u9762\u81e8\u4ee5\u4e0b\u6311\u6230\uff1a - \u9ad8\u541e\u5410\u91cf\uff1a\u9700\u8981\u8655\u7406\u5927\u91cf\u4efb\u52d9\u548c\u6d88\u606f\u3002 - \u4f4e\u5ef6\u9072\uff1a\u78ba\u4fdd\u4efb\u52d9\u5feb\u901f\u57f7\u884c\uff0c\u907f\u514d\u7a4d\u58d3\u3002 - \u9ad8\u53ef\u9760\u6027\uff1a\u907f\u514d\u55ae\u9ede\u6545\u969c\uff0c\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u3002 - \u8cc7\u6e90\u7ba1\u7406\uff1a\u9ad8\u6548\u5206\u914d CPU\u3001\u8a18\u61b6\u9ad4\u548c\u7db2\u7d61\u8cc7\u6e90\u3002</p>"},{"location":"advanced/large-scale-deployment/#_3","title":"\u67b6\u69cb\u8a2d\u8a08","text":"<p>\u5927\u898f\u6a21\u90e8\u7f72\u7684\u57fa\u790e\u662f\u5408\u7406\u7684\u67b6\u69cb\u8a2d\u8a08\uff0c\u78ba\u4fdd\u7cfb\u7d71\u80fd\u61c9\u5c0d\u9ad8\u8ca0\u8f09\u3002</p>"},{"location":"advanced/large-scale-deployment/#_4","title":"\u5206\u5c64\u67b6\u69cb","text":"<p>\u5c07\u7cfb\u7d71\u5206\u70ba\u591a\u5c64\uff0c\u5c08\u6ce8\u65bc\u4e0d\u540c\u529f\u80fd\uff1a - \u63a5\u5165\u5c64\uff1a\u63a5\u6536\u7528\u6236\u8acb\u6c42\uff0c\u767c\u8d77\u4efb\u52d9\u3002 - \u4efb\u52d9\u8655\u7406\u5c64\uff1a\u7531 Celery Worker \u8655\u7406\u4efb\u52d9\u3002 - \u6d88\u606f\u4ee3\u7406\u5c64\uff1aRabbitMQ \u96c6\u7fa4\u8ca0\u8cac\u6d88\u606f\u50b3\u8f38\u3002 - \u5132\u5b58\u5c64\uff1a\u7d50\u679c\u5f8c\u7aef\u548c\u4e8b\u4ef6\u5132\u5b58\u3002</p>"},{"location":"advanced/large-scale-deployment/#_5","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u6bcf\u5c64\u7368\u7acb\u64f4\u5c55\uff0c\u907f\u514d\u55ae\u5c64\u6210\u70ba\u74f6\u9838\u3002</li> <li>\u4f7f\u7528\u8ca0\u8f09\u5747\u8861\u5668\u5206\u767c\u6d41\u91cf\u5230\u63a5\u5165\u5c64\u548c\u6d88\u606f\u4ee3\u7406\u5c64\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_6","title":"\u591a\u5340\u57df\u90e8\u7f72","text":"<p>\u5728\u5927\u898f\u6a21\u5834\u666f\u4e2d\uff0c\u55ae\u4e00\u6578\u64da\u4e2d\u5fc3\u53ef\u80fd\u7121\u6cd5\u6eff\u8db3\u9700\u6c42\uff0c\u9700\u9032\u884c\u591a\u5340\u57df\u90e8\u7f72\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_7","title":"\u90e8\u7f72\u6b65\u9a5f","text":"<ol> <li>\u5728\u591a\u500b\u5730\u7406\u5340\u57df\u90e8\u7f72 RabbitMQ \u96c6\u7fa4\uff0c\u4f7f\u7528\u806f\u8054\u90a6\uff08Federation\uff09\u6216 Shovel \u63d2\u4ef6\u540c\u6b65\u6d88\u606f\u3002</li> <li>\u5728\u6bcf\u500b\u5340\u57df\u90e8\u7f72 Celery Worker\uff0c\u8655\u7406\u672c\u5730\u4efb\u52d9\u3002</li> <li>\u914d\u7f6e\u8de8\u5340\u57df\u7d50\u679c\u5f8c\u7aef\uff08\u5982 Redis Geo-Replication\uff09\u3002</li> </ol>"},{"location":"advanced/large-scale-deployment/#_8","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u512a\u5148\u5c07\u4efb\u52d9\u5206\u914d\u5230\u7528\u6236\u6240\u5728\u7684\u5340\u57df\uff0c\u6e1b\u5c11\u5ef6\u9072\u3002</li> <li>\u78ba\u4fdd\u8de8\u5340\u57df\u6578\u64da\u540c\u6b65\u7684\u53ef\u9760\u6027\uff0c\u907f\u514d\u6d88\u606f\u4e1f\u5931\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#rabbitmq","title":"RabbitMQ \u5927\u898f\u6a21\u512a\u5316","text":"<p>RabbitMQ \u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\uff0c\u9700\u8981\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\u8655\u7406\u9ad8\u541e\u5410\u91cf\u3002</p>"},{"location":"advanced/large-scale-deployment/#_9","title":"\u96c6\u7fa4\u898f\u6a21\u8207\u5206\u7247","text":"<p>\u90e8\u7f72\u5927\u578b RabbitMQ \u96c6\u7fa4\uff0c\u4e26\u4f7f\u7528\u5206\u7247\u7b56\u7565\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_10","title":"\u8a2d\u5b9a\u6b65\u9a5f","text":"<ol> <li>\u90e8\u7f72\u591a\u7bc0\u9ede RabbitMQ \u96c6\u7fa4\uff08\u5efa\u8b70 5-7 \u500b\u7bc0\u9ede\uff09\u3002</li> <li>\u4f7f\u7528\u4e00\u81f4\u6027\u54c8\u5e0c\u4ea4\u63db\u6a5f\uff08Consistent Hash Exchange\uff09\u5be6\u73fe\u6d88\u606f\u5206\u7247\u3002</li> </ol> <pre><code>rabbitmq-plugins enable rabbitmq_consistent_hash_exchange\n</code></pre>"},{"location":"advanced/large-scale-deployment/#_11","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u6839\u64da\u8ca0\u8f09\u60c5\u6cc1\u52d5\u614b\u8abf\u6574\u96c6\u7fa4\u7bc0\u9ede\u6578\uff0c\u907f\u514d\u904e\u591a\u7bc0\u9ede\u5c0e\u81f4\u540c\u6b65\u958b\u92b7\u3002</li> <li>\u4f7f\u7528\u5206\u7247\u7b56\u7565\u5c07\u6d88\u606f\u5747\u52fb\u5206\u914d\u5230\u4e0d\u540c\u968a\u5217\uff0c\u9632\u6b62\u55ae\u4e00\u968a\u5217\u904e\u8f09\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_12","title":"\u9ad8\u541e\u5410\u91cf\u914d\u7f6e","text":"<p>\u8abf\u6574 RabbitMQ \u914d\u7f6e\u4ee5\u652f\u6301\u9ad8\u541e\u5410\u91cf\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_13","title":"\u914d\u7f6e\u793a\u4f8b","text":"<ul> <li>\u589e\u52a0\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\uff08<code>ulimit -n</code>\uff09\u4ee5\u652f\u6301\u66f4\u591a\u9023\u63a5\u3002</li> <li>\u8abf\u6574\u5167\u5b58\u548c\u78c1\u76e4\u4f7f\u7528\u9650\u5236\uff1a</li> </ul> <pre><code>rabbitmqctl set_vm_memory_high_watermark 0.6\n</code></pre>"},{"location":"advanced/large-scale-deployment/#_14","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u9ad8\u6548\u7684\u786c\u9ad4\uff08\u5982 SSD\uff09\u652f\u6301\u9ad8 I/O \u9700\u6c42\u3002</li> <li>\u76e3\u63a7 RabbitMQ \u7684\u5167\u5b58\u548c CPU \u4f7f\u7528\uff0c\u53ca\u6642\u64f4\u5c55\u8cc7\u6e90\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_15","title":"\u968a\u5217\u8207\u6d88\u606f\u7ba1\u7406","text":"<p>\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\uff0c\u968a\u5217\u548c\u6d88\u606f\u7ba1\u7406\u81f3\u95dc\u91cd\u8981\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_16","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u968a\u5217\u9577\u5ea6\u9650\u5236\uff0c\u907f\u514d\u7121\u9650\u7a4d\u58d3\uff1a</li> </ul> <pre><code>queue = Queue('tasks', exchange, routing_key='tasks', queue_arguments={'x-max-length': 100000})\n</code></pre> <ul> <li>\u4f7f\u7528 TTL\uff08Time-To-Live\uff09\u8a2d\u5b9a\u6d88\u606f\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u820a\u6d88\u606f\u4f54\u7528\u8cc7\u6e90\uff1a</li> </ul> <pre><code>producer.publish({'task': 'data'}, expiration=3600)  # \u6d88\u606f1\u5c0f\u6642\u5f8c\u904e\u671f\n</code></pre>"},{"location":"advanced/large-scale-deployment/#celery-worker","title":"Celery Worker \u5927\u898f\u6a21\u90e8\u7f72","text":"<p>Celery Worker \u8ca0\u8cac\u4efb\u52d9\u57f7\u884c\uff0c\u9700\u8981\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\u9ad8\u6548\u904b\u884c\u3002</p>"},{"location":"advanced/large-scale-deployment/#worker","title":"Worker \u96c6\u7fa4\u7ba1\u7406","text":"<p>\u90e8\u7f72\u5927\u91cf Worker\uff0c\u6839\u64da\u4efb\u52d9\u985e\u578b\u5206\u914d\u8cc7\u6e90\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_17","title":"\u90e8\u7f72\u6b65\u9a5f","text":"<ol> <li>\u70ba\u4e0d\u540c\u4efb\u52d9\u985e\u578b\u5275\u5efa\u5c08\u7528 Worker \u96c6\u7fa4\uff1a</li> </ol> <pre><code>celery -A your_module worker --concurrency=10 -Q high_priority -n high_priority_worker@%h\ncelery -A your_module worker --concurrency=20 -Q default -n default_worker@%h\n</code></pre> <ol> <li>\u4f7f\u7528\u81ea\u52d5\u5316\u5de5\u5177\uff08\u5982 Ansible\uff09\u6279\u91cf\u90e8\u7f72\u548c\u7ba1\u7406 Worker\u3002</li> </ol>"},{"location":"advanced/large-scale-deployment/#_18","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u6839\u64da\u4efb\u52d9\u8ca0\u8f09\u52d5\u614b\u8abf\u6574 Worker \u6578\u91cf\uff0c\u4f7f\u7528 Celery Autoscaler\uff1a</li> </ul> <pre><code>celery -A your_module worker --autoscale=50,10\n</code></pre> <ul> <li>\u5c07 Worker \u5206\u5e03\u5728\u591a\u53f0\u4f3a\u670d\u5668\u4e0a\uff0c\u907f\u514d\u55ae\u9ede\u8cc7\u6e90\u74f6\u9838\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_19","title":"\u4efb\u52d9\u512a\u5148\u7d1a\u8207\u8cc7\u6e90\u5206\u914d","text":"<p>\u5728\u5927\u898f\u6a21\u90e8\u7f72\u4e2d\uff0c\u4efb\u52d9\u512a\u5148\u7d1a\u548c\u8cc7\u6e90\u5206\u914d\u76f4\u63a5\u5f71\u97ff\u7cfb\u7d71\u6548\u7387\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_20","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u591a\u968a\u5217\u5be6\u73fe\u4efb\u52d9\u512a\u5148\u7d1a\uff1a</li> </ul> <pre><code>app.conf.task_queues = {\n    'high_priority': {'exchange': 'high_priority', 'routing_key': 'high.#'},\n    'default': {'exchange': 'default', 'routing_key': 'default.#'}\n}\n</code></pre> <ul> <li>\u70ba\u9ad8\u512a\u5148\u7d1a Worker \u5206\u914d\u66f4\u591a CPU \u548c\u5167\u5b58\u8cc7\u6e90\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_21","title":"\u7d50\u679c\u5f8c\u7aef\u8207\u5132\u5b58\u512a\u5316","text":"<p>\u7d50\u679c\u5f8c\u7aef\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\u9700\u8981\u8655\u7406\u5927\u91cf\u6578\u64da\u3002</p>"},{"location":"advanced/large-scale-deployment/#_22","title":"\u9078\u64c7\u9ad8\u6548\u5f8c\u7aef","text":"<p>\u9078\u64c7\u652f\u6301\u9ad8\u4f75\u767c\u7684\u7d50\u679c\u5f8c\u7aef\uff0c\u5982 Redis \u96c6\u7fa4\u6216 Cassandra\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_23","title":"\u914d\u7f6e\u793a\u4f8b","text":"<ul> <li>\u914d\u7f6e Redis \u96c6\u7fa4\u4f5c\u70ba\u7d50\u679c\u5f8c\u7aef\uff1a</li> </ul> <pre><code>app.conf.result_backend = 'redis://:password@host1:6379,host2:6379/0'\n</code></pre>"},{"location":"advanced/large-scale-deployment/#_24","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u5206\u7247\u548c\u8907\u88fd\u78ba\u4fdd\u7d50\u679c\u5f8c\u7aef\u7684\u9ad8\u53ef\u7528\u6027\u548c\u6027\u80fd\u3002</li> <li>\u8a2d\u5b9a\u7d50\u679c\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u6578\u64da\u7a4d\u7d2f\uff1a</li> </ul> <pre><code>app.conf.result_expires = 86400  # \u7d50\u679c1\u5929\u5f8c\u904e\u671f\n</code></pre>"},{"location":"advanced/large-scale-deployment/#_25","title":"\u4e8b\u4ef6\u8207\u65e5\u8a8c\u5132\u5b58","text":"<p>\u5c0d\u65bc\u5927\u898f\u6a21\u7cfb\u7d71\uff0c\u4e8b\u4ef6\u548c\u65e5\u8a8c\u5132\u5b58\u9700\u8981\u5c08\u9580\u8a2d\u8a08\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_26","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u5206\u5e03\u5f0f\u5132\u5b58\u7cfb\u7d71\uff08\u5982 Elasticsearch\uff09\u5132\u5b58\u65e5\u8a8c\u548c\u4e8b\u4ef6\u3002</li> <li>\u5b9a\u671f\u6b78\u6a94\u820a\u6578\u64da\uff0c\u4fdd\u6301\u5132\u5b58\u7cfb\u7d71\u9ad8\u6548\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_27","title":"\u76e3\u63a7\u8207\u8abf\u512a","text":"<p>\u5927\u898f\u6a21\u90e8\u7f72\u9700\u8981\u5b8c\u5584\u7684\u76e3\u63a7\u548c\u8abf\u512a\u6a5f\u5236\uff0c\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u904b\u884c\u3002</p>"},{"location":"advanced/large-scale-deployment/#_28","title":"\u76e3\u63a7\u95dc\u9375\u6307\u6a19","text":"<p>\u76e3\u63a7 RabbitMQ\u3001Celery \u548c\u7d50\u679c\u5f8c\u7aef\u7684\u95dc\u9375\u6307\u6a19\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_29","title":"\u76e3\u63a7\u5de5\u5177","text":"<ul> <li>RabbitMQ\uff1a\u4f7f\u7528 RabbitMQ Management Plugin \u6216 Prometheus \u76e3\u63a7\u968a\u5217\u9577\u5ea6\u3001\u6d88\u606f\u901f\u7387\u7b49\u3002</li> <li>Celery\uff1a\u4f7f\u7528 Flower \u6216\u81ea\u5b9a\u7fa9\u76e3\u63a7\u5de5\u5177\u8ffd\u8e64\u4efb\u52d9\u57f7\u884c\u72c0\u614b\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1a\u76e3\u63a7 Redis \u7684\u5167\u5b58\u4f7f\u7528\u548c\u67e5\u8a62\u5ef6\u9072\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_30","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u544a\u8b66\u95be\u503c\uff0c\u53ca\u6642\u767c\u73fe\u7570\u5e38\u3002</li> <li>\u8a18\u9304\u6b77\u53f2\u6578\u64da\uff0c\u5206\u6790\u7cfb\u7d71\u74f6\u9838\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_31","title":"\u52d5\u614b\u8abf\u512a","text":"<p>\u6839\u64da\u76e3\u63a7\u6578\u64da\u52d5\u614b\u8abf\u6574\u7cfb\u7d71\u53c3\u6578\uff1a</p>"},{"location":"advanced/large-scale-deployment/#_32","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u6839\u64da\u968a\u5217\u9577\u5ea6\u52d5\u614b\u589e\u6e1b Worker \u6578\u91cf\u3002</li> <li>\u8abf\u6574 RabbitMQ \u7684\u5167\u5b58\u548c\u9023\u63a5\u9650\u5236\uff0c\u9069\u61c9\u8ca0\u8f09\u8b8a\u5316\u3002</li> </ul>"},{"location":"advanced/large-scale-deployment/#_33","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u5206\u5c64\u8207\u591a\u5340\u57df\uff1a\u8a2d\u8a08\u5206\u5c64\u67b6\u69cb\uff0c\u652f\u6301\u591a\u5340\u57df\u90e8\u7f72\uff0c\u61c9\u5c0d\u5168\u7403\u7528\u6236\u9700\u6c42\u3002</li> <li>\u9ad8\u541e\u5410\u91cf\u512a\u5316\uff1a\u512a\u5316 RabbitMQ \u548c Celery Worker \u914d\u7f6e\uff0c\u652f\u6301\u5927\u91cf\u4efb\u52d9\u8655\u7406\u3002</li> <li>\u8cc7\u6e90\u7ba1\u7406\uff1a\u5408\u7406\u5206\u914d\u8cc7\u6e90\uff0c\u52d5\u614b\u8abf\u6574 Worker \u548c\u968a\u5217\u3002</li> <li>\u76e3\u63a7\u8207\u8abf\u512a\uff1a\u5efa\u7acb\u5b8c\u5584\u7684\u76e3\u63a7\u9ad4\u7cfb\uff0c\u6839\u64da\u6578\u64da\u6301\u7e8c\u512a\u5316\u7cfb\u7d71\u3002</li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u6210\u529f\u90e8\u7f72\u4e00\u500b\u5927\u898f\u6a21\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\uff0c\u61c9\u5c0d\u9ad8\u8ca0\u8f09\u548c\u9ad8\u4f75\u767c\u7684\u6311\u6230\u3002</p>"},{"location":"advanced/microservices-integration/","title":"\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u7684\u61c9\u7528","text":"<p>\u5fae\u670d\u52d9\u67b6\u69cb\u5c07\u61c9\u7528\u7a0b\u5f0f\u62c6\u5206\u6210\u591a\u500b\u5c0f\u578b\u3001\u7368\u7acb\u7684\u670d\u52d9\uff0c\u9019\u4e9b\u670d\u52d9\u901a\u904e API \u6216\u6d88\u606f\u968a\u5217\u9032\u884c\u901a\u4fe1\u3002Celery\u3001Kombu \u548c RabbitMQ \u5728\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u626e\u6f14\u91cd\u8981\u89d2\u8272\uff0c\u7528\u65bc\u7570\u6b65\u901a\u4fe1\u3001\u4efb\u52d9\u8655\u7406\u548c\u4e8b\u4ef6\u9a45\u52d5\u8a2d\u8a08\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u5c07\u9019\u4e9b\u5de5\u5177\u6574\u5408\u5230\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\uff0c\u4e26\u63d0\u4f9b\u6700\u4f73\u5be6\u8e10\u3002</p>"},{"location":"advanced/microservices-integration/#_2","title":"\u5fae\u670d\u52d9\u67b6\u69cb\u8207\u7570\u6b65\u901a\u4fe1","text":"<p>\u5728\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\uff0c\u670d\u52d9\u9593\u7684\u901a\u4fe1\u901a\u5e38\u5206\u70ba\u540c\u6b65\uff08HTTP/REST\uff09\u548c\u7570\u6b65\uff08\u6d88\u606f\u968a\u5217\uff09\u3002Celery \u548c RabbitMQ \u7279\u5225\u9069\u5408\u7570\u6b65\u901a\u4fe1\u5834\u666f\u3002</p>"},{"location":"advanced/microservices-integration/#_3","title":"\u7570\u6b65\u901a\u4fe1\u7684\u512a\u52e2","text":"<ul> <li>\u89e3\u8026\u670d\u52d9\uff1a\u670d\u52d9\u9593\u901a\u904e\u6d88\u606f\u968a\u5217\u901a\u4fe1\uff0c\u7121\u9700\u76f4\u63a5\u4f9d\u8cf4\u3002</li> <li>\u63d0\u9ad8\u97ff\u61c9\u6027\uff1a\u9577\u6642\u9593\u4efb\u52d9\u7570\u6b65\u8655\u7406\uff0c\u907f\u514d\u963b\u585e\u7528\u6236\u8acb\u6c42\u3002</li> <li>\u4e8b\u4ef6\u9a45\u52d5\uff1a\u57fa\u65bc\u4e8b\u4ef6\u89f8\u767c\u696d\u52d9\u908f\u8f2f\uff0c\u5be6\u73fe\u9748\u6d3b\u7684\u6d41\u7a0b\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_4","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c0d\u65bc\u975e\u5373\u6642\u9700\u6c42\u7684\u64cd\u4f5c\uff08\u5982\u767c\u9001\u90f5\u4ef6\u3001\u751f\u6210\u5831\u544a\uff09\uff0c\u4f7f\u7528\u7570\u6b65\u901a\u4fe1\u3002</li> <li>\u78ba\u4fdd\u6d88\u606f\u968a\u5217\u7684\u53ef\u9760\u6027\uff0c\u907f\u514d\u6d88\u606f\u4e1f\u5931\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#rabbitmq","title":"\u4f7f\u7528 RabbitMQ \u4f5c\u70ba\u4e8b\u4ef6\u7e3d\u7dda","text":"<p>RabbitMQ \u53ef\u4ee5\u4f5c\u70ba\u4e8b\u4ef6\u7e3d\u7dda\uff0c\u5141\u8a31\u670d\u52d9\u767c\u5e03\u548c\u8a02\u95b1\u4e8b\u4ef6\uff1a</p> <pre><code>from kombu import Exchange, Queue, Producer, Consumer, Connection\n\n# \u5b9a\u7fa9\u4ea4\u63db\u6a5f\u548c\u968a\u5217\nevent_exchange = Exchange('events', type='topic')\norder_queue = Queue('order.events', event_exchange, routing_key='order.*')\n\n# \u767c\u5e03\u4e8b\u4ef6\nwith Connection('amqp://localhost') as conn:\n    producer = Producer(conn)\n    producer.publish(\n        {'event': 'order_created', 'order_id': 123},\n        exchange=event_exchange,\n        routing_key='order.created'\n    )\n\n# \u8a02\u95b1\u4e8b\u4ef6\ndef handle_event(body, message):\n    print(f\"Received event: {body}\")\n    message.ack()\n\nwith Connection('amqp://localhost') as conn:\n    consumer = Consumer(conn, queues=order_queue, callbacks=[handle_event])\n    consumer.consume()\n</code></pre>"},{"location":"advanced/microservices-integration/#_5","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 <code>topic</code> \u985e\u578b\u7684\u4ea4\u63db\u6a5f\uff0c\u5141\u8a31\u9748\u6d3b\u7684\u4e8b\u4ef6\u8def\u7531\u3002</li> <li>\u70ba\u6bcf\u500b\u670d\u52d9\u5b9a\u7fa9\u5c08\u5c6c\u968a\u5217\uff0c\u907f\u514d\u4e8b\u4ef6\u885d\u7a81\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#celery","title":"Celery \u5728\u5fae\u670d\u52d9\u4e2d\u7684\u89d2\u8272","text":"<p>Celery \u53ef\u4ee5\u4f5c\u70ba\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u7684\u4efb\u52d9\u8655\u7406\u5f15\u64ce\uff0c\u8ca0\u8cac\u57f7\u884c\u7570\u6b65\u4efb\u52d9\u3002</p>"},{"location":"advanced/microservices-integration/#_6","title":"\u8de8\u670d\u52d9\u4efb\u52d9\u8abf\u5ea6","text":"<p>\u5728\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\uff0c\u4e00\u500b\u670d\u52d9\u53ef\u80fd\u9700\u8981\u89f8\u767c\u53e6\u4e00\u500b\u670d\u52d9\u7684\u4efb\u52d9\uff1a</p> <pre><code># \u8a02\u55ae\u670d\u52d9\n@app.task\ndef create_order(order_data):\n    # \u8655\u7406\u8a02\u55ae\u908f\u8f2f\n    notify_inventory.delay(order_data)  # \u901a\u77e5\u5eab\u5b58\u670d\u52d9\n\n# \u5eab\u5b58\u670d\u52d9\n@app.task\ndef notify_inventory(order_data):\n    # \u66f4\u65b0\u5eab\u5b58\n    print(f\"Inventory updated for order {order_data['id']}\")\n</code></pre>"},{"location":"advanced/microservices-integration/#_7","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u70ba\u6bcf\u500b\u5fae\u670d\u52d9\u914d\u7f6e\u7368\u7acb\u7684 Celery \u61c9\u7528\uff0c\u907f\u514d\u8026\u5408\u3002</li> <li>\u4f7f\u7528\u7d71\u4e00\u7684\u6d88\u606f\u683c\u5f0f\uff08\u5982 JSON Schema\uff09\u78ba\u4fdd\u670d\u52d9\u9593\u6578\u64da\u4e00\u81f4\u6027\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_8","title":"\u670d\u52d9\u9593\u7d50\u679c\u5171\u4eab","text":"<p>\u4f7f\u7528\u7d50\u679c\u5f8c\u7aef\u5728\u670d\u52d9\u9593\u5171\u4eab\u4efb\u52d9\u7d50\u679c\uff1a</p> <pre><code># \u8a02\u55ae\u670d\u52d9\nresult = process_payment.delay(payment_data)\npayment_result = result.get(timeout=30)  # \u7b49\u5f85\u652f\u4ed8\u7d50\u679c\nif payment_result['status'] == 'success':\n    confirm_order.delay(payment_result['order_id'])\n\n# \u652f\u4ed8\u670d\u52d9\n@app.task\ndef process_payment(payment_data):\n    # \u6a21\u64ec\u652f\u4ed8\u8655\u7406\n    return {'status': 'success', 'order_id': payment_data['order_id']}\n</code></pre>"},{"location":"advanced/microservices-integration/#_9","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u9ad8\u6548\u7684\u7d50\u679c\u5f8c\u7aef\uff08\u5982 Redis\uff09\uff0c\u78ba\u4fdd\u7d50\u679c\u5feb\u901f\u5171\u4eab\u3002</li> <li>\u8a2d\u5b9a\u7d50\u679c\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u5f8c\u7aef\u8cc7\u6e90\u6d6a\u8cbb\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_10","title":"\u4e8b\u4ef6\u9a45\u52d5\u67b6\u69cb\u8a2d\u8a08","text":"<p>\u4e8b\u4ef6\u9a45\u52d5\u67b6\u69cb\u662f\u5fae\u670d\u52d9\u4e2d\u7684\u5e38\u898b\u6a21\u5f0f\uff0cRabbitMQ \u548c Kombu \u662f\u5be6\u73fe\u9019\u4e00\u6a21\u5f0f\u7684\u7406\u60f3\u5de5\u5177\u3002</p>"},{"location":"advanced/microservices-integration/#_11","title":"\u4e8b\u4ef6\u767c\u5e03\u8207\u8a02\u95b1","text":"<p>\u670d\u52d9\u767c\u5e03\u4e8b\u4ef6\uff0c\u5176\u4ed6\u670d\u52d9\u8a02\u95b1\u4e26\u8655\u7406\uff1a</p> <pre><code># \u8a02\u55ae\u670d\u52d9\u767c\u5e03\u4e8b\u4ef6\n@app.task\ndef order_created(order_id):\n    publish_event.delay('order.created', {'order_id': order_id})\n\n# \u5eab\u5b58\u670d\u52d9\u8a02\u95b1\u4e8b\u4ef6\ndef handle_order_created(body, message):\n    order_id = body['order_id']\n    update_inventory.delay(order_id)\n    message.ack()\n</code></pre>"},{"location":"advanced/microservices-integration/#_12","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5b9a\u7fa9\u6e05\u6670\u7684\u4e8b\u4ef6\u7d50\u69cb\uff0c\u5305\u542b\u4e8b\u4ef6\u985e\u578b\u3001\u6642\u9593\u6233\u548c\u76f8\u95dc\u6578\u64da\u3002</li> <li>\u4f7f\u7528\u6b7b\u4fe1\u968a\u5217\uff08Dead Letter Queue\uff09\u8655\u7406\u7121\u6cd5\u6d88\u8cbb\u7684\u4e8b\u4ef6\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_13","title":"\u4e8b\u4ef6\u6eaf\u6e90\u8207\u91cd\u653e","text":"<p>\u4e8b\u4ef6\u6eaf\u6e90\uff08Event Sourcing\uff09\u8a18\u9304\u6240\u6709\u4e8b\u4ef6\u4f5c\u70ba\u7cfb\u7d71\u72c0\u614b\u7684\u4f86\u6e90\uff0c\u652f\u6301\u4e8b\u4ef6\u91cd\u653e\uff1a</p> <pre><code># \u5132\u5b58\u4e8b\u4ef6\u5230\u6301\u4e45\u5316\u5132\u5b58\n@app.task\ndef store_event(event_type, event_data):\n    # \u5132\u5b58\u5230\u8cc7\u6599\u5eab\u6216\u65e5\u8a8c\n    save_to_event_store(event_type, event_data)\n\n# \u91cd\u653e\u4e8b\u4ef6\u4ee5\u91cd\u5efa\u72c0\u614b\ndef replay_events():\n    events = load_from_event_store()\n    for event in events:\n        handle_event(event)\n</code></pre>"},{"location":"advanced/microservices-integration/#_14","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u4e8b\u4ef6\u5132\u5b58\u7684\u53ef\u9760\u6027\u548c\u9806\u5e8f\u6027\u3002</li> <li>\u5b9a\u671f\u5099\u4efd\u4e8b\u4ef6\u65e5\u8a8c\uff0c\u907f\u514d\u6578\u64da\u4e1f\u5931\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_15","title":"\u6311\u6230\u8207\u89e3\u6c7a\u65b9\u6848","text":"<p>\u5728\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\u4f7f\u7528 Celery \u548c RabbitMQ \u6703\u9762\u81e8\u4e00\u4e9b\u6311\u6230\uff0c\u4ee5\u4e0b\u662f\u5e38\u898b\u554f\u984c\u53ca\u89e3\u6c7a\u65b9\u6848\u3002</p>"},{"location":"advanced/microservices-integration/#_16","title":"\u670d\u52d9\u767c\u73fe\u8207\u9023\u63a5\u7ba1\u7406","text":"<p>\u5fae\u670d\u52d9\u74b0\u5883\u4e2d\uff0c\u670d\u52d9\u5730\u5740\u53ef\u80fd\u52d5\u614b\u8b8a\u5316\uff0c\u9700\u5be6\u73fe\u670d\u52d9\u767c\u73fe\uff1a</p>"},{"location":"advanced/microservices-integration/#_17","title":"\u89e3\u6c7a\u65b9\u6848","text":"<ul> <li>\u4f7f\u7528\u670d\u52d9\u8a3b\u518a\u4e2d\u5fc3\uff08\u5982 Consul \u6216 Eureka\uff09\u7ba1\u7406 RabbitMQ \u548c Celery \u670d\u52d9\u5730\u5740\u3002</li> <li>\u914d\u7f6e\u5ba2\u6236\u7aef\u81ea\u52d5\u91cd\u9023\uff0c\u907f\u514d\u56e0\u670d\u52d9\u5730\u5740\u8b8a\u66f4\u5c0e\u81f4\u9023\u63a5\u5931\u6557\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_18","title":"\u6d88\u606f\u4e00\u81f4\u6027\u8207\u4e8b\u52d9","text":"<p>\u670d\u52d9\u9593\u6d88\u606f\u53ef\u80fd\u6d89\u53ca\u591a\u6b65\u64cd\u4f5c\uff0c\u9700\u78ba\u4fdd\u4e00\u81f4\u6027\uff1a</p>"},{"location":"advanced/microservices-integration/#_19","title":"\u89e3\u6c7a\u65b9\u6848","text":"<ul> <li>\u4f7f\u7528\u5169\u968e\u6bb5\u63d0\u4ea4\uff08Two-Phase Commit\uff09\u6216 Saga \u6a21\u5f0f\u78ba\u4fdd\u5206\u5e03\u5f0f\u4e8b\u52d9\u3002</li> <li>\u70ba\u95dc\u9375\u64cd\u4f5c\u8a2d\u5b9a\u91cd\u8a66\u6a5f\u5236\uff0c\u907f\u514d\u90e8\u5206\u5931\u6557\u3002</li> </ul>"},{"location":"advanced/microservices-integration/#_20","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u7570\u6b65\u901a\u4fe1\uff1a\u4f7f\u7528 RabbitMQ \u548c Celery \u5be6\u73fe\u670d\u52d9\u9593\u89e3\u8026\uff0c\u63d0\u5347\u7cfb\u7d71\u9748\u6d3b\u6027\u3002</li> <li>\u4e8b\u4ef6\u9a45\u52d5\uff1a\u8a2d\u8a08\u4e8b\u4ef6\u7e3d\u7dda\u548c\u4e8b\u4ef6\u6eaf\u6e90\uff0c\u652f\u6301\u8907\u96dc\u696d\u52d9\u6d41\u7a0b\u3002</li> <li>\u8de8\u670d\u52d9\u4efb\u52d9\uff1a\u4f7f\u7528 Celery \u8abf\u5ea6\u8de8\u670d\u52d9\u4efb\u52d9\uff0c\u78ba\u4fdd\u7d50\u679c\u5171\u4eab\u3002</li> <li>\u6311\u6230\u61c9\u5c0d\uff1a\u89e3\u6c7a\u670d\u52d9\u767c\u73fe\u3001\u4e00\u81f4\u6027\u7b49\u554f\u984c\uff0c\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u3002</li> </ul> <p>\u901a\u904e\u5c07 Celery\u3001Kombu \u548c RabbitMQ \u6574\u5408\u5230\u5fae\u670d\u52d9\u67b6\u69cb\u4e2d\uff0c\u60a8\u53ef\u4ee5\u69cb\u5efa\u4e00\u500b\u9ad8\u6548\u3001\u9748\u6d3b\u4e14\u53ef\u64f4\u5c55\u7684\u5206\u5e03\u5f0f\u7cfb\u7d71\u3002</p>"},{"location":"appendix/faq/","title":"\u5e38\u898b\u554f\u984c\u89e3\u7b54 (FAQ)","text":"<p>\u672c\u9644\u9304\u6574\u7406\u4e86\u95dc\u65bc Celery\u3001Kombu \u548c RabbitMQ \u7684\u5e38\u898b\u554f\u984c\u53ca\u5176\u89e3\u7b54\uff0c\u65e8\u5728\u5e6b\u52a9\u60a8\u5feb\u901f\u89e3\u6c7a\u5728\u4f7f\u7528\u9019\u4e9b\u5de5\u5177\u6642\u9047\u5230\u7684\u554f\u984c\u3002\u5982\u679c\u60a8\u6709\u5176\u4ed6\u554f\u984c\uff0c\u5efa\u8b70\u67e5\u95b1\u5b98\u65b9\u6587\u6a94\u6216\u5728\u793e\u5340\u4e2d\u5c0b\u6c42\u5e6b\u52a9\u3002</p>"},{"location":"appendix/faq/#celery","title":"Celery \u76f8\u95dc\u554f\u984c","text":""},{"location":"appendix/faq/#celery_1","title":"\u70ba\u4ec0\u9ebc\u6211\u7684 Celery \u4efb\u52d9\u6c92\u6709\u57f7\u884c\uff1f","text":"<p>\u53ef\u80fd\u539f\u56e0\uff1a</p> <ul> <li>Worker \u6c92\u6709\u555f\u52d5\u6216\u672a\u6b63\u78ba\u9023\u63a5\u5230\u6d88\u606f\u4ee3\u7406\uff08Broker\uff09\u3002</li> <li>\u4efb\u52d9\u968a\u5217\u540d\u7a31\u8207 Worker \u76e3\u807d\u7684\u968a\u5217\u4e0d\u5339\u914d\u3002</li> <li>\u6d88\u606f\u4ee3\u7406\uff08\u5982 RabbitMQ\uff09\u672a\u904b\u884c\u6216\u9023\u63a5\u914d\u7f6e\u932f\u8aa4\u3002</li> </ul> <p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u6aa2\u67e5 Worker \u662f\u5426\u904b\u884c\uff1a<code>celery -A your_module worker --loglevel=info</code>\u3002</li> <li>\u78ba\u8a8d\u968a\u5217\u540d\u7a31\u662f\u5426\u4e00\u81f4\uff0c\u4f7f\u7528 <code>-Q</code> \u53c3\u6578\u6307\u5b9a\u968a\u5217\uff1a<code>celery -A your_module worker -Q your_queue</code>\u3002</li> <li>\u6aa2\u67e5 Broker \u9023\u63a5\u5b57\u7b26\u4e32\uff08<code>CELERY_BROKER_URL</code>\uff09\uff0c\u78ba\u4fdd RabbitMQ \u6216\u5176\u4ed6\u5f8c\u7aef\u670d\u52d9\u6b63\u5e38\u904b\u884c\u3002</li> </ul>"},{"location":"appendix/faq/#celery_2","title":"\u5982\u4f55\u67e5\u770b Celery \u4efb\u52d9\u7684\u57f7\u884c\u72c0\u614b\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528 Flower \u76e3\u63a7\u5de5\u5177\uff1a\u5b89\u88dd <code>pip install flower</code>\uff0c\u7136\u5f8c\u555f\u52d5 <code>celery -A your_module flower</code>\u3002</li> <li>\u914d\u7f6e\u7d50\u679c\u5f8c\u7aef\uff08\u5982 Redis\uff09\uff0c\u4e26\u4f7f\u7528 <code>AsyncResult</code> \u7372\u53d6\u4efb\u52d9\u72c0\u614b\uff1a   <pre><code>from celery.result import AsyncResult\nresult = AsyncResult(task_id)\nprint(result.state)  # PENDING, STARTED, SUCCESS, FAILURE \u7b49\n</code></pre></li> </ul>"},{"location":"appendix/faq/#celery_3","title":"Celery \u4efb\u52d9\u57f7\u884c\u6642\u9593\u904e\u9577\uff0c\u5982\u4f55\u8a2d\u5b9a\u8d85\u6642\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u5728\u4efb\u52d9\u8abf\u7528\u6642\u8a2d\u5b9a <code>time_limit</code> \u548c <code>soft_time_limit</code>\uff1a   <pre><code>result = your_task.apply_async(time_limit=300, soft_time_limit=280)\n</code></pre></li> <li>\u5168\u5c40\u914d\u7f6e\u8d85\u6642\uff08\u5728 <code>celeryconfig.py</code> \u4e2d\uff09\uff1a   <pre><code>task_time_limit = 300  # \u786c\u6027\u8d85\u6642\uff0c\u55ae\u4f4d\uff1a\u79d2\ntask_soft_time_limit = 280  # \u8edf\u6027\u8d85\u6642\uff0c\u55ae\u4f4d\uff1a\u79d2\n</code></pre></li> </ul>"},{"location":"appendix/faq/#rabbitmq","title":"RabbitMQ \u76f8\u95dc\u554f\u984c","text":""},{"location":"appendix/faq/#rabbitmq-connection-refused","title":"RabbitMQ \u9023\u63a5\u5931\u6557\uff0c\u986f\u793a \"Connection Refused\" \u932f\u8aa4\uff1f","text":"<p>\u53ef\u80fd\u539f\u56e0\uff1a</p> <ul> <li>RabbitMQ \u670d\u52d9\u672a\u555f\u52d5\u3002</li> <li>\u9632\u706b\u7246\u6216\u7db2\u7d61\u7b56\u7565\u963b\u6b62\u4e86\u9023\u63a5\u3002</li> <li>\u9023\u63a5\u5b57\u7b26\u4e32\u4e2d\u7684\u4e3b\u6a5f\u6216\u7aef\u53e3\u932f\u8aa4\u3002</li> </ul> <p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u6aa2\u67e5 RabbitMQ \u662f\u5426\u904b\u884c\uff1a<code>rabbitmqctl status</code>\u3002</li> <li>\u78ba\u8a8d\u7aef\u53e3\uff08\u9ed8\u8a8d 5672\uff09\u662f\u5426\u958b\u653e\uff1a<code>telnet host 5672</code>\u3002</li> <li>\u6aa2\u67e5\u9023\u63a5\u5b57\u7b26\u4e32\u662f\u5426\u6b63\u78ba\uff0c\u4f8b\u5982 <code>amqp://user:password@host:5672/vhost</code>\u3002</li> </ul>"},{"location":"appendix/faq/#rabbitmq_1","title":"RabbitMQ \u968a\u5217\u4e2d\u6709\u6d88\u606f\u7a4d\u58d3\uff0c\u5982\u4f55\u8655\u7406\uff1f","text":"<p>\u53ef\u80fd\u539f\u56e0\uff1a</p> <ul> <li>Worker \u6578\u91cf\u4e0d\u8db3\uff0c\u7121\u6cd5\u53ca\u6642\u6d88\u8cbb\u6d88\u606f\u3002</li> <li>\u4efb\u52d9\u8655\u7406\u6642\u9593\u904e\u9577\uff0c\u5c0e\u81f4\u6d88\u606f\u5806\u7a4d\u3002</li> </ul> <p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u589e\u52a0 Worker \u6578\u91cf\uff1a<code>celery -A your_module worker --concurrency=10</code>\u3002</li> <li>\u6aa2\u67e5\u4efb\u52d9\u57f7\u884c\u6642\u9593\uff0c\u512a\u5316\u4ee3\u78bc\u6216\u8a2d\u5b9a\u8d85\u6642\u3002</li> <li>\u4f7f\u7528 RabbitMQ \u7ba1\u7406\u754c\u9762\uff08\u7aef\u53e3 15672\uff09\u67e5\u770b\u968a\u5217\u72c0\u614b\uff0c\u5fc5\u8981\u6642\u624b\u52d5\u6e05\u9664\u7a4d\u58d3\u6d88\u606f\uff1a<code>rabbitmqctl purge_queue queue_name</code>\u3002</li> </ul>"},{"location":"appendix/faq/#rabbitmq_2","title":"\u5982\u4f55\u78ba\u4fdd RabbitMQ \u6d88\u606f\u4e0d\u4e1f\u5931\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u914d\u7f6e\u6301\u4e45\u5316\u968a\u5217\u548c\u6d88\u606f\uff1a   <pre><code>from kombu import Queue, Exchange\nqueue = Queue('tasks', Exchange('tasks'), durable=True)\nproducer.publish({'task': 'data'}, delivery_mode=2)  # 2 \u8868\u793a\u6301\u4e45\u5316\n</code></pre></li> <li>\u555f\u7528\u767c\u5e03\u8005\u78ba\u8a8d\uff08Publisher Confirms\uff09\uff0c\u78ba\u4fdd\u6d88\u606f\u6210\u529f\u767c\u9001\u5230\u968a\u5217\uff1a   <pre><code>producer.publish({'task': 'data'}, confirm=True)\n</code></pre></li> </ul>"},{"location":"appendix/faq/#kombu","title":"Kombu \u76f8\u95dc\u554f\u984c","text":""},{"location":"appendix/faq/#kombu-rabbitmq","title":"Kombu \u9023\u63a5 RabbitMQ \u6642\u51fa\u73fe\u8a8d\u8b49\u932f\u8aa4\uff1f","text":"<p>\u53ef\u80fd\u539f\u56e0\uff1a</p> <ul> <li>\u7528\u6236\u540d\u6216\u5bc6\u78bc\u932f\u8aa4\u3002</li> <li>\u865b\u64ec\u4e3b\u6a5f\uff08vhost\uff09\u914d\u7f6e\u4e0d\u6b63\u78ba\u3002</li> </ul> <p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u6aa2\u67e5\u9023\u63a5\u5b57\u7b26\u4e32\u4e2d\u7684\u7528\u6236\u540d\u3001\u5bc6\u78bc\u548c vhost \u662f\u5426\u6b63\u78ba\u3002</li> <li>\u5728 RabbitMQ \u7ba1\u7406\u754c\u9762\u4e2d\u78ba\u8a8d\u7528\u6236\u6b0a\u9650\uff1a<code>rabbitmqctl list_permissions -p /vhost</code>\u3002</li> <li>\u5982\u679c\u9700\u8981\uff0c\u5275\u5efa\u65b0\u7528\u6236\u4e26\u6388\u6b0a\uff1a   <pre><code>rabbitmqctl add_user user password\nrabbitmqctl set_permissions -p /vhost user \".*\" \".*\" \".*\"\n</code></pre></li> </ul>"},{"location":"appendix/faq/#kombu_1","title":"\u5982\u4f55\u4f7f\u7528 Kombu \u5be6\u73fe\u6d88\u606f\u7684\u767c\u5e03\u8207\u8a02\u95b1\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528 <code>topic</code> \u4ea4\u63db\u6a5f\u5be6\u73fe\u767c\u5e03/\u8a02\u95b1\u6a21\u5f0f\uff1a   <pre><code>from kombu import Exchange, Queue, Producer, Consumer, Connection\n\nevent_exchange = Exchange('events', type='topic')\nqueue = Queue('event_queue', event_exchange, routing_key='event.*')\n\n# \u767c\u5e03\u6d88\u606f\nwith Connection('amqp://user:password@host:5672//') as conn:\n    producer = Producer(conn)\n    producer.publish({'data': 'event'}, exchange=event_exchange, routing_key='event.created')\n\n# \u8a02\u95b1\u6d88\u606f\ndef callback(body, message):\n    print(f\"Received: {body}\")\n    message.ack()\n\nwith Connection('amqp://user:password@host:5672//') as conn:\n    consumer = Consumer(conn, queues=queue, callbacks=[callback])\n    consumer.consume()\n</code></pre></li> </ul>"},{"location":"appendix/faq/#_1","title":"\u90e8\u7f72\u8207\u6548\u80fd\u554f\u984c","text":""},{"location":"appendix/faq/#celery-worker","title":"\u5982\u4f55\u5728\u5927\u898f\u6a21\u74b0\u5883\u4e2d\u907f\u514d Celery Worker \u8cc7\u6e90\u722d\u7528\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u70ba\u4e0d\u540c\u4efb\u52d9\u985e\u578b\u914d\u7f6e\u5c08\u7528 Worker \u548c\u968a\u5217\uff1a   <pre><code>celery -A your_module worker -Q high_priority --concurrency=5\ncelery -A your_module worker -Q default --concurrency=10\n</code></pre></li> <li>\u4f7f\u7528 Kubernetes \u6216 Docker \u9650\u5236\u6bcf\u500b Worker \u7684\u8cc7\u6e90\u4f7f\u7528\uff0c\u9632\u6b62\u55ae\u4e00 Worker \u904e\u8f09\u7cfb\u7d71\u3002</li> <li>\u76e3\u63a7 Worker \u7684 CPU \u548c\u5167\u5b58\u4f7f\u7528\uff0c\u52d5\u614b\u8abf\u6574\u4f75\u767c\u6578\u3002</li> </ul>"},{"location":"appendix/faq/#rabbitmq_3","title":"RabbitMQ \u96c6\u7fa4\u4e2d\u7bc0\u9ede\u540c\u6b65\u5931\u6557\uff0c\u5982\u4f55\u6392\u67e5\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u6aa2\u67e5\u96c6\u7fa4\u72c0\u614b\uff1a<code>rabbitmqctl cluster_status</code>\u3002</li> <li>\u78ba\u8a8d\u7bc0\u9ede\u9593\u7db2\u7d61\u9023\u63a5\u662f\u5426\u6b63\u5e38\uff0c\u7aef\u53e3\uff084369\u300125672\uff09\u662f\u5426\u958b\u653e\u3002</li> <li>\u67e5\u770b\u65e5\u8a8c\u6587\u4ef6\uff08\u901a\u5e38\u4f4d\u65bc <code>/var/log/rabbitmq/</code>\uff09\uff0c\u67e5\u627e\u5177\u9ad4\u932f\u8aa4\u4fe1\u606f\u3002</li> <li>\u5982\u679c\u554f\u984c\u6301\u7e8c\uff0c\u8003\u616e\u91cd\u65b0\u52a0\u5165\u7bc0\u9ede\uff1a<code>rabbitmqctl join_cluster rabbit@other_node</code>\u3002</li> </ul>"},{"location":"appendix/faq/#_2","title":"\u5176\u4ed6\u5e38\u898b\u554f\u984c","text":""},{"location":"appendix/faq/#celery_4","title":"\u5982\u4f55\u5728 Celery \u4e2d\u5be6\u73fe\u5b9a\u6642\u4efb\u52d9\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528 <code>celery beat</code> \u63d2\u4ef6\uff1a   <pre><code>pip install django-celery-beat\ncelery -A your_module beat\n</code></pre></li> <li>\u5728 Django Admin \u6216\u7a0b\u5f0f\u78bc\u4e2d\u914d\u7f6e\u5b9a\u6642\u4efb\u52d9\uff1a   <pre><code>from celery.schedules import crontab\nfrom django_celery_beat.models import PeriodicTask, CrontabSchedule\n\nschedule, _ = CrontabSchedule.objects.get_or_create(minute='0', hour='*')\nPeriodicTask.objects.create(crontab=schedule, name='hourly_task', task='your_task')\n</code></pre></li> </ul>"},{"location":"appendix/faq/#celery_5","title":"\u5982\u4f55\u6e05\u7406 Celery \u7684\u7d50\u679c\u5f8c\u7aef\u6578\u64da\uff1f","text":"<p>\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ul> <li>\u5982\u679c\u4f7f\u7528 Redis \u4f5c\u70ba\u7d50\u679c\u5f8c\u7aef\uff0c\u53ef\u4ee5\u624b\u52d5\u6e05\u7406\uff1a   <pre><code>redis-cli -h host -p 6379 FLUSHDB\n</code></pre></li> <li>\u8a2d\u5b9a\u7d50\u679c\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u6578\u64da\u7a4d\u7d2f\uff1a   <pre><code>app.conf.result_expires = 86400  # \u7d50\u679c1\u5929\u5f8c\u904e\u671f\n</code></pre></li> </ul> <p>\u5982\u679c\u60a8\u5728\u4ee5\u4e0a\u554f\u984c\u4e2d\u627e\u4e0d\u5230\u89e3\u6c7a\u65b9\u6848\uff0c\u5efa\u8b70\u67e5\u95b1\u5b98\u65b9\u6587\u6a94\u6216\u5728 Stack Overflow\u3001RabbitMQ \u793e\u5340\u7b49\u5e73\u53f0\u5c0b\u6c42\u5e6b\u52a9\u3002</p>"},{"location":"appendix/glossary/","title":"\u8853\u8a9e\u8868","text":"<p>\u672c\u9644\u9304\u6574\u7406\u4e86\u8207 Celery\u3001Kombu \u548c RabbitMQ \u76f8\u95dc\u7684\u5e38\u7528\u8853\u8a9e\u53ca\u5176\u7c21\u8981\u5b9a\u7fa9\uff0c\u5e6b\u52a9\u60a8\u5feb\u901f\u7406\u89e3\u9019\u4e9b\u5de5\u5177\u7684\u6838\u5fc3\u6982\u5ff5\u3002\u8853\u8a9e\u8868\u63a1\u7528\u8868\u683c\u683c\u5f0f\uff0c\u65b9\u4fbf\u95b1\u8b80\u548c\u67e5\u8a62\u3002</p> \u8853\u8a9e \u5b9a\u7fa9 AMQP \u5148\u9032\u6d88\u606f\u968a\u5217\u5354\u8b70\uff0cRabbitMQ \u4f7f\u7528\u7684\u6a19\u6e96\u5354\u8b70\uff0c\u7528\u65bc\u6d88\u606f\u50b3\u8f38\u3002 Broker \u6d88\u606f\u4ee3\u7406\uff0c\u8ca0\u8cac\u63a5\u6536\u548c\u5206\u767c\u6d88\u606f\uff0cCelery \u4f7f\u7528 RabbitMQ \u6216 Redis \u4f5c\u70ba Broker\u3002 Celery \u57fa\u65bc Python \u7684\u5206\u6563\u5f0f\u4efb\u52d9\u968a\u5217\u6846\u67b6\uff0c\u7528\u65bc\u8655\u7406\u7570\u6b65\u4efb\u52d9\u548c\u5b9a\u6642\u4efb\u52d9\u3002 Concurrency Celery Worker \u80fd\u540c\u6642\u8655\u7406\u7684\u4efb\u52d9\u6578\u91cf\uff0c\u8207\u786c\u9ad4\u8cc7\u6e90\u76f8\u95dc\u3002 Durable RabbitMQ \u4e2d\u7684\u5c6c\u6027\uff0c\u78ba\u4fdd\u968a\u5217\u6216\u4ea4\u63db\u6a5f\u5728\u670d\u52d9\u91cd\u555f\u5f8c\u4ecd\u7136\u5b58\u5728\u3002 Exchange RabbitMQ \u4e2d\u7684\u7d44\u4ef6\uff0c\u8ca0\u8cac\u5c07\u6d88\u606f\u5206\u767c\u5230\u968a\u5217\uff0c\u985e\u578b\u5305\u62ec direct\u3001topic \u7b49\u3002 Flower Celery \u7684\u76e3\u63a7\u5de5\u5177\uff0c\u63d0\u4f9b Web \u754c\u9762\u67e5\u770b\u4efb\u52d9\u548c Worker \u72c0\u614b\u3002 Kombu Python \u5eab\uff0cCelery \u7684\u5e95\u5c64\u6d88\u606f\u50b3\u8f38\u5c64\uff0c\u7528\u65bc\u8207 RabbitMQ \u7b49\u5f8c\u7aef\u4ea4\u4e92\u3002 Message \u5728 RabbitMQ \u548c Celery \u4e2d\u50b3\u8f38\u7684\u6578\u64da\u55ae\u4f4d\uff0c\u901a\u5e38\u5305\u542b\u4efb\u52d9\u4fe1\u606f\u3002 Queue RabbitMQ \u4e2d\u7684\u7d44\u4ef6\uff0c\u7528\u65bc\u5132\u5b58\u6d88\u606f\uff0c\u7b49\u5f85\u6d88\u8cbb\u8005\u8655\u7406\u3002 Result Backend Celery \u4e2d\u7528\u65bc\u5132\u5b58\u4efb\u52d9\u7d50\u679c\u7684\u5f8c\u7aef\uff0c\u5982 Redis\uff0c\u7528\u65bc\u72c0\u614b\u67e5\u8a62\u3002 Routing Key RabbitMQ \u4e2d\u7528\u65bc\u6c7a\u5b9a\u6d88\u606f\u5206\u767c\u5230\u54ea\u500b\u968a\u5217\u7684\u6a19\u8b58\u3002 Task Celery \u4e2d\u7684\u5de5\u4f5c\u55ae\u4f4d\uff0c\u8868\u793a\u9700\u8981\u7570\u6b65\u57f7\u884c\u7684\u51fd\u6578\u6216\u64cd\u4f5c\u3002 Worker Celery \u4e2d\u7684\u9032\u7a0b\uff0c\u8ca0\u8cac\u5f9e\u968a\u5217\u4e2d\u7372\u53d6\u4efb\u52d9\u4e26\u57f7\u884c\u3002 <p>\u5982\u679c\u60a8\u9700\u8981\u5c0d\u67d0\u500b\u8853\u8a9e\u6709\u66f4\u6df1\u5165\u7684\u4e86\u89e3\uff0c\u5efa\u8b70\u67e5\u95b1\u5b98\u65b9\u6587\u6a94\u6216\u76f8\u95dc\u6559\u7a0b\u3002</p>"},{"location":"appendix/learning-resources/","title":"\u5b78\u7fd2\u8cc7\u6e90","text":"<p>\u672c\u9644\u9304\u6574\u7406\u4e86\u8207 Celery\u3001Kombu \u548c RabbitMQ \u76f8\u95dc\u7684\u5b78\u7fd2\u8cc7\u6e90\uff0c\u5e6b\u52a9\u60a8\u9032\u4e00\u6b65\u6df1\u5165\u4e86\u89e3\u9019\u4e9b\u5de5\u5177\u7684\u7528\u6cd5\u3001\u6700\u4f73\u5be6\u8e10\u4ee5\u53ca\u793e\u5340\u652f\u6301\u3002\u9019\u4e9b\u8cc7\u6e90\u4e3b\u8981\u805a\u7126\u65bc\u5b98\u65b9\u5167\u5bb9\uff0c\u9069\u5408\u521d\u5b78\u8005\u548c\u9032\u968e\u7528\u6236\u3002</p>"},{"location":"appendix/learning-resources/#1","title":"1. \u5b98\u65b9\u6587\u6a94","text":"<p>\u5b98\u65b9\u6587\u6a94\u662f\u5b78\u7fd2\u548c\u89e3\u6c7a\u554f\u984c\u7684\u9996\u8981\u8cc7\u6e90\uff0c\u63d0\u4f9b\u6700\u6b0a\u5a01\u548c\u6700\u65b0\u7684\u4fe1\u606f\u3002</p> <ul> <li> <p>Celery \u5b98\u65b9\u6587\u6a94   \u7db2\u5740\uff1ahttps://docs.celeryproject.org/   \u5167\u5bb9\uff1a\u6db5\u84cb Celery \u7684\u5b89\u88dd\u3001\u914d\u7f6e\u3001\u4efb\u52d9\u8abf\u5ea6\u3001\u5de5\u4f5c\u6d41\u8a2d\u8a08\u7b49\u6240\u6709\u529f\u80fd\uff0c\u9069\u5408\u521d\u5b78\u8005\u548c\u9032\u968e\u7528\u6236\u3002</p> </li> <li> <p>Kombu \u5b98\u65b9\u6587\u6a94   \u7db2\u5740\uff1ahttps://kombu.readthedocs.io/   \u5167\u5bb9\uff1a\u8a73\u7d30\u4ecb\u7d39 Kombu \u7684\u6d88\u606f\u968a\u5217\u64cd\u4f5c\uff0c\u5305\u62ec\u8207 RabbitMQ\u3001Redis \u7b49\u5f8c\u7aef\u7684\u6574\u5408\u3002</p> </li> <li> <p>RabbitMQ \u5b98\u65b9\u6587\u6a94   \u7db2\u5740\uff1ahttps://www.rabbitmq.com/documentation.html   \u5167\u5bb9\uff1a\u63d0\u4f9b RabbitMQ \u7684\u5b89\u88dd\u3001\u914d\u7f6e\u3001\u96c6\u7fa4\u7ba1\u7406\u3001\u9ad8\u53ef\u7528\u6027\u7b49\u65b9\u9762\u7684\u5b8c\u6574\u6307\u5357\u3002</p> </li> </ul>"},{"location":"appendix/learning-resources/#2","title":"2. \u6559\u7a0b\u8207\u6307\u5357","text":"<p>\u9019\u4e9b\u5b98\u65b9\u6559\u7a0b\u548c\u6307\u5357\u9069\u5408\u5e0c\u671b\u901a\u904e\u5be6\u8e10\u5b78\u7fd2\u7684\u7528\u6236\u3002</p> <ul> <li> <p>Celery \u5165\u9580\u6559\u7a0b   \u7db2\u5740\uff1ahttps://docs.celeryproject.org/en/stable/getting-started/first-steps-with-celery.html   \u5167\u5bb9\uff1a\u4e00\u6b65\u6b65\u6307\u5c0e\u60a8\u5275\u5efa\u7b2c\u4e00\u500b Celery \u4efb\u52d9\uff0c\u9069\u5408\u521d\u5b78\u8005\u3002</p> </li> <li> <p>RabbitMQ \u6559\u7a0b   \u7db2\u5740\uff1ahttps://www.rabbitmq.com/tutorials.html   \u5167\u5bb9\uff1a\u63d0\u4f9b\u591a\u7a2e\u7a0b\u5f0f\u8a9e\u8a00\u7684 RabbitMQ \u4f7f\u7528\u793a\u4f8b\uff0c\u4ecb\u7d39\u4ea4\u63db\u6a5f\u3001\u968a\u5217\u3001\u6d88\u606f\u767c\u5e03\u7b49\u57fa\u790e\u6982\u5ff5\u3002</p> </li> </ul>"},{"location":"appendix/learning-resources/#3","title":"3. \u793e\u5340\u8207\u8ad6\u58c7","text":"<p>\u793e\u5340\u548c\u8ad6\u58c7\u662f\u89e3\u6c7a\u554f\u984c\u548c\u4ea4\u6d41\u7d93\u9a57\u7684\u597d\u5730\u65b9\u3002</p> <ul> <li> <p>Stack Overflow   \u7db2\u5740\uff1ahttps://stackoverflow.com/questions/tagged/celery   \u5167\u5bb9\uff1a\u91dd\u5c0d Celery\u3001Kombu \u548c RabbitMQ \u7684\u554f\u984c\u548c\u89e3\u7b54\uff0c\u6db5\u84cb\u5404\u7a2e\u5be6\u969b\u5834\u666f\u3002</p> </li> <li> <p>RabbitMQ \u90f5\u4ef6\u5217\u8868\u8207 Google Group   \u7db2\u5740\uff1ahttps://www.rabbitmq.com/community.html   \u5167\u5bb9\uff1aRabbitMQ \u5b98\u65b9\u63d0\u4f9b\u7684\u90f5\u4ef6\u5217\u8868\u548c\u8a0e\u8ad6\u7d44\uff0c\u9069\u5408\u63d0\u51fa\u554f\u984c\u6216\u53c3\u8207\u6280\u8853\u8a0e\u8ad6\u3002</p> </li> </ul>"},{"location":"appendix/learning-resources/#4","title":"4. \u4ee3\u78bc\u793a\u4f8b\u8207\u9805\u76ee","text":"<p>\u901a\u904e\u5be6\u969b\u4ee3\u78bc\u5b78\u7fd2\u662f\u638c\u63e1\u6280\u8853\u7684\u6709\u6548\u65b9\u5f0f\u3002</p> <ul> <li> <p>Celery \u793a\u4f8b\u9805\u76ee   \u7db2\u5740\uff1ahttps://github.com/celery/celery/tree/master/examples   \u5167\u5bb9\uff1aCelery \u5b98\u65b9\u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u78bc\uff0c\u6db5\u84cb\u57fa\u790e\u4efb\u52d9\u3001\u5de5\u4f5c\u6d41\u548c\u5b9a\u6642\u4efb\u52d9\u7b49\u3002</p> </li> <li> <p>RabbitMQ \u793a\u4f8b\u4ee3\u78bc   \u7db2\u5740\uff1ahttps://github.com/rabbitmq/rabbitmq-tutorials   \u5167\u5bb9\uff1aRabbitMQ \u63d0\u4f9b\u7684\u591a\u8a9e\u8a00\u793a\u4f8b\uff0c\u5c55\u793a\u6d88\u606f\u767c\u5e03\u3001\u8a02\u95b1\u548c\u5de5\u4f5c\u968a\u5217\u7b49\u6a21\u5f0f\u3002</p> </li> </ul>"},{"location":"appendix/learning-resources/#5","title":"5. \u5de5\u5177\u8207\u63d2\u4ef6","text":"<p>\u9019\u4e9b\u5b98\u65b9\u5de5\u5177\u53ef\u4ee5\u5e6b\u52a9\u60a8\u66f4\u597d\u5730\u7ba1\u7406\u548c\u76e3\u63a7\u7cfb\u7d71\u3002</p> <ul> <li> <p>Flower   \u7db2\u5740\uff1ahttps://github.com/mher/flower   \u5167\u5bb9\uff1aCelery \u7684\u76e3\u63a7\u5de5\u5177\uff0c\u63d0\u4f9b Web \u754c\u9762\u67e5\u770b\u4efb\u52d9\u72c0\u614b\u548c Worker \u4fe1\u606f\u3002</p> </li> <li> <p>RabbitMQ Management Plugin   \u7db2\u5740\uff1ahttps://www.rabbitmq.com/management.html   \u5167\u5bb9\uff1aRabbitMQ \u5b98\u65b9\u7ba1\u7406\u63d2\u4ef6\uff0c\u63d0\u4f9b\u5716\u5f62\u5316\u754c\u9762\u7ba1\u7406\u968a\u5217\u3001\u4ea4\u63db\u6a5f\u548c\u9023\u63a5\u3002</p> </li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u8cc7\u6e90\uff0c\u60a8\u53ef\u4ee5\u7cfb\u7d71\u5316\u5b78\u7fd2 Celery\u3001Kombu \u548c RabbitMQ\uff0c\u4e26\u5c07\u5176\u61c9\u7528\u5230\u5be6\u969b\u9805\u76ee\u4e2d\u3002\u5982\u679c\u60a8\u767c\u73fe\u5176\u4ed6\u6709\u50f9\u503c\u7684\u8cc7\u6e90\uff0c\u6b61\u8fce\u8207\u793e\u5340\u5206\u4eab\uff01</p>"},{"location":"basics/","title":"\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u57fa\u790e","text":"<p>\u6b61\u8fce\u4f86\u5230\u300c\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u57fa\u790e\u300d\u7ae0\u7bc0\uff01\u672c\u7ae0\u7bc0\u5c07\u5e6b\u52a9\u60a8\u5efa\u7acb\u5c0d\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u3001\u7570\u6b65\u8655\u7406\u53ca\u76f8\u95dc\u6280\u8853\u7684\u57fa\u672c\u8a8d\u8b58\uff0c\u70ba\u5f8c\u7e8c\u5b78\u7fd2 Celery \u548c RabbitMQ \u6253\u4e0b\u5805\u5be6\u7684\u57fa\u790e\u3002</p>"},{"location":"basics/#_2","title":"\u4ec0\u9ebc\u662f\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\uff1f","text":"<p>\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u662f\u4e00\u7a2e\u5c07\u8a08\u7b97\u4efb\u52d9\u5206\u914d\u5230\u591a\u500b\u7bc0\u9ede\u6216\u9032\u7a0b\u4e2d\u57f7\u884c\u7684\u6280\u8853\uff0c\u65e8\u5728\u63d0\u9ad8\u7cfb\u7d71\u7684\u6548\u7387\u3001\u53ef\u64f4\u5c55\u6027\u548c\u53ef\u9760\u6027\u3002\u5728\u73fe\u4ee3\u61c9\u7528\u4e2d\uff0c\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u5e38\u7528\u65bc\u8655\u7406\u80cc\u666f\u4efb\u52d9\u3001\u6279\u91cf\u64cd\u4f5c\u6216\u9700\u8981\u9577\u6642\u9593\u904b\u884c\u7684\u4f5c\u696d\u3002</p> <p>\u4f8b\u5982\uff0c\u7576\u60a8\u5728\u7db2\u7ad9\u4e0a\u4e0a\u50b3\u4e00\u5f35\u5716\u7247\u6642\uff0c\u5716\u7247\u7684\u58d3\u7e2e\u548c\u8655\u7406\u53ef\u80fd\u4e0d\u6703\u7acb\u5373\u5b8c\u6210\uff0c\u800c\u662f\u4ea4\u7531\u5f8c\u53f0\u4efb\u52d9\u8655\u7406\uff0c\u9019\u5c31\u662f\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u4e00\u500b\u5178\u578b\u61c9\u7528\u3002</p>"},{"location":"basics/#_3","title":"\u70ba\u4ec0\u9ebc\u9700\u8981\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\uff1f","text":"<ul> <li>\u63d0\u5347\u7528\u6236\u9ad4\u9a57\uff1a\u5c07\u8017\u6642\u64cd\u4f5c\u5f9e\u4e3b\u9032\u7a0b\u4e2d\u5206\u96e2\uff0c\u907f\u514d\u7528\u6236\u7b49\u5f85\u3002</li> <li>\u63d0\u9ad8\u7cfb\u7d71\u6548\u7387\uff1a\u5229\u7528\u591a\u6838\u3001\u591a\u6a5f\u8cc7\u6e90\u4e26\u884c\u8655\u7406\u4efb\u52d9\u3002</li> <li>\u589e\u5f37\u53ef\u64f4\u5c55\u6027\uff1a\u901a\u904e\u6dfb\u52a0\u66f4\u591a\u5de5\u4f5c\u7bc0\u9ede\uff0c\u8f15\u9b06\u61c9\u5c0d\u4efb\u52d9\u91cf\u589e\u9577\u3002</li> <li>\u53ef\u9760\u6027\u8207\u5bb9\u932f\uff1a\u4efb\u52d9\u5931\u6557\u6642\u53ef\u91cd\u8a66\u6216\u91cd\u65b0\u5206\u914d\uff0c\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u3002</li> </ul>"},{"location":"basics/#_4","title":"\u672c\u7ae0\u7bc0\u5167\u5bb9\u6982\u8ff0","text":"<p>\u5728\u672c\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4ee5\u4e0b\u6838\u5fc3\u6982\u5ff5\uff1a</p> <ul> <li>\u7570\u6b65\u4efb\u52d9\u8655\u7406\u6982\u5ff5\uff1a\u4e86\u89e3\u540c\u6b65\u8207\u7570\u6b65\u8655\u7406\u7684\u5340\u5225\uff0c\u4ee5\u53ca\u7570\u6b65\u8655\u7406\u5728\u5206\u6563\u5f0f\u7cfb\u7d71\u4e2d\u7684\u4f5c\u7528\u3002</li> <li>\u6d88\u606f\u968a\u5217\u57fa\u672c\u539f\u7406\uff1a\u5b78\u7fd2\u6d88\u606f\u968a\u5217\u5982\u4f55\u5354\u8abf\u4efb\u52d9\u7684\u5206\u767c\u8207\u57f7\u884c\u3002</li> <li>\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\uff1a\u63a2\u7d22\u4efb\u52d9\u751f\u6210\u8207\u8655\u7406\u7684\u7d93\u5178\u8a2d\u8a08\u6a21\u5f0f\u3002</li> <li>\u4efb\u52d9\u5206\u767c\u8207\u57f7\u884c\u6d41\u7a0b\uff1a\u7406\u89e3\u4efb\u52d9\u5f9e\u5275\u5efa\u5230\u5b8c\u6210\u7684\u5b8c\u6574\u751f\u547d\u9031\u671f\u3002</li> </ul>"},{"location":"basics/#_5","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5b8c\u6210\u672c\u7ae0\u7bc0\u5f8c\uff0c\u60a8\u5c07\u80fd\u5920\uff1a - \u7406\u89e3\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u57fa\u672c\u539f\u7406\u8207\u61c9\u7528\u5834\u666f\u3002 - \u5340\u5206\u540c\u6b65\u8207\u7570\u6b65\u8655\u7406\u7684\u9069\u7528\u5834\u666f\u3002 - \u638c\u63e1\u6d88\u606f\u968a\u5217\u548c\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u7684\u6838\u5fc3\u601d\u60f3\u3002</p> <p>\u8b93\u6211\u5011\u5f9e\u300c\u7570\u6b65\u4efb\u52d9\u8655\u7406\u6982\u5ff5\u300d\u958b\u59cb\uff0c\u9010\u6b65\u63a2\u7d22\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u4e16\u754c\uff01</p> <p>\u63d0\u793a\uff1a\u672c\u7ae0\u7bc0\u9069\u5408\u521d\u5b78\u8005\u95b1\u8b80\uff0c\u7121\u9700\u4e8b\u5148\u5177\u5099 Celery \u6216 RabbitMQ \u7684\u77e5\u8b58\u3002\u82e5\u60a8\u5df2\u6709\u76f8\u95dc\u7d93\u9a57\uff0c\u53ef\u5feb\u901f\u700f\u89bd\u4ee5\u978f\u56fa\u57fa\u790e\u3002</p>"},{"location":"basics/async-concepts/","title":"\u7570\u6b65\u4efb\u52d9\u8655\u7406\u6982\u5ff5","text":"<p>\u5728\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u4e2d\uff0c\u7570\u6b65\u8655\u7406\u662f\u4e00\u500b\u6838\u5fc3\u6982\u5ff5\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u4ec0\u9ebc\u662f\u7570\u6b65\u4efb\u52d9\u8655\u7406\u3001\u8207\u540c\u6b65\u8655\u7406\u7684\u5340\u5225\uff0c\u4ee5\u53ca\u5b83\u5728\u73fe\u4ee3\u61c9\u7528\u4e2d\u7684\u91cd\u8981\u6027\u3002</p>"},{"location":"basics/async-concepts/#_2","title":"\u4ec0\u9ebc\u662f\u540c\u6b65\u8207\u7570\u6b65\u8655\u7406\uff1f","text":"<ul> <li>\u540c\u6b65\u8655\u7406\uff1a\u7576\u60a8\u57f7\u884c\u4e00\u500b\u4efb\u52d9\u6642\uff0c\u5fc5\u9808\u7b49\u5f85\u8a72\u4efb\u52d9\u5b8c\u6210\u5f8c\u624d\u80fd\u9032\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5728\u7db2\u9801\u61c9\u7528\u4e2d\uff0c\u5982\u679c\u5716\u7247\u4e0a\u50b3\u5f8c\u9700\u8981\u7b49\u5f85\u4f3a\u670d\u5668\u8655\u7406\u5b8c\u6210\u624d\u80fd\u986f\u793a\u7d50\u679c\uff0c\u9019\u5c31\u662f\u540c\u6b65\u8655\u7406\u3002\u7528\u6236\u6703\u611f\u53d7\u5230\u660e\u986f\u7684\u7b49\u5f85\u6642\u9593\u3002</li> <li>\u7570\u6b65\u8655\u7406\uff1a\u4efb\u52d9\u63d0\u4ea4\u5f8c\u4e0d\u9700\u8981\u7b49\u5f85\u5176\u5b8c\u6210\uff0c\u53ef\u4ee5\u7acb\u5373\u9032\u884c\u5176\u4ed6\u64cd\u4f5c\u3002\u4f3a\u670d\u5668\u6703\u5728\u5f8c\u53f0\u8655\u7406\u4efb\u52d9\uff0c\u4e26\u5728\u5b8c\u6210\u5f8c\u901a\u77e5\u7528\u6236\u6216\u66f4\u65b0\u7d50\u679c\u3002\u4f8b\u5982\uff0c\u5716\u7247\u4e0a\u50b3\u5f8c\u7528\u6236\u53ef\u4ee5\u7e7c\u7e8c\u700f\u89bd\u9801\u9762\uff0c\u800c\u8655\u7406\u7d50\u679c\u7a0d\u5f8c\u6703\u81ea\u52d5\u66f4\u65b0\u3002</li> </ul>"},{"location":"basics/async-concepts/#_3","title":"\u7570\u6b65\u8655\u7406\u7684\u512a\u52e2","text":"<ul> <li>\u63d0\u5347\u7528\u6236\u9ad4\u9a57\uff1a\u7528\u6236\u7121\u9700\u7b49\u5f85\u9577\u6642\u9593\u4efb\u52d9\u5b8c\u6210\uff0c\u64cd\u4f5c\u66f4\u6d41\u66a2\u3002</li> <li>\u63d0\u9ad8\u8cc7\u6e90\u5229\u7528\u7387\uff1a\u4e3b\u9032\u7a0b\u53ef\u4ee5\u7e7c\u7e8c\u8655\u7406\u5176\u4ed6\u8acb\u6c42\uff0c\u5f8c\u53f0\u4efb\u52d9\u7368\u7acb\u57f7\u884c\u3002</li> <li>\u652f\u63f4\u4e26\u884c\u8655\u7406\uff1a\u591a\u500b\u4efb\u52d9\u53ef\u4ee5\u540c\u6642\u57f7\u884c\uff0c\u7279\u5225\u9069\u5408\u5206\u6563\u5f0f\u7cfb\u7d71\u3002</li> </ul>"},{"location":"basics/async-concepts/#_4","title":"\u7570\u6b65\u8655\u7406\u7684\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u96fb\u5b50\u90f5\u4ef6\u767c\u9001\uff1a\u7528\u6236\u8a3b\u518a\u5f8c\uff0c\u7cfb\u7d71\u5728\u5f8c\u53f0\u767c\u9001\u78ba\u8a8d\u90f5\u4ef6\uff0c\u7121\u9700\u7528\u6236\u7b49\u5f85\u3002</li> <li>\u6578\u64da\u8655\u7406\uff1a\u5927\u898f\u6a21\u6578\u64da\u5206\u6790\u6216\u5831\u8868\u751f\u6210\uff0c\u4efb\u52d9\u5728\u5f8c\u53f0\u904b\u884c\uff0c\u7d50\u679c\u7a0d\u5f8c\u63d0\u4f9b\u3002</li> <li>\u6587\u4ef6\u8655\u7406\uff1a\u4e0a\u50b3\u6587\u4ef6\u5f8c\uff0c\u7cfb\u7d71\u5728\u5f8c\u53f0\u9032\u884c\u58d3\u7e2e\u3001\u8f49\u63db\u6216\u5206\u6790\u3002</li> </ul>"},{"location":"basics/async-concepts/#_5","title":"\u7570\u6b65\u8655\u7406\u7684\u57fa\u672c\u5be6\u73fe\u65b9\u5f0f","text":"<p>\u7570\u6b65\u8655\u7406\u901a\u5e38\u901a\u904e\u4ee5\u4e0b\u65b9\u5f0f\u5be6\u73fe\uff1a 1. \u591a\u7dda\u7a0b/\u591a\u9032\u7a0b\uff1a\u5728\u55ae\u6a5f\u4e0a\u4f7f\u7528\u591a\u7dda\u7a0b\u6216\u591a\u9032\u7a0b\u4e26\u884c\u8655\u7406\u4efb\u52d9\u3002 2. \u4e8b\u4ef6\u9a45\u52d5\u6a21\u578b\uff1a\u57fa\u65bc\u4e8b\u4ef6\u5faa\u74b0\uff08\u5982 Node.js\uff09\uff0c\u4efb\u52d9\u89f8\u767c\u5f8c\u7531\u4e8b\u4ef6\u8655\u7406\u7a0b\u5e8f\u63a5\u7ba1\u3002 3. \u5206\u6563\u5f0f\u4efb\u52d9\u968a\u5217\uff1a\u4f7f\u7528\u5de5\u5177\u5982 Celery\uff0c\u5c07\u4efb\u52d9\u5206\u767c\u5230\u591a\u500b\u5de5\u4f5c\u7bc0\u9ede\u8655\u7406\uff08\u9019\u662f\u672c\u7b46\u8a18\u5f8c\u7e8c\u91cd\u9ede\uff09\u3002</p>"},{"location":"basics/async-concepts/#_6","title":"\u5c0f\u7d50","text":"<p>\u7570\u6b65\u4efb\u52d9\u8655\u7406\u662f\u5206\u6563\u5f0f\u7cfb\u7d71\u7684\u57fa\u790e\uff0c\u5b83\u901a\u904e\u5c07\u8017\u6642\u4efb\u52d9\u5f9e\u4e3b\u6d41\u7a0b\u4e2d\u5206\u96e2\uff0c\u63d0\u5347\u4e86\u7cfb\u7d71\u7684\u97ff\u61c9\u6027\u548c\u6548\u7387\u3002\u5728\u63a5\u4e0b\u4f86\u7684\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u5982\u4f55\u901a\u904e\u300c\u6d88\u606f\u968a\u5217\u300d\u4f86\u5be6\u73fe\u7570\u6b65\u4efb\u52d9\u7684\u5206\u767c\u8207\u7ba1\u7406\u3002</p> <p>\u63d0\u793a\uff1a\u7406\u89e3\u540c\u6b65\u8207\u7570\u6b65\u7684\u5340\u5225\u662f\u5b78\u7fd2\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u7b2c\u4e00\u6b65\u3002\u5f8c\u7e8c\u6211\u5011\u5c07\u4ee5 Celery \u70ba\u4f8b\uff0c\u5c55\u793a\u5982\u4f55\u5728\u5be6\u969b\u9805\u76ee\u4e2d\u5be6\u73fe\u7570\u6b65\u8655\u7406\u3002</p>"},{"location":"basics/message-queue-principles/","title":"\u6d88\u606f\u968a\u5217\u57fa\u672c\u539f\u7406","text":"<p>\u6d88\u606f\u968a\u5217\uff08Message Queue\uff09\u662f\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u4e2d\u7684\u6838\u5fc3\u7d44\u4ef6\uff0c\u7528\u65bc\u5728\u4e0d\u540c\u9032\u7a0b\u6216\u7cfb\u7d71\u4e4b\u9593\u50b3\u905e\u4efb\u52d9\u548c\u6578\u64da\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u6d88\u606f\u968a\u5217\u7684\u57fa\u672c\u539f\u7406\u53ca\u5176\u5728\u7570\u6b65\u8655\u7406\u4e2d\u7684\u4f5c\u7528\u3002</p>"},{"location":"basics/message-queue-principles/#_2","title":"\u4ec0\u9ebc\u662f\u6d88\u606f\u968a\u5217\uff1f","text":"<p>\u6d88\u606f\u968a\u5217\u662f\u4e00\u7a2e\u4e2d\u9593\u4ef6\u6280\u8853\uff0c\u5141\u8a31\u7cfb\u7d71\u4e2d\u7684\u4e0d\u540c\u90e8\u5206\uff08\u751f\u7522\u8005\u548c\u6d88\u8cbb\u8005\uff09\u901a\u904e\u6d88\u606f\u9032\u884c\u901a\u4fe1\u3002\u6d88\u606f\u968a\u5217\u5c31\u50cf\u4e00\u500b\u7de9\u885d\u5340\uff0c\u751f\u7522\u8005\u5c07\u4efb\u52d9\u6216\u6578\u64da\u653e\u5165\u968a\u5217\uff0c\u6d88\u8cbb\u8005\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u4e26\u8655\u7406\u3002</p>"},{"location":"basics/message-queue-principles/#_3","title":"\u6d88\u606f\u968a\u5217\u7684\u6838\u5fc3\u7d44\u6210","text":"<ul> <li>\u751f\u7522\u8005\uff08Producer\uff09\uff1a\u8ca0\u8cac\u5275\u5efa\u6d88\u606f\u4e26\u5c07\u5176\u767c\u9001\u5230\u968a\u5217\u4e2d\u3002\u4f8b\u5982\uff0c\u7db2\u9801\u61c9\u7528\u6536\u5230\u7528\u6236\u8acb\u6c42\u5f8c\u751f\u6210\u4e00\u500b\u4efb\u52d9\u3002</li> <li>\u968a\u5217\uff08Queue\uff09\uff1a\u5b58\u5132\u6d88\u606f\u7684\u7de9\u885d\u5340\uff0c\u78ba\u4fdd\u6d88\u606f\u6309\u9806\u5e8f\u6216\u512a\u5148\u7d1a\u88ab\u8655\u7406\u3002</li> <li>\u6d88\u8cbb\u8005\uff08Consumer\uff09\uff1a\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u6d88\u606f\u4e26\u57f7\u884c\u76f8\u61c9\u4efb\u52d9\u3002\u4f8b\u5982\uff0c\u5f8c\u53f0\u5de5\u4f5c\u9032\u7a0b\u8655\u7406\u6578\u64da\u5206\u6790\u4efb\u52d9\u3002</li> <li>\u4e2d\u9593\u4ef6\uff08Broker\uff09\uff1a\u7ba1\u7406\u968a\u5217\u7684\u4f3a\u670d\u5668\u8edf\u4ef6\uff0c\u5982 RabbitMQ \u6216 Redis\uff0c\u8ca0\u8cac\u6d88\u606f\u7684\u5b58\u5132\u8207\u5206\u767c\u3002</li> </ul>"},{"location":"basics/message-queue-principles/#_4","title":"\u6d88\u606f\u968a\u5217\u7684\u5de5\u4f5c\u539f\u7406","text":"<ol> <li>\u751f\u7522\u8005\u5c07\u6d88\u606f\uff08\u901a\u5e38\u662f\u4efb\u52d9\u63cf\u8ff0\uff09\u767c\u9001\u5230\u6307\u5b9a\u7684\u968a\u5217\u3002</li> <li>\u6d88\u606f\u968a\u5217\u4e2d\u9593\u4ef6\u5b58\u5132\u6d88\u606f\uff0c\u7b49\u5f85\u6d88\u8cbb\u8005\u8655\u7406\u3002</li> <li>\u6d88\u8cbb\u8005\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u6d88\u606f\uff0c\u57f7\u884c\u4efb\u52d9\uff0c\u4e26\u53ef\u80fd\u8fd4\u56de\u7d50\u679c\u3002</li> <li>\u5b8c\u6210\u5f8c\uff0c\u6d88\u606f\u901a\u5e38\u6703\u88ab\u79fb\u9664\u6216\u6a19\u8a18\u70ba\u5df2\u8655\u7406\uff08\u53d6\u6c7a\u65bc\u968a\u5217\u914d\u7f6e\uff09\u3002</li> </ol>"},{"location":"basics/message-queue-principles/#_5","title":"\u6d88\u606f\u968a\u5217\u7684\u512a\u52e2","text":"<ul> <li>\u89e3\u8026\u5408\uff1a\u751f\u7522\u8005\u548c\u6d88\u8cbb\u8005\u7121\u9700\u76f4\u63a5\u901a\u4fe1\uff0c\u53ef\u4ee5\u7368\u7acb\u904b\u4f5c\u8207\u64f4\u5c55\u3002</li> <li>\u7de9\u885d\u4f5c\u7528\uff1a\u7576\u4efb\u52d9\u91cf\u6fc0\u589e\u6642\uff0c\u968a\u5217\u53ef\u66ab\u5b58\u6d88\u606f\uff0c\u907f\u514d\u7cfb\u7d71\u904e\u8f09\u3002</li> <li>\u53ef\u9760\u6027\uff1a\u652f\u6301\u6d88\u606f\u6301\u4e45\u5316\uff0c\u78ba\u4fdd\u4efb\u52d9\u5373\u4f7f\u5728\u7cfb\u7d71\u6545\u969c\u6642\u4e5f\u4e0d\u6703\u4e1f\u5931\u3002</li> <li>\u9748\u6d3b\u6027\uff1a\u652f\u6301\u591a\u6d88\u8cbb\u8005\u8655\u7406\u540c\u4e00\u968a\u5217\uff0c\u5be6\u73fe\u8ca0\u8f09\u5747\u8861\u3002</li> </ul>"},{"location":"basics/message-queue-principles/#_6","title":"\u5e38\u898b\u7684\u6d88\u606f\u968a\u5217\u7cfb\u7d71","text":"<ul> <li>RabbitMQ\uff1a\u57fa\u65bc AMQP \u5354\u8b70\uff0c\u652f\u6301\u8907\u96dc\u7684\u8def\u7531\u898f\u5247\uff08\u672c\u7b46\u8a18\u5f8c\u7e8c\u91cd\u9ede\uff09\u3002</li> <li>Redis\uff1a\u8f15\u91cf\u7d1a\u968a\u5217\uff0c\u9069\u5408\u7c21\u55ae\u4efb\u52d9\u8655\u7406\u3002</li> <li>Kafka\uff1a\u9ad8\u541e\u5410\u91cf\u7684\u5206\u4f48\u5f0f\u6d88\u606f\u7cfb\u7d71\uff0c\u5e38\u7528\u65bc\u65e5\u8a8c\u548c\u4e8b\u4ef6\u6d41\u8655\u7406\u3002</li> </ul>"},{"location":"basics/message-queue-principles/#_7","title":"\u5c0f\u7d50","text":"<p>\u6d88\u606f\u968a\u5217\u662f\u5be6\u73fe\u7570\u6b65\u4efb\u52d9\u8655\u7406\u7684\u91cd\u8981\u5de5\u5177\uff0c\u5b83\u901a\u904e\u89e3\u8026\u751f\u7522\u8005\u8207\u6d88\u8cbb\u8005\uff0c\u63d0\u5347\u4e86\u7cfb\u7d71\u7684\u9748\u6d3b\u6027\u8207\u53ef\u9760\u6027\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u300d\uff0c\u6df1\u5165\u63a2\u8a0e\u6d88\u606f\u968a\u5217\u4e2d\u7684\u89d2\u8272\u5206\u5de5\u3002</p> <p>\u63d0\u793a\uff1a\u7406\u89e3\u6d88\u606f\u968a\u5217\u7684\u57fa\u672c\u539f\u7406\u6709\u52a9\u65bc\u5f8c\u7e8c\u5b78\u7fd2 RabbitMQ \u7684\u914d\u7f6e\u8207\u4f7f\u7528\u3002</p>"},{"location":"basics/producer-consumer-model/","title":"\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b","text":"<p>\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u662f\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u4e2d\u7684\u7d93\u5178\u8a2d\u8a08\u6a21\u5f0f\uff0c\u7528\u65bc\u63cf\u8ff0\u6d88\u606f\u968a\u5217\u4e2d\u4efb\u52d9\u7684\u751f\u6210\u8207\u8655\u7406\u904e\u7a0b\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u8a72\u6a21\u578b\u7684\u57fa\u672c\u6982\u5ff5\u8207\u61c9\u7528\u3002</p>"},{"location":"basics/producer-consumer-model/#-_1","title":"\u4ec0\u9ebc\u662f\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\uff1f","text":"<p>\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u63cf\u8ff0\u4e86\u5169\u985e\u89d2\u8272\u4e4b\u9593\u7684\u5354\u4f5c\u95dc\u4fc2\uff1a - \u751f\u7522\u8005\uff08Producer\uff09\uff1a\u8ca0\u8cac\u751f\u6210\u4efb\u52d9\u6216\u6578\u64da\uff0c\u4e26\u5c07\u5176\u653e\u5165\u5171\u4eab\u7de9\u885d\u5340\uff08\u901a\u5e38\u662f\u6d88\u606f\u968a\u5217\uff09\u3002 - \u6d88\u8cbb\u8005\uff08Consumer\uff09\uff1a\u5f9e\u7de9\u885d\u5340\u4e2d\u53d6\u51fa\u4efb\u52d9\u6216\u6578\u64da\uff0c\u4e26\u9032\u884c\u8655\u7406\u3002</p> <p>\u8a72\u6a21\u578b\u7684\u6838\u5fc3\u601d\u60f3\u662f\u901a\u904e\u7de9\u885d\u5340\u89e3\u8026\u751f\u7522\u8207\u6d88\u8cbb\u7684\u904e\u7a0b\uff0c\u5141\u8a31\u96d9\u65b9\u4ee5\u4e0d\u540c\u901f\u5ea6\u904b\u4f5c\u3002</p>"},{"location":"basics/producer-consumer-model/#_1","title":"\u6a21\u578b\u7684\u5de5\u4f5c\u6d41\u7a0b","text":"<ol> <li>\u751f\u7522\u8005\u6839\u64da\u9700\u6c42\u751f\u6210\u4efb\u52d9\uff0c\u4f8b\u5982\u7528\u6236\u8acb\u6c42\u89f8\u767c\u6587\u4ef6\u8655\u7406\u3002</li> <li>\u751f\u7522\u8005\u5c07\u4efb\u52d9\u63cf\u8ff0\uff08\u6d88\u606f\uff09\u653e\u5165\u6d88\u606f\u968a\u5217\u4e2d\u3002</li> <li>\u6d88\u8cbb\u8005\u76e3\u807d\u968a\u5217\uff0c\u7576\u6709\u65b0\u6d88\u606f\u6642\u53d6\u51fa\u4e26\u57f7\u884c\u4efb\u52d9\u3002</li> <li>\u6d88\u8cbb\u8005\u5b8c\u6210\u4efb\u52d9\u5f8c\uff0c\u53ef\u80fd\u5c07\u7d50\u679c\u8fd4\u56de\u6216\u66f4\u65b0\u72c0\u614b\u3002</li> </ol>"},{"location":"basics/producer-consumer-model/#_2","title":"\u6a21\u578b\u4e2d\u7684\u6311\u6230\u8207\u89e3\u6c7a\u65b9\u6848","text":"<ul> <li>\u751f\u7522\u901f\u5ea6\u5feb\u65bc\u6d88\u8cbb\u901f\u5ea6\uff1a\u968a\u5217\u53ef\u80fd\u6eff\u8f09\uff0c\u9700\u8a2d\u7f6e\u968a\u5217\u5927\u5c0f\u9650\u5236\u6216\u589e\u52a0\u6d88\u8cbb\u8005\u3002</li> <li>\u6d88\u8cbb\u901f\u5ea6\u5feb\u65bc\u751f\u7522\u901f\u5ea6\uff1a\u6d88\u8cbb\u8005\u53ef\u80fd\u7a7a\u9592\uff0c\u9700\u8a2d\u8a08\u5408\u7406\u7684\u6d88\u8cbb\u8005\u6578\u91cf\u3002</li> <li>\u4efb\u52d9\u512a\u5148\u7d1a\uff1a\u67d0\u4e9b\u4efb\u52d9\u9700\u8981\u512a\u5148\u8655\u7406\uff0c\u53ef\u901a\u904e\u591a\u968a\u5217\u6216\u512a\u5148\u7d1a\u8a2d\u7f6e\u89e3\u6c7a\u3002</li> <li>\u4efb\u52d9\u5931\u6557\u8655\u7406\uff1a\u6d88\u8cbb\u8005\u57f7\u884c\u5931\u6557\u6642\uff0c\u9700\u652f\u6301\u91cd\u8a66\u6a5f\u5236\u6216\u932f\u8aa4\u65e5\u8a8c\u8a18\u9304\u3002</li> </ul>"},{"location":"basics/producer-consumer-model/#-_2","title":"\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u7684\u512a\u52e2","text":"<ul> <li>\u89e3\u8026\u5408\uff1a\u751f\u7522\u8005\u8207\u6d88\u8cbb\u8005\u7121\u9700\u76f4\u63a5\u4ea4\u4e92\uff0c\u53ef\u7368\u7acb\u958b\u767c\u8207\u90e8\u7f72\u3002</li> <li>\u8ca0\u8f09\u5747\u8861\uff1a\u591a\u500b\u6d88\u8cbb\u8005\u53ef\u4e26\u884c\u8655\u7406\u4efb\u52d9\uff0c\u5206\u64d4\u8ca0\u8f09\u3002</li> <li>\u9748\u6d3b\u6027\uff1a\u53ef\u52d5\u614b\u8abf\u6574\u751f\u7522\u8005\u8207\u6d88\u8cbb\u8005\u6578\u91cf\uff0c\u9069\u61c9\u4e0d\u540c\u8ca0\u8f09\u3002</li> </ul>"},{"location":"basics/producer-consumer-model/#_3","title":"\u5be6\u969b\u61c9\u7528\u793a\u4f8b","text":"<ul> <li>\u7db2\u9801\u61c9\u7528\uff1a\u7528\u6236\u63d0\u4ea4\u8868\u55ae\uff08\u751f\u7522\u8005\uff09\uff0c\u5f8c\u53f0\u5de5\u4f5c\u9032\u7a0b\u8655\u7406\u8868\u55ae\u6578\u64da\uff08\u6d88\u8cbb\u8005\uff09\u3002</li> <li>\u8996\u983b\u8655\u7406\uff1a\u7528\u6236\u4e0a\u50b3\u8996\u983b\uff08\u751f\u7522\u8005\uff09\uff0c\u4f3a\u670d\u5668\u8f49\u78bc\u8996\u983b\u683c\u5f0f\uff08\u6d88\u8cbb\u8005\uff09\u3002</li> <li>\u65e5\u8a8c\u7cfb\u7d71\uff1a\u61c9\u7528\u751f\u6210\u65e5\u8a8c\uff08\u751f\u7522\u8005\uff09\uff0c\u5206\u6790\u7cfb\u7d71\u8655\u7406\u65e5\u8a8c\u6578\u64da\uff08\u6d88\u8cbb\u8005\uff09\u3002</li> </ul>"},{"location":"basics/producer-consumer-model/#_4","title":"\u5c0f\u7d50","text":"<p>\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u662f\u6d88\u606f\u968a\u5217\u7684\u57fa\u790e\u8a2d\u8a08\u6a21\u5f0f\uff0c\u5b83\u901a\u904e\u7de9\u885d\u5340\u5be6\u73fe\u4e86\u4efb\u52d9\u751f\u6210\u8207\u8655\u7406\u7684\u89e3\u8026\uff0c\u70ba\u5206\u6563\u5f0f\u7cfb\u7d71\u63d0\u4f9b\u4e86\u9ad8\u6548\u7684\u5354\u4f5c\u65b9\u5f0f\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u4efb\u52d9\u5206\u767c\u8207\u57f7\u884c\u6d41\u7a0b\u300d\uff0c\u63a2\u7d22\u4efb\u52d9\u5982\u4f55\u5f9e\u751f\u7522\u8005\u5230\u6d88\u8cbb\u8005\u7684\u5b8c\u6574\u751f\u547d\u9031\u671f\u3002</p> <p>\u63d0\u793a\uff1a\u7406\u89e3\u751f\u7522\u8005-\u6d88\u8cbb\u8005\u6a21\u578b\u6709\u52a9\u65bc\u5f8c\u7e8c\u5b78\u7fd2 Celery \u4e2d\u7684\u4efb\u52d9\u5b9a\u7fa9\u8207\u57f7\u884c\u6a5f\u5236\u3002</p>"},{"location":"basics/task-distribution-flow/","title":"\u4efb\u52d9\u5206\u767c\u8207\u57f7\u884c\u6d41\u7a0b","text":"<p>\u5728\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u4e2d\uff0c\u4efb\u52d9\u5f9e\u5275\u5efa\u5230\u5b8c\u6210\u9700\u8981\u7d93\u6b77\u591a\u500b\u968e\u6bb5\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u4efb\u52d9\u5206\u767c\u8207\u57f7\u884c\u7684\u5b8c\u6574\u6d41\u7a0b\uff0c\u5e6b\u52a9\u60a8\u7406\u89e3\u5206\u6563\u5f0f\u7cfb\u7d71\u4e2d\u5404\u7d44\u4ef6\u5982\u4f55\u5354\u4f5c\u3002</p>"},{"location":"basics/task-distribution-flow/#_2","title":"\u4efb\u52d9\u751f\u547d\u9031\u671f\u7684\u968e\u6bb5","text":"<ol> <li>\u4efb\u52d9\u5275\u5efa\uff1a</li> <li>\u4efb\u52d9\u901a\u5e38\u7531\u61c9\u7528\u7a0b\u5e8f\u89f8\u767c\uff0c\u4f8b\u5982\u7528\u6236\u8acb\u6c42\u6216\u5b9a\u6642\u4e8b\u4ef6\u3002</li> <li> <p>\u751f\u7522\u8005\u5c07\u4efb\u52d9\u63cf\u8ff0\uff08\u5305\u62ec\u4efb\u52d9\u985e\u578b\u3001\u53c3\u6578\u7b49\uff09\u5c01\u88dd\u6210\u6d88\u606f\u3002</p> </li> <li> <p>\u4efb\u52d9\u5206\u767c\uff1a</p> </li> <li>\u6d88\u606f\u88ab\u767c\u9001\u5230\u6d88\u606f\u968a\u5217\u4e2d\u9593\u4ef6\uff08\u5982 RabbitMQ\uff09\u3002</li> <li> <p>\u4e2d\u9593\u4ef6\u6839\u64da\u8def\u7531\u898f\u5247\uff08\u4f8b\u5982\u968a\u5217\u540d\u7a31\u6216\u512a\u5148\u7d1a\uff09\u5c07\u4efb\u52d9\u5206\u914d\u5230\u5408\u9069\u7684\u968a\u5217\u3002</p> </li> <li> <p>\u4efb\u52d9\u7b49\u5f85\uff1a</p> </li> <li>\u4efb\u52d9\u5728\u968a\u5217\u4e2d\u7b49\u5f85\uff0c\u76f4\u5230\u6709\u53ef\u7528\u7684\u6d88\u8cbb\u8005\u8655\u7406\u3002</li> <li> <p>\u968a\u5217\u53ef\u80fd\u652f\u6301\u6301\u4e45\u5316\uff0c\u78ba\u4fdd\u4efb\u52d9\u5728\u7cfb\u7d71\u6545\u969c\u6642\u4e0d\u4e1f\u5931\u3002</p> </li> <li> <p>\u4efb\u52d9\u57f7\u884c\uff1a</p> </li> <li>\u6d88\u8cbb\u8005\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u4efb\u52d9\uff0c\u6839\u64da\u4efb\u52d9\u63cf\u8ff0\u57f7\u884c\u76f8\u61c9\u64cd\u4f5c\u3002</li> <li> <p>\u57f7\u884c\u904e\u7a0b\u53ef\u80fd\u5305\u62ec\u6578\u64da\u8655\u7406\u3001\u6587\u4ef6\u64cd\u4f5c\u6216\u5916\u90e8 API \u8abf\u7528\u3002</p> </li> <li> <p>\u7d50\u679c\u8655\u7406\uff1a</p> </li> <li>\u4efb\u52d9\u5b8c\u6210\u5f8c\uff0c\u6d88\u8cbb\u8005\u53ef\u80fd\u5c07\u7d50\u679c\u5b58\u5132\u5230\u7d50\u679c\u5f8c\u7aef\uff08\u5982\u8cc7\u6599\u5eab\u6216 Redis\uff09\u3002</li> <li> <p>\u7d50\u679c\u53ef\u901a\u77e5\u751f\u7522\u8005\u6216\u66f4\u65b0\u61c9\u7528\u72c0\u614b\uff0c\u4f8b\u5982\u901a\u904e\u56de\u8abf\u6216\u72c0\u614b\u66f4\u65b0\u3002</p> </li> <li> <p>\u932f\u8aa4\u8655\u7406\uff1a</p> </li> <li>\u5982\u679c\u4efb\u52d9\u57f7\u884c\u5931\u6557\uff0c\u7cfb\u7d71\u53ef\u80fd\u89f8\u767c\u91cd\u8a66\u6a5f\u5236\u6216\u8a18\u9304\u932f\u8aa4\u65e5\u8a8c\u3002</li> <li>\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u4efb\u52d9\u6703\u88ab\u79fb\u52d5\u5230\u300c\u6b7b\u4fe1\u968a\u5217\u300d\uff08Dead Letter Queue\uff09\u7b49\u5f85\u4eba\u5de5\u8655\u7406\u3002</li> </ol>"},{"location":"basics/task-distribution-flow/#_3","title":"\u4efb\u52d9\u5206\u767c\u7684\u95dc\u9375\u6a5f\u5236","text":"<ul> <li>\u8def\u7531\u898f\u5247\uff1a\u6c7a\u5b9a\u4efb\u52d9\u767c\u9001\u5230\u54ea\u500b\u968a\u5217\uff0c\u57fa\u65bc\u4efb\u52d9\u985e\u578b\u6216\u512a\u5148\u7d1a\u3002</li> <li>\u8ca0\u8f09\u5747\u8861\uff1a\u591a\u500b\u6d88\u8cbb\u8005\u5171\u4eab\u968a\u5217\u4e2d\u7684\u4efb\u52d9\uff0c\u907f\u514d\u55ae\u9ede\u904e\u8f09\u3002</li> <li>\u512a\u5148\u7d1a\u7ba1\u7406\uff1a\u91cd\u8981\u4efb\u52d9\u512a\u5148\u8655\u7406\uff0c\u78ba\u4fdd\u7cfb\u7d71\u97ff\u61c9\u95dc\u9375\u9700\u6c42\u3002</li> </ul>"},{"location":"basics/task-distribution-flow/#_4","title":"\u4efb\u52d9\u57f7\u884c\u6d41\u7a0b\u7684\u6311\u6230","text":"<ul> <li>\u4efb\u52d9\u4f9d\u8cf4\uff1a\u67d0\u4e9b\u4efb\u52d9\u9700\u8981\u7b49\u5f85\u5176\u4ed6\u4efb\u52d9\u5b8c\u6210\uff0c\u9700\u8a2d\u8a08\u5de5\u4f5c\u6d41\u3002</li> <li>\u57f7\u884c\u6642\u9593\uff1a\u9577\u6642\u9593\u4efb\u52d9\u53ef\u80fd\u5c0e\u81f4\u968a\u5217\u963b\u585e\uff0c\u9700\u8a2d\u7f6e\u8d85\u6642\u6a5f\u5236\u3002</li> <li>\u8cc7\u6e90\u7af6\u722d\uff1a\u591a\u6d88\u8cbb\u8005\u53ef\u80fd\u7af6\u722d\u8cc7\u6e90\uff0c\u9700\u5408\u7406\u914d\u7f6e\u4e26\u767c\u63a7\u5236\u3002</li> </ul>"},{"location":"basics/task-distribution-flow/#_5","title":"\u5be6\u969b\u6848\u4f8b\uff1a\u96fb\u5b50\u90f5\u4ef6\u767c\u9001\u6d41\u7a0b","text":"<ol> <li>\u7528\u6236\u8a3b\u518a\u6210\u529f\uff0c\u61c9\u7528\u5275\u5efa\u300c\u767c\u9001\u78ba\u8a8d\u90f5\u4ef6\u300d\u4efb\u52d9\u3002</li> <li>\u4efb\u52d9\u88ab\u767c\u9001\u5230\u6d88\u606f\u968a\u5217\u7684\u300cemail_queue\u300d\u3002</li> <li>\u6d88\u8cbb\u8005\uff08\u90f5\u4ef6\u767c\u9001\u670d\u52d9\uff09\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u4efb\u52d9\uff0c\u8abf\u7528\u90f5\u4ef6 API \u767c\u9001\u3002</li> <li>\u767c\u9001\u6210\u529f\u5f8c\uff0c\u7d50\u679c\u8a18\u9304\u5230\u65e5\u8a8c\uff0c\u6216\u66f4\u65b0\u7528\u6236\u72c0\u614b\u70ba\u300c\u5df2\u9a57\u8b49\u300d\u3002</li> </ol>"},{"location":"basics/task-distribution-flow/#_6","title":"\u5c0f\u7d50","text":"<p>\u4efb\u52d9\u5206\u767c\u8207\u57f7\u884c\u6d41\u7a0b\u662f\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u6838\u5fc3\uff0c\u6db5\u84cb\u4e86\u4efb\u52d9\u5f9e\u5275\u5efa\u5230\u5b8c\u6210\u7684\u5404\u500b\u968e\u6bb5\u3002\u7406\u89e3\u9019\u4e00\u6d41\u7a0b\u6709\u52a9\u65bc\u8a2d\u8a08\u9ad8\u6548\u7684\u7570\u6b65\u8655\u7406\u7cfb\u7d71\uff0c\u4e26\u70ba\u5f8c\u7e8c\u5b78\u7fd2 Celery \u548c RabbitMQ \u5960\u5b9a\u57fa\u790e\u3002</p> <p>\u63d0\u793a\uff1a\u5728\u5f8c\u7e8c\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ee5 Celery \u70ba\u4f8b\uff0c\u5c55\u793a\u5982\u4f55\u5be6\u73fe\u4efb\u52d9\u5206\u767c\u8207\u72c0\u614b\u8ffd\u8e64\u3002</p>"},{"location":"celery/","title":"Celery \u57fa\u790e","text":"<p>\u6b61\u8fce\u4f86\u5230\u300cCelery \u57fa\u790e\u300d\u7ae0\u7bc0\uff01Celery \u662f\u4e00\u500b\u5f37\u5927\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u968a\u5217\u6846\u67b6\uff0c\u5ee3\u6cdb\u7528\u65bc Python \u61c9\u7528\u4e2d\uff0c\u7279\u5225\u9069\u5408\u8655\u7406\u7570\u6b65\u4efb\u52d9\u8207\u5f8c\u53f0\u4f5c\u696d\u3002\u672c\u7ae0\u7bc0\u5c07\u7cfb\u7d71\u4ecb\u7d39 Celery \u7684\u57fa\u672c\u6982\u5ff5\u3001\u5de5\u4f5c\u539f\u7406\u8207\u914d\u7f6e\u65b9\u6cd5\uff0c\u5e6b\u52a9\u60a8\u5feb\u901f\u4e0a\u624b\u9019\u4e00\u5de5\u5177\uff0c\u4e26\u57fa\u65bc\u4e4b\u524d\u5b78\u7fd2\u7684 RabbitMQ \u69cb\u5efa\u9ad8\u6548\u7684\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\u3002</p>"},{"location":"celery/#celery_1","title":"\u4ec0\u9ebc\u662f Celery\uff1f","text":"<p>Celery \u662f\u4e00\u500b\u958b\u6e90\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u968a\u5217\u6846\u67b6\uff0c\u7528\u65bc\u8655\u7406\u7570\u6b65\u4efb\u52d9\u548c\u5b9a\u6642\u4efb\u52d9\u3002\u5b83\u5141\u8a31\u60a8\u5c07\u8017\u6642\u64cd\u4f5c\u5f9e\u4e3b\u61c9\u7528\u4e2d\u5206\u96e2\u51fa\u4f86\uff0c\u4ea4\u7531\u5f8c\u53f0\u5de5\u4f5c\u8005\uff08Worker\uff09\u8655\u7406\uff0c\u5f9e\u800c\u63d0\u5347\u61c9\u7528\u97ff\u61c9\u901f\u5ea6\u8207\u53ef\u64f4\u5c55\u6027\u3002</p> <ul> <li>\u89d2\u8272\uff1a\u4efb\u52d9\u8abf\u5ea6\u8207\u57f7\u884c\u6846\u67b6\uff0c\u8ca0\u8cac\u4efb\u52d9\u7684\u5206\u767c\u8207\u7d50\u679c\u7ba1\u7406\u3002</li> <li>\u6838\u5fc3\u529f\u80fd\uff1a\u652f\u63f4\u7570\u6b65\u4efb\u52d9\u3001\u5b9a\u6642\u4efb\u52d9\u3001\u4efb\u52d9\u91cd\u8a66\u8207\u72c0\u614b\u8ffd\u8e64\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u5f8c\u53f0\u6578\u64da\u8655\u7406\u3001\u90f5\u4ef6\u767c\u9001\u3001\u5716\u7247\u8655\u7406\u3001\u5b9a\u6642\u5831\u8868\u751f\u6210\u3002</li> </ul>"},{"location":"celery/#celery_2","title":"Celery \u7684\u5de5\u4f5c\u539f\u7406","text":"<p>Celery \u4f9d\u8cf4\u6d88\u606f\u4e2d\u9593\u4ef6\uff08\u5982 RabbitMQ \u6216 Redis\uff09\u4f5c\u70ba\u4efb\u52d9\u968a\u5217\uff0c\u901a\u904e\u4ee5\u4e0b\u7d44\u4ef6\u5354\u540c\u5de5\u4f5c\uff1a - \u4efb\u52d9\u751f\u7522\u8005\uff08Producer\uff09\uff1a\u61c9\u7528\u7a0b\u5f0f\u767c\u9001\u4efb\u52d9\u5230\u968a\u5217\u3002 - \u6d88\u606f\u4ee3\u7406\uff08Broker\uff09\uff1a\u5982 RabbitMQ\uff0c\u8ca0\u8cac\u5b58\u5132\u8207\u5206\u767c\u4efb\u52d9\u3002 - \u5de5\u4f5c\u8005\uff08Worker\uff09\uff1a\u5f8c\u53f0\u9032\u7a0b\uff0c\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u4efb\u52d9\u4e26\u57f7\u884c\u3002 - \u7d50\u679c\u5f8c\u7aef\uff08Result Backend\uff09\uff1a\u5b58\u5132\u4efb\u52d9\u57f7\u884c\u7d50\u679c\uff0c\u4f9b\u67e5\u8a62\u3002</p>"},{"location":"celery/#_1","title":"\u672c\u7ae0\u7bc0\u5167\u5bb9\u6982\u8ff0","text":"<p>\u5728\u672c\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4ee5\u4e0b\u6838\u5fc3\u4e3b\u984c\uff1a - Celery \u67b6\u69cb\uff1a\u4e86\u89e3 Celery \u7684\u7d44\u4ef6\u8207\u5de5\u4f5c\u6d41\u7a0b\u3002 - \u4efb\u52d9\u5b9a\u7fa9\u8207\u57f7\u884c\uff1a\u5b78\u7fd2\u5982\u4f55\u5b9a\u7fa9\u4efb\u52d9\u4e26\u5728\u5f8c\u53f0\u57f7\u884c\u3002 - \u7d50\u679c\u5f8c\u7aef\uff08Result Backend\uff09\uff1a\u914d\u7f6e\u8207\u4f7f\u7528\u7d50\u679c\u5b58\u5132\u6a5f\u5236\u3002 - \u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\uff1a\u76e3\u63a7\u4efb\u52d9\u57f7\u884c\u72c0\u614b\u8207\u7d50\u679c\u3002 - \u932f\u8aa4\u8655\u7406\u8207\u91cd\u8a66\u6a5f\u5236\uff1a\u8655\u7406\u4efb\u52d9\u5931\u6557\u8207\u81ea\u52d5\u91cd\u8a66\u7b56\u7565\u3002</p>"},{"location":"celery/#_2","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5b8c\u6210\u672c\u7ae0\u7bc0\u5f8c\uff0c\u60a8\u5c07\u80fd\u5920\uff1a - \u7406\u89e3 Celery \u5728\u5206\u6563\u5f0f\u7cfb\u7d71\u4e2d\u7684\u4f5c\u7528\u8207\u5de5\u4f5c\u539f\u7406\u3002 - \u6210\u529f\u914d\u7f6e\u4e26\u904b\u884c Celery \u74b0\u5883\u3002 - \u5b9a\u7fa9\u8207\u57f7\u884c\u7570\u6b65\u4efb\u52d9\uff0c\u8655\u7406\u5e38\u898b\u61c9\u7528\u5834\u666f\u3002 - \u638c\u63e1\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\u8207\u932f\u8aa4\u8655\u7406\u65b9\u6cd5\u3002</p> <p>\u8b93\u6211\u5011\u5f9e\u300cCelery \u67b6\u69cb\u300d\u958b\u59cb\uff0c\u9010\u6b65\u63a2\u7d22 Celery \u7684\u6838\u5fc3\u529f\u80fd\uff01</p> <p>\u63d0\u793a\uff1a\u672c\u7ae0\u7bc0\u5047\u8a2d\u60a8\u5df2\u719f\u6089 RabbitMQ \u57fa\u672c\u6982\u5ff5\uff0c\u82e5\u9700\u8907\u7fd2\uff0c\u8acb\u53c3\u8003\u524d\u4e00\u7ae0\u7bc0\u300cRabbitMQ \u6838\u5fc3\u300d\u3002</p>"},{"location":"celery/architecture/","title":"Celery \u67b6\u69cb","text":"<p>Celery \u662f\u4e00\u500b\u5206\u6563\u5f0f\u4efb\u52d9\u968a\u5217\u6846\u67b6\uff0c\u5176\u67b6\u69cb\u8a2d\u8a08\u652f\u63f4\u9ad8\u6548\u7684\u4efb\u52d9\u5206\u767c\u8207\u57f7\u884c\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Celery \u7684\u6838\u5fc3\u7d44\u4ef6\u8207\u5de5\u4f5c\u6d41\u7a0b\uff0c\u5e6b\u52a9\u60a8\u7406\u89e3\u5176\u904b\u4f5c\u539f\u7406\u3002</p>"},{"location":"celery/architecture/#celery_1","title":"Celery \u7684\u6838\u5fc3\u7d44\u4ef6","text":"<p>Celery \u7531\u4ee5\u4e0b\u4e3b\u8981\u7d44\u4ef6\u69cb\u6210\uff0c\u5171\u540c\u5b8c\u6210\u4efb\u52d9\u7684\u8abf\u5ea6\u8207\u57f7\u884c\uff1a</p> <ul> <li>\u4efb\u52d9\uff08Task\uff09\uff1a\u5b9a\u7fa9\u9700\u8981\u7570\u6b65\u57f7\u884c\u7684\u51fd\u6578\u6216\u64cd\u4f5c\uff0c\u662f Celery \u7684\u57fa\u672c\u5de5\u4f5c\u55ae\u4f4d\u3002</li> <li>\u751f\u7522\u8005\uff08Producer\uff09\uff1a\u61c9\u7528\u7a0b\u5f0f\u6216\u9032\u7a0b\uff0c\u8ca0\u8cac\u5c07\u4efb\u52d9\u767c\u9001\u5230\u6d88\u606f\u968a\u5217\u3002</li> <li>\u6d88\u606f\u4ee3\u7406\uff08Broker\uff09\uff1a\u4e2d\u9593\u4ef6\uff08\u5982 RabbitMQ \u6216 Redis\uff09\uff0c\u8ca0\u8cac\u5b58\u5132\u8207\u5206\u767c\u4efb\u52d9\u6d88\u606f\u3002</li> <li>\u5de5\u4f5c\u8005\uff08Worker\uff09\uff1a\u5f8c\u53f0\u9032\u7a0b\uff0c\u5f9e\u6d88\u606f\u968a\u5217\u4e2d\u53d6\u51fa\u4efb\u52d9\u4e26\u57f7\u884c\uff0c\u53ef\u904b\u884c\u5728\u591a\u53f0\u6a5f\u5668\u4e0a\u4ee5\u5be6\u73fe\u5206\u6563\u5f0f\u8655\u7406\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff08Result Backend\uff09\uff1a\u7528\u65bc\u5b58\u5132\u4efb\u52d9\u57f7\u884c\u7d50\u679c\u7684\u8cc7\u6599\u5eab\uff08\u5982 Redis\u3001MongoDB\uff09\uff0c\u652f\u63f4\u7d50\u679c\u67e5\u8a62\u8207\u72c0\u614b\u8ffd\u8e64\u3002</li> </ul>"},{"location":"celery/architecture/#celery_2","title":"Celery \u5de5\u4f5c\u6d41\u7a0b","text":"<ol> <li>\u4efb\u52d9\u5b9a\u7fa9\uff1a\u958b\u767c\u8005\u4f7f\u7528 Celery \u63d0\u4f9b\u7684\u88dd\u98fe\u5668\uff08\u5982 <code>@app.task</code>\uff09\u5b9a\u7fa9\u7570\u6b65\u4efb\u52d9\u3002</li> <li>\u4efb\u52d9\u767c\u9001\uff1a\u61c9\u7528\u7a0b\u5f0f\u8abf\u7528\u4efb\u52d9\u51fd\u6578\uff08\u5982 <code>task.delay()</code>\uff09\uff0c\u5c07\u4efb\u52d9\u6d88\u606f\u767c\u9001\u5230\u6d88\u606f\u4ee3\u7406\u3002</li> <li>\u4efb\u52d9\u5206\u767c\uff1a\u6d88\u606f\u4ee3\u7406\uff08\u5982 RabbitMQ\uff09\u6839\u64da\u968a\u5217\u898f\u5247\u5c07\u4efb\u52d9\u5206\u767c\u7d66\u7a7a\u9592\u7684\u5de5\u4f5c\u8005\u3002</li> <li>\u4efb\u52d9\u57f7\u884c\uff1a\u5de5\u4f5c\u8005\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u4efb\u52d9\uff0c\u57f7\u884c\u4efb\u52d9\u51fd\u6578\uff0c\u4e26\u5c07\u7d50\u679c\uff08\u82e5\u6709\uff09\u5b58\u5165\u7d50\u679c\u5f8c\u7aef\u3002</li> <li>\u7d50\u679c\u67e5\u8a62\uff1a\u61c9\u7528\u7a0b\u5f0f\u53ef\u901a\u904e\u4efb\u52d9 ID \u67e5\u8a62\u57f7\u884c\u72c0\u614b\u8207\u7d50\u679c\u3002</li> </ol>"},{"location":"celery/architecture/#_1","title":"\u67b6\u69cb\u5716\u89e3","text":"<p>\u4ee5\u4e0b\u662f Celery \u67b6\u69cb\u7684\u7c21\u5316\u6d41\u7a0b\u5716\uff1a <pre><code>\u61c9\u7528\u7a0b\u5f0f(Producer) --&gt; \u6d88\u606f\u4ee3\u7406(Broker) --&gt; \u5de5\u4f5c\u8005(Worker) --&gt; \u7d50\u679c\u5f8c\u7aef(Result Backend)\n                      &lt;-- \u67e5\u8a62\u7d50\u679c &lt;--\n</code></pre></p> <ul> <li>\u61c9\u7528\u7a0b\u5f0f\uff1a\u767c\u9001\u4efb\u52d9\u8207\u67e5\u8a62\u7d50\u679c\u3002</li> <li>\u6d88\u606f\u4ee3\u7406\uff1a\u5982 RabbitMQ\uff0c\u8ca0\u8cac\u4efb\u52d9\u968a\u5217\u7ba1\u7406\u3002</li> <li>\u5de5\u4f5c\u8005\uff1a\u53ef\u591a\u500b\u5be6\u4f8b\uff0c\u5206\u6563\u5f0f\u57f7\u884c\u4efb\u52d9\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1a\u5982 Redis\uff0c\u5b58\u5132\u4efb\u52d9\u7d50\u679c\u3002</li> </ul>"},{"location":"celery/architecture/#celery_3","title":"Celery \u7684\u512a\u52e2","text":"<ul> <li>\u5206\u6563\u5f0f\u8655\u7406\uff1a\u652f\u63f4\u591a\u5de5\u4f5c\u8005\u904b\u884c\u5728\u4e0d\u540c\u6a5f\u5668\uff0c\u63d0\u5347\u8655\u7406\u80fd\u529b\u3002</li> <li>\u9748\u6d3b\u6027\uff1a\u652f\u63f4\u591a\u7a2e\u6d88\u606f\u4ee3\u7406\u8207\u7d50\u679c\u5f8c\u7aef\uff0c\u9069\u61c9\u4e0d\u540c\u74b0\u5883\u3002</li> <li>\u53ef\u64f4\u5c55\u6027\uff1a\u901a\u904e\u589e\u52a0\u5de5\u4f5c\u8005\u6578\u91cf\u8f15\u9b06\u61c9\u5c0d\u4efb\u52d9\u589e\u9577\u3002</li> <li>\u53ef\u9760\u6027\uff1a\u7d50\u5408\u6d88\u606f\u6301\u4e45\u5316\u8207\u91cd\u8a66\u6a5f\u5236\uff0c\u78ba\u4fdd\u4efb\u52d9\u4e0d\u4e1f\u5931\u3002</li> </ul>"},{"location":"celery/architecture/#_2","title":"\u5c0f\u7d50","text":"<p>Celery \u7684\u67b6\u69cb\u8a2d\u8a08\u4f7f\u5176\u6210\u70ba\u8655\u7406\u7570\u6b65\u4efb\u52d9\u7684\u7406\u60f3\u5de5\u5177\uff0c\u901a\u904e\u660e\u78ba\u7684\u7d44\u4ef6\u5206\u5de5\u5be6\u73fe\u9ad8\u6548\u7684\u4efb\u52d9\u8abf\u5ea6\u8207\u57f7\u884c\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u4efb\u52d9\u5b9a\u7fa9\u8207\u57f7\u884c\u300d\uff0c\u5b78\u7fd2\u5982\u4f55\u5728\u5be6\u969b\u61c9\u7528\u4e2d\u5275\u5efa\u8207\u904b\u884c Celery \u4efb\u52d9\u3002</p> <p>\u63d0\u793a\uff1a\u7406\u89e3 Celery \u7684\u5404\u7d44\u4ef6\u89d2\u8272\u6709\u52a9\u65bc\u8a2d\u8a08\u5408\u7406\u7684\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\uff0c\u7279\u5225\u662f\u9078\u64c7\u5408\u9069\u7684\u6d88\u606f\u4ee3\u7406\u8207\u7d50\u679c\u5f8c\u7aef\u3002</p>"},{"location":"celery/error-handling-retry/","title":"\u932f\u8aa4\u8655\u7406\u8207\u91cd\u8a66\u6a5f\u5236","text":"<p>\u5728\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u4e2d\uff0c\u4efb\u52d9\u53ef\u80fd\u56e0\u5404\u7a2e\u539f\u56e0\u5931\u6557\uff08\u5982\u7db2\u7d61\u554f\u984c\u3001\u8cc7\u6e90\u4e0d\u53ef\u7528\uff09\u3002Celery \u63d0\u4f9b\u932f\u8aa4\u8655\u7406\u8207\u91cd\u8a66\u6a5f\u5236\uff0c\u5e6b\u52a9\u60a8\u61c9\u5c0d\u5931\u6557\u4e26\u63d0\u9ad8\u7cfb\u7d71\u53ef\u9760\u6027\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u76f8\u95dc\u529f\u80fd\u8207\u914d\u7f6e\u65b9\u6cd5\u3002</p>"},{"location":"celery/error-handling-retry/#_2","title":"\u932f\u8aa4\u8655\u7406\u57fa\u790e","text":"<p>\u7576 Celery \u4efb\u52d9\u57f7\u884c\u904e\u7a0b\u4e2d\u767c\u751f\u7570\u5e38\uff0c\u4efb\u52d9\u72c0\u614b\u6703\u6a19\u8a18\u70ba <code>FAILURE</code>\uff0c\u932f\u8aa4\u8cc7\u8a0a\u6703\u5b58\u5132\u5728\u7d50\u679c\u5f8c\u7aef\u4e2d\uff08\u82e5\u5df2\u914d\u7f6e\uff09\u3002\u60a8\u53ef\u4ee5\u901a\u904e <code>AsyncResult</code> \u7269\u4ef6\u7372\u53d6\u932f\u8aa4\u8a73\u60c5\u3002</p>"},{"location":"celery/error-handling-retry/#_3","title":"\u793a\u4f8b\uff1a\u6355\u7372\u4efb\u52d9\u932f\u8aa4","text":"<pre><code>from celery.result import AsyncResult\nfrom app import some_task  # \u5047\u8a2d some_task \u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u767c\u9001\u4efb\u52d9\nresult = some_task.delay()\n\n# \u6aa2\u67e5\u7d50\u679c\nif result.ready():\n    if result.successful():\n        print(\"Task completed successfully:\", result.get())\n    else:\n        print(\"Task failed:\", result.get(propagate=False))  # \u4e0d\u62cb\u51fa\u7570\u5e38\nelse:\n    print(\"Task is still running...\")\n</code></pre>"},{"location":"celery/error-handling-retry/#_4","title":"\u5728\u4efb\u52d9\u4e2d\u8655\u7406\u7570\u5e38","text":"<p>\u5efa\u8b70\u5728\u4efb\u52d9\u5167\u90e8\u4f7f\u7528 <code>try-except</code> \u6355\u7372\u7570\u5e38\uff0c\u4e26\u8a18\u9304\u932f\u8aa4\u6216\u57f7\u884c\u6e05\u7406\u64cd\u4f5c\uff1a <pre><code>@app.task\ndef risky_task(data):\n    try:\n        # \u6a21\u64ec\u53ef\u80fd\u5931\u6557\u7684\u64cd\u4f5c\n        result = 1 / 0  # \u6545\u610f\u5f15\u767c\u7570\u5e38\n        return result\n    except Exception as e:\n        print(f\"Error occurred: {e}\")\n        raise  # \u91cd\u65b0\u62cb\u51fa\u7570\u5e38\uff0c\u4efb\u52d9\u72c0\u614b\u8a2d\u70ba FAILURE\n</code></pre></p>"},{"location":"celery/error-handling-retry/#_5","title":"\u4efb\u52d9\u91cd\u8a66\u6a5f\u5236","text":"<p>Celery \u652f\u63f4\u81ea\u52d5\u91cd\u8a66\u5931\u6557\u4efb\u52d9\uff0c\u60a8\u53ef\u4ee5\u5728\u4efb\u52d9\u88dd\u98fe\u5668\u4e2d\u8a2d\u7f6e\u91cd\u8a66\u53c3\u6578\uff0c\u6216\u5728\u7570\u5e38\u6642\u624b\u52d5\u89f8\u767c\u91cd\u8a66\u3002</p>"},{"location":"celery/error-handling-retry/#_6","title":"\u81ea\u52d5\u91cd\u8a66\u914d\u7f6e","text":"<p>\u5728\u4efb\u52d9\u5b9a\u7fa9\u6642\uff0c\u8a2d\u7f6e <code>retry</code> \u53c3\u6578\u4ee5\u555f\u7528\u81ea\u52d5\u91cd\u8a66\uff1a <pre><code>@app.task(\n    retry_backoff=True,  # \u4f7f\u7528\u6307\u6578\u9000\u907f\u7b56\u7565\n    retry_backoff_max=700,  # \u6700\u5927\u91cd\u8a66\u9593\u9694\uff08\u79d2\uff09\n    retry_jitter=True,  # \u6dfb\u52a0\u96a8\u6a5f\u6296\u52d5\uff0c\u907f\u514d\u91cd\u8a66\u885d\u7a81\n    max_retries=3  # \u6700\u5927\u91cd\u8a66\u6b21\u6578\n)\ndef fetch_data(url):\n    import requests\n    response = requests.get(url)\n    if response.status_code != 200:\n        raise Exception(f\"Failed to fetch {url}, status: {response.status_code}\")\n    return response.json()\n</code></pre></p> <ul> <li>retry_backoff\uff1a\u555f\u7528\u6307\u6578\u9000\u907f\uff0c\u91cd\u8a66\u9593\u9694\u9010\u6f38\u589e\u52a0\u3002</li> <li>retry_backoff_max\uff1a\u8a2d\u7f6e\u6700\u5927\u91cd\u8a66\u9593\u9694\uff0c\u907f\u514d\u7121\u9650\u5ef6\u9577\u3002</li> <li>retry_jitter\uff1a\u6dfb\u52a0\u96a8\u6a5f\u6296\u52d5\uff0c\u9632\u6b62\u591a\u500b\u4efb\u52d9\u540c\u6642\u91cd\u8a66\u3002</li> <li>max_retries\uff1a\u9650\u5236\u6700\u5927\u91cd\u8a66\u6b21\u6578\uff0c\u907f\u514d\u7121\u9650\u91cd\u8a66\u3002</li> </ul>"},{"location":"celery/error-handling-retry/#_7","title":"\u624b\u52d5\u89f8\u767c\u91cd\u8a66","text":"<p>\u5728\u4efb\u52d9\u5167\u90e8\u6355\u7372\u7570\u5e38\u4e26\u4f7f\u7528 <code>self.retry()</code> \u65b9\u6cd5\u624b\u52d5\u89f8\u767c\u91cd\u8a66\uff1a <pre><code>@app.task(bind=True)\ndef process_data(self, data):\n    try:\n        # \u6a21\u64ec\u53ef\u80fd\u5931\u6557\u7684\u64cd\u4f5c\n        if some_condition_fails(data):\n            raise Exception(\"Processing failed\")\n    except Exception as e:\n        # \u8a18\u9304\u932f\u8aa4\n        print(f\"Error: {e}\")\n        # \u624b\u52d5\u91cd\u8a66\uff0c\u6700\u591a3\u6b21\n        raise self.retry(exc=e, countdown=5, max_retries=3)\n</code></pre></p> <ul> <li>bind=True\uff1a\u5c07\u4efb\u52d9\u5be6\u4f8b\u4f5c\u70ba\u7b2c\u4e00\u500b\u53c3\u6578\u50b3\u5165\uff0c\u4ee5\u4fbf\u8abf\u7528 <code>self.retry()</code>\u3002</li> <li>countdown\uff1a\u8a2d\u7f6e\u91cd\u8a66\u524d\u7684\u7b49\u5f85\u6642\u9593\uff08\u79d2\uff09\u3002</li> <li>exc\uff1a\u50b3\u905e\u539f\u59cb\u7570\u5e38\uff0c\u4f9b\u5f8c\u7e8c\u5206\u6790\u3002</li> </ul>"},{"location":"celery/error-handling-retry/#_8","title":"\u932f\u8aa4\u8655\u7406\u7b56\u7565","text":"<ul> <li>\u5ffd\u7565\u932f\u8aa4\uff1a\u82e5\u4efb\u52d9\u5931\u6557\u4e0d\u5f71\u97ff\u6574\u9ad4\u6d41\u7a0b\uff0c\u53ef\u8a2d\u7f6e <code>ignore_result=True</code> \u5ffd\u7565\u7d50\u679c\u3002   <pre><code>@app.task(ignore_result=True)\ndef non_critical_task():\n    # \u5373\u4f7f\u5931\u6557\u4e5f\u4e0d\u5f71\u97ff\u4e3b\u6d41\u7a0b\n    pass\n</code></pre></li> <li>\u81ea\u5b9a\u7fa9\u932f\u8aa4\u8655\u7406\uff1a\u70ba\u7279\u5b9a\u7570\u5e38\u8a2d\u7f6e\u4e0d\u540c\u7684\u91cd\u8a66\u7b56\u7565\u3002   <pre><code>@app.task(bind=True, retry_backoff=True, max_retries=3)\ndef custom_retry_task(self):\n    try:\n        risky_operation()\n    except NetworkError as e:\n        raise self.retry(exc=e, countdown=10)  # \u7db2\u7d61\u932f\u8aa4\u91cd\u8a66\n    except ValueError:\n        return None  # \u503c\u932f\u8aa4\u4e0d\u91cd\u8a66\uff0c\u76f4\u63a5\u8fd4\u56de\n</code></pre></li> <li>\u6b7b\u4fe1\u968a\u5217\uff1a\u5c0d\u65bc\u7121\u6cd5\u91cd\u8a66\u7684\u4efb\u52d9\uff0c\u53ef\u5c07\u5931\u6557\u4efb\u52d9\u767c\u9001\u5230\u6b7b\u4fe1\u968a\u5217\uff08\u9700\u7d50\u5408 RabbitMQ \u914d\u7f6e\uff09\u9032\u884c\u4eba\u5de5\u8655\u7406\u3002</li> </ul>"},{"location":"celery/error-handling-retry/#_9","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u91cd\u8a66\u6027\u80fd\u5f71\u97ff\uff1a\u904e\u591a\u91cd\u8a66\u53ef\u80fd\u5c0e\u81f4\u968a\u5217\u64c1\u585e\uff0c\u61c9\u5408\u7406\u8a2d\u7f6e <code>max_retries</code>\u3002</li> <li>\u932f\u8aa4\u65e5\u8a8c\uff1a\u78ba\u4fdd\u8a18\u9304\u8a73\u7d30\u932f\u8aa4\u8cc7\u8a0a\uff0c\u4fbf\u65bc\u8abf\u8a66\u8207\u76e3\u63a7\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1a\u932f\u8aa4\u8cc7\u8a0a\u8207\u91cd\u8a66\u72c0\u614b\u4f9d\u8cf4\u7d50\u679c\u5f8c\u7aef\uff0c\u78ba\u4fdd\u5176\u914d\u7f6e\u6b63\u78ba\u3002</li> </ul>"},{"location":"celery/error-handling-retry/#_10","title":"\u5c0f\u7d50","text":"<p>Celery \u7684\u932f\u8aa4\u8655\u7406\u8207\u91cd\u8a66\u6a5f\u5236\u70ba\u4efb\u52d9\u8655\u7406\u63d0\u4f9b\u4e86\u53ef\u9760\u6027\u4fdd\u969c\uff0c\u901a\u904e\u81ea\u52d5\u8207\u624b\u52d5\u91cd\u8a66\uff0c\u60a8\u53ef\u4ee5\u61c9\u5c0d\u5927\u591a\u6578\u5931\u6557\u5834\u666f\u3002\u5408\u7406\u8a2d\u8a08\u91cd\u8a66\u7b56\u7565\u8207\u932f\u8aa4\u8655\u7406\u908f\u8f2f\uff0c\u80fd\u986f\u8457\u63d0\u5347\u7cfb\u7d71\u7a69\u5b9a\u6027\u3002\u672c\u7ae0\u7bc0\u7d50\u675f\u4e86\u300cCelery \u57fa\u790e\u300d\u7684\u5b78\u7fd2\uff0c\u4e0b\u4e00\u968e\u6bb5\u53ef\u4ee5\u9032\u4e00\u6b65\u63a2\u7d22 Celery \u7684\u9032\u968e\u529f\u80fd\uff0c\u5982\u5b9a\u6642\u4efb\u52d9\u8207\u5de5\u4f5c\u6d41\u7a0b\u7ba1\u7406\u3002</p> <p>\u63d0\u793a\uff1a\u91cd\u8a66\u6a5f\u5236\u61c9\u8b39\u614e\u4f7f\u7528\uff0c\u907f\u514d\u56e0\u7121\u9650\u91cd\u8a66\u5c0e\u81f4\u8cc7\u6e90\u6d6a\u8cbb\uff0c\u5efa\u8b70\u7d50\u5408\u65e5\u8a8c\u8207\u76e3\u63a7\u5de5\u5177\u8ffd\u8e64\u4efb\u52d9\u5931\u6557\u539f\u56e0\u3002</p>"},{"location":"celery/result-backend/","title":"\u7d50\u679c\u5f8c\u7aef\uff08Result Backend\uff09","text":"<p>Celery \u652f\u63f4\u5c07\u4efb\u52d9\u57f7\u884c\u7d50\u679c\u5b58\u5132\u5728\u7d50\u679c\u5f8c\u7aef\uff08Result Backend\uff09\uff0c\u4ee5\u4fbf\u61c9\u7528\u7a0b\u5f0f\u67e5\u8a62\u4efb\u52d9\u72c0\u614b\u8207\u7d50\u679c\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u7d50\u679c\u5f8c\u7aef\u7684\u914d\u7f6e\u8207\u4f7f\u7528\u65b9\u6cd5\u3002</p>"},{"location":"celery/result-backend/#_1","title":"\u4ec0\u9ebc\u662f\u7d50\u679c\u5f8c\u7aef\uff1f","text":"<p>\u7d50\u679c\u5f8c\u7aef\u662f Celery \u7528\u65bc\u5b58\u5132\u4efb\u52d9\u57f7\u884c\u7d50\u679c\u7684\u7d44\u4ef6\uff0c\u5141\u8a31\u61c9\u7528\u7a0b\u5f0f\u5728\u4efb\u52d9\u5b8c\u6210\u5f8c\u7372\u53d6\u8fd4\u56de\u503c\u6216\u6aa2\u67e5\u57f7\u884c\u72c0\u614b\u3002\u5e38\u898b\u7684\u7d50\u679c\u5f8c\u7aef\u5305\u62ec Redis\u3001MongoDB\u3001SQLAlchemy \u7b49\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u5b58\u5132\u4efb\u52d9\u7d50\u679c\u8207\u72c0\u614b\uff08\u5982\u6210\u529f\u3001\u5931\u6557\uff09\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u9700\u8981\u7570\u6b65\u4efb\u52d9\u7d50\u679c\u7684\u5834\u666f\uff0c\u5982\u7528\u6236\u63d0\u4ea4\u4efb\u52d9\u5f8c\u67e5\u8a62\u8655\u7406\u9032\u5ea6\u3002</li> </ul>"},{"location":"celery/result-backend/#_2","title":"\u914d\u7f6e\u7d50\u679c\u5f8c\u7aef","text":"<p>\u4ee5\u4e0b\u4ee5 Redis \u4f5c\u70ba\u7d50\u679c\u5f8c\u7aef\u70ba\u4f8b\uff0c\u4ecb\u7d39\u914d\u7f6e\u6b65\u9a5f\u3002\u5047\u8a2d\u60a8\u5df2\u5b89\u88dd Redis \u4f3a\u670d\u5668\u3002</p>"},{"location":"celery/result-backend/#1-redis","title":"\u6b65\u9a5f 1\uff1a\u5b89\u88dd Redis \u5ba2\u6236\u7aef","text":"<pre><code>pip install redis\n</code></pre>"},{"location":"celery/result-backend/#2-celery","title":"\u6b65\u9a5f 2\uff1a\u914d\u7f6e Celery \u61c9\u7528","text":"<p>\u5728 Celery \u61c9\u7528\u521d\u59cb\u5316\u6642\u6307\u5b9a\u7d50\u679c\u5f8c\u7aef\uff1a <pre><code>from celery import Celery\n\n# \u521d\u59cb\u5316 Celery\uff0c\u6307\u5b9a\u6d88\u606f\u4ee3\u7406\u8207\u7d50\u679c\u5f8c\u7aef\napp = Celery('tasks',\n             broker='amqp://guest:guest@localhost:5672//',\n             backend='redis://localhost:6379/0')\n\n# \u914d\u7f6e Celery\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n    task_track_started=True,  # \u8ffd\u8e64\u4efb\u52d9\u958b\u59cb\u72c0\u614b\n    task_store_errors_even_if_ignored=True,  # \u5373\u4f7f\u4efb\u52d9\u88ab\u5ffd\u7565\u4e5f\u5b58\u5132\u932f\u8aa4\n)\n</code></pre></p>"},{"location":"celery/result-backend/#_3","title":"\u67e5\u8a62\u4efb\u52d9\u7d50\u679c","text":"<p>\u4efb\u52d9\u767c\u9001\u5f8c\uff0c\u53ef\u4f7f\u7528 <code>AsyncResult</code> \u7269\u4ef6\u67e5\u8a62\u7d50\u679c\u8207\u72c0\u614b\uff1a</p>"},{"location":"celery/result-backend/#_4","title":"\u793a\u4f8b\uff1a\u767c\u9001\u4efb\u52d9\u8207\u67e5\u8a62\u7d50\u679c","text":"<pre><code>from celery.result import AsyncResult\nfrom app import add  # \u5047\u8a2d add \u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u767c\u9001\u4efb\u52d9\nresult = add.delay(5, 3)\n\n# \u67e5\u8a62\u4efb\u52d9\u72c0\u614b\nprint(\"Task ID:\", result.id)\nprint(\"Task Status:\", result.status)  # PENDING, STARTED, SUCCESS, FAILURE \u7b49\n\n# \u7b49\u5f85\u7d50\u679c\uff08\u53ef\u9078\uff09\nif result.ready():  # \u6aa2\u67e5\u4efb\u52d9\u662f\u5426\u5b8c\u6210\n    if result.successful():  # \u6aa2\u67e5\u4efb\u52d9\u662f\u5426\u6210\u529f\n        print(\"Result:\", result.get())  # \u7372\u53d6\u7d50\u679c\n    else:\n        print(\"Task failed:\", result.get(propagate=False))  # \u7372\u53d6\u932f\u8aa4\u8cc7\u8a0a\nelse:\n    print(\"Task not finished yet\")\n</code></pre>"},{"location":"celery/result-backend/#_5","title":"\u7d50\u679c\u5f8c\u7aef\u9078\u9805","text":"<ul> <li>Redis\uff1a\u8f15\u91cf\u9ad8\u6548\uff0c\u9069\u5408\u5927\u591a\u6578\u5834\u666f\u3002</li> <li>\u914d\u7f6e\uff1a<code>backend='redis://localhost:6379/0'</code></li> <li>MongoDB\uff1a\u9069\u5408\u9700\u8981\u6301\u4e45\u5316\u7d50\u679c\u7684\u5834\u666f\u3002</li> <li>\u914d\u7f6e\uff1a<code>backend='mongodb://localhost:27017/'</code>\uff0c\u9700\u5b89\u88dd <code>pymongo</code>\u3002</li> <li>SQLAlchemy\uff1a\u9069\u5408\u8207\u73fe\u6709\u95dc\u4fc2\u578b\u8cc7\u6599\u5eab\u6574\u5408\u3002</li> <li>\u914d\u7f6e\uff1a<code>backend='sqlalchemy+sqlite:///celery.db'</code>\uff0c\u9700\u5b89\u88dd\u5c0d\u61c9\u9a45\u52d5\u3002</li> </ul>"},{"location":"celery/result-backend/#_6","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u7d50\u679c\u904e\u671f\uff1a\u8a2d\u7f6e\u7d50\u679c\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u5f8c\u7aef\u5b58\u5132\u904e\u591a\u6578\u64da\u3002   <pre><code>app.conf.update(result_expires=3600)  # \u7d50\u679c\u4fdd\u75591\u5c0f\u6642\n</code></pre></li> <li>\u6027\u80fd\u5f71\u97ff\uff1a\u555f\u7528\u7d50\u679c\u5f8c\u7aef\u6703\u589e\u52a0\u5beb\u5165\u958b\u92b7\uff0c\u82e5\u7121\u9700\u7d50\u679c\uff0c\u53ef\u7981\u7528\u3002</li> <li>\u5b89\u5168\u6027\uff1a\u78ba\u4fdd\u5f8c\u7aef\u5b58\u5132\uff08\u5982 Redis\uff09\u8a2d\u7f6e\u9069\u7576\u7684\u8a2a\u554f\u63a7\u5236\uff0c\u907f\u514d\u6578\u64da\u6d29\u9732\u3002</li> </ul>"},{"location":"celery/result-backend/#_7","title":"\u5c0f\u7d50","text":"<p>\u7d50\u679c\u5f8c\u7aef\u662f Celery \u5be6\u73fe\u4efb\u52d9\u7d50\u679c\u5b58\u5132\u8207\u67e5\u8a62\u7684\u95dc\u9375\u7d44\u4ef6\uff0c\u901a\u904e\u5408\u7406\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u6eff\u8db3\u4e0d\u540c\u5834\u666f\u7684\u9700\u6c42\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\u300d\uff0c\u6df1\u5165\u63a2\u7d22\u5982\u4f55\u76e3\u63a7\u4efb\u52d9\u57f7\u884c\u904e\u7a0b\u3002</p> <p>\u63d0\u793a\uff1a\u9078\u64c7\u7d50\u679c\u5f8c\u7aef\u6642\uff0c\u9700\u5e73\u8861\u6027\u80fd\u8207\u6301\u4e45\u5316\u9700\u6c42\uff0cRedis \u662f\u5927\u591a\u6578\u5834\u666f\u7684\u9996\u9078\u3002</p>"},{"location":"celery/task-definition-execution/","title":"\u4efb\u52d9\u5b9a\u7fa9\u8207\u57f7\u884c","text":"<p>Celery \u7684\u6838\u5fc3\u529f\u80fd\u662f\u8655\u7406\u7570\u6b65\u4efb\u52d9\uff0c\u672c\u6587\u5c07\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 Celery \u5b9a\u7fa9\u4efb\u52d9\u4e26\u5728\u5f8c\u53f0\u57f7\u884c\uff0c\u5e6b\u52a9\u60a8\u5feb\u901f\u5be6\u73fe\u61c9\u7528\u7a0b\u5f0f\u7684\u7570\u6b65\u8655\u7406\u3002</p>"},{"location":"celery/task-definition-execution/#celery","title":"Celery \u74b0\u5883\u8a2d\u7f6e","text":"<p>\u5728\u4f7f\u7528 Celery \u4e4b\u524d\uff0c\u9700\u5b8c\u6210\u57fa\u672c\u74b0\u5883\u8a2d\u7f6e\u3002\u4ee5\u4e0b\u5047\u8a2d\u60a8\u5df2\u5b89\u88dd RabbitMQ \u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\u3002</p>"},{"location":"celery/task-definition-execution/#1-celery","title":"\u6b65\u9a5f 1\uff1a\u5b89\u88dd Celery","text":"<p>\u4f7f\u7528 pip \u5b89\u88dd Celery\uff1a <pre><code>pip install celery\n</code></pre></p>"},{"location":"celery/task-definition-execution/#2","title":"\u6b65\u9a5f 2\uff1a\u5b89\u88dd\u6d88\u606f\u4ee3\u7406","text":"<p>\u82e5\u4f7f\u7528 RabbitMQ\uff0c\u78ba\u4fdd\u5df2\u5b89\u88dd\u4e26\u555f\u52d5\u670d\u52d9\u3002\u82e5\u4f7f\u7528 Redis\uff0c\u53ef\u5b89\u88dd\uff1a <pre><code>pip install redis\n</code></pre></p>"},{"location":"celery/task-definition-execution/#celery_1","title":"\u5b9a\u7fa9 Celery \u4efb\u52d9","text":"<p>Celery \u4efb\u52d9\u662f\u4f7f\u7528 <code>@app.task</code> \u88dd\u98fe\u5668\u5b9a\u7fa9\u7684 Python \u51fd\u6578\u3002\u4ee5\u4e0b\u662f\u57fa\u672c\u6b65\u9a5f\u8207\u793a\u4f8b\uff1a</p>"},{"location":"celery/task-definition-execution/#1-celery_1","title":"\u6b65\u9a5f 1\uff1a\u5275\u5efa Celery \u5be6\u4f8b","text":"<p>\u5275\u5efa\u4e00\u500b\u540d\u70ba <code>app.py</code> \u7684\u6587\u4ef6\uff0c\u521d\u59cb\u5316 Celery \u61c9\u7528\uff1a <pre><code>from celery import Celery\n\n# \u521d\u59cb\u5316 Celery\uff0c\u6307\u5b9a\u6d88\u606f\u4ee3\u7406\uff08\u9019\u88e1\u4f7f\u7528 RabbitMQ\uff09\napp = Celery('tasks', broker='amqp://guest:guest@localhost:5672//')\n\n# \u914d\u7f6e Celery\uff08\u53ef\u9078\uff09\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n)\n</code></pre></p>"},{"location":"celery/task-definition-execution/#2_1","title":"\u6b65\u9a5f 2\uff1a\u5b9a\u7fa9\u4efb\u52d9","text":"<p>\u5728\u540c\u4e00\u6587\u4ef6\u6216\u53e6\u4e00\u6587\u4ef6\u4e2d\u5b9a\u7fa9\u4efb\u52d9\uff1a <pre><code>@app.task\ndef add(x, y):\n    return x + y\n\n@app.task\ndef send_email(to, subject, body):\n    # \u6a21\u64ec\u767c\u9001\u90f5\u4ef6\n    print(f\"Sending email to {to}: {subject}\")\n    return f\"Email sent to {to}\"\n</code></pre></p>"},{"location":"celery/task-definition-execution/#celery_2","title":"\u57f7\u884c Celery \u4efb\u52d9","text":"<p>\u4efb\u52d9\u5b9a\u7fa9\u5f8c\uff0c\u53ef\u901a\u904e\u4ee5\u4e0b\u65b9\u5f0f\u57f7\u884c\uff1a</p>"},{"location":"celery/task-definition-execution/#1","title":"\u65b9\u5f0f 1\uff1a\u7570\u6b65\u57f7\u884c","text":"<p>\u4f7f\u7528 <code>delay()</code> \u65b9\u6cd5\u5c07\u4efb\u52d9\u767c\u9001\u5230\u968a\u5217\uff0c\u7acb\u5373\u8fd4\u56de\u800c\u4e0d\u7b49\u5f85\u7d50\u679c\uff1a <pre><code># \u8abf\u7528\u4efb\u52d9\uff08\u7570\u6b65\uff09\nresult = add.delay(4, 6)\nprint(\"Task sent, ID:\", result.id)\n</code></pre></p>"},{"location":"celery/task-definition-execution/#2_2","title":"\u65b9\u5f0f 2\uff1a\u540c\u6b65\u57f7\u884c\uff08\u6e2c\u8a66\u7528\uff09","text":"<p>\u4f7f\u7528 <code>apply()</code> \u65b9\u6cd5\u540c\u6b65\u57f7\u884c\u4efb\u52d9\uff08\u50c5\u7528\u65bc\u8abf\u8a66\uff0c\u4e0d\u63a8\u85a6\u5728\u751f\u7522\u74b0\u5883\u4f7f\u7528\uff09\uff1a <pre><code>result = add.apply(args=(4, 6))\nprint(\"Result:\", result.get())\n</code></pre></p>"},{"location":"celery/task-definition-execution/#celery_3","title":"\u555f\u52d5 Celery \u5de5\u4f5c\u8005","text":"<p>\u4efb\u52d9\u767c\u9001\u5f8c\uff0c\u9700\u555f\u52d5\u5de5\u4f5c\u8005\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u4e26\u57f7\u884c\u4efb\u52d9\uff1a <pre><code>celery -A app worker --loglevel=info\n</code></pre> - <code>-A app</code>\uff1a\u6307\u5b9a Celery \u61c9\u7528\u6a21\u7d44\uff08\u9019\u88e1\u662f <code>app.py</code>\uff09\u3002 - <code>--loglevel=info</code>\uff1a\u8a2d\u7f6e\u65e5\u8a8c\u7b49\u7d1a\uff0c\u65b9\u4fbf\u8abf\u8a66\u3002</p>"},{"location":"celery/task-definition-execution/#_2","title":"\u61c9\u7528\u5834\u666f\u793a\u4f8b","text":"<ul> <li>\u90f5\u4ef6\u767c\u9001\uff1a\u5c07\u8017\u6642\u7684\u90f5\u4ef6\u767c\u9001\u64cd\u4f5c\u4ea4\u7531 Celery \u8655\u7406\uff0c\u907f\u514d\u963b\u585e\u4e3b\u61c9\u7528\u3002   <pre><code>send_email.delay(\"user@example.com\", \"Welcome\", \"Welcome to our platform!\")\n</code></pre></li> <li>\u6578\u64da\u8655\u7406\uff1a\u8655\u7406\u5927\u898f\u6a21\u6578\u64da\u532f\u7e3d\u6216\u5716\u7247\u7e2e\u653e\u3002   <pre><code>@app.task\ndef process_data(data):\n    # \u6a21\u64ec\u8017\u6642\u8655\u7406\n    return len(data)\n</code></pre></li> </ul>"},{"location":"celery/task-definition-execution/#_3","title":"\u5c0f\u7d50","text":"<p>\u901a\u904e\u5b9a\u7fa9\u8207\u57f7\u884c Celery \u4efb\u52d9\uff0c\u60a8\u53ef\u4ee5\u8f15\u9b06\u5be6\u73fe\u61c9\u7528\u7a0b\u5f0f\u7684\u7570\u6b65\u8655\u7406\uff0c\u63d0\u5347\u97ff\u61c9\u901f\u5ea6\u8207\u7528\u6236\u9ad4\u9a57\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u7d50\u679c\u5f8c\u7aef\uff08Result Backend\uff09\u300d\uff0c\u5b78\u7fd2\u5982\u4f55\u5b58\u5132\u8207\u67e5\u8a62\u4efb\u52d9\u57f7\u884c\u7d50\u679c\u3002</p> <p>\u63d0\u793a\uff1a\u4efb\u52d9\u61c9\u8a2d\u8a08\u70ba\u8f15\u91cf\u4e14\u53ef\u91cd\u5165\uff0c\u907f\u514d\u5728\u4efb\u52d9\u4e2d\u57f7\u884c\u904e\u65bc\u8907\u96dc\u6216\u4e0d\u53ef\u9810\u6e2c\u7684\u64cd\u4f5c\u3002</p>"},{"location":"celery/task-status-tracking/","title":"\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64","text":"<p>Celery \u63d0\u4f9b\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\u529f\u80fd\uff0c\u5141\u8a31\u61c9\u7528\u7a0b\u5f0f\u76e3\u63a7\u4efb\u52d9\u7684\u57f7\u884c\u9032\u5ea6\u8207\u7d50\u679c\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 Celery \u8ffd\u8e64\u4efb\u52d9\u72c0\u614b\uff0c\u5e6b\u52a9\u60a8\u7ba1\u7406\u7570\u6b65\u4efb\u52d9\u3002</p>"},{"location":"celery/task-status-tracking/#_2","title":"\u4efb\u52d9\u72c0\u614b\u6982\u8ff0","text":"<p>Celery \u4e2d\u7684\u4efb\u52d9\u5728\u57f7\u884c\u904e\u7a0b\u4e2d\u6703\u7d93\u6b77\u591a\u7a2e\u72c0\u614b\uff0c\u9019\u4e9b\u72c0\u614b\u5b58\u5132\u5728\u7d50\u679c\u5f8c\u7aef\u4e2d\uff0c\u53ef\u4f9b\u67e5\u8a62\uff1a</p> <ul> <li>PENDING\uff1a\u4efb\u52d9\u5df2\u767c\u9001\u4f46\u5c1a\u672a\u958b\u59cb\u57f7\u884c\u3002</li> <li>STARTED\uff1a\u4efb\u52d9\u5df2\u958b\u59cb\u57f7\u884c\uff08\u9700\u8a2d\u7f6e <code>task_track_started=True</code>\uff09\u3002</li> <li>SUCCESS\uff1a\u4efb\u52d9\u6210\u529f\u5b8c\u6210\u3002</li> <li>FAILURE\uff1a\u4efb\u52d9\u57f7\u884c\u5931\u6557\u3002</li> <li>RETRY\uff1a\u4efb\u52d9\u6b63\u5728\u91cd\u8a66\uff08\u901a\u5e38\u56e0\u932f\u8aa4\u89f8\u767c\uff09\u3002</li> <li>REVOKED\uff1a\u4efb\u52d9\u88ab\u64a4\u92b7\u6216\u7d42\u6b62\u3002</li> </ul>"},{"location":"celery/task-status-tracking/#_3","title":"\u914d\u7f6e\u72c0\u614b\u8ffd\u8e64","text":"<p>\u8981\u555f\u7528\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\uff0c\u9700\u78ba\u4fdd\u7d50\u679c\u5f8c\u7aef\u5df2\u6b63\u78ba\u914d\u7f6e\uff0c\u4e26\u555f\u7528\u76f8\u95dc\u9078\u9805\uff1a</p> <pre><code>from celery import Celery\n\napp = Celery('tasks',\n             broker='amqp://guest:guest@localhost:5672//',\n             backend='redis://localhost:6379/0')\n\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n    task_track_started=True,  # \u8ffd\u8e64\u4efb\u52d9\u958b\u59cb\u72c0\u614b\n    task_store_errors_even_if_ignored=True,  # \u5b58\u5132\u932f\u8aa4\u8cc7\u8a0a\n)\n</code></pre>"},{"location":"celery/task-status-tracking/#_4","title":"\u67e5\u8a62\u4efb\u52d9\u72c0\u614b","text":"<p>\u4f7f\u7528 <code>AsyncResult</code> \u7269\u4ef6\u67e5\u8a62\u4efb\u52d9\u72c0\u614b\u8207\u7d50\u679c\uff1a</p>"},{"location":"celery/task-status-tracking/#_5","title":"\u793a\u4f8b\uff1a\u8ffd\u8e64\u4efb\u52d9\u72c0\u614b","text":"<pre><code>from celery.result import AsyncResult\nfrom app import add  # \u5047\u8a2d add \u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u767c\u9001\u4efb\u52d9\nresult = add.delay(2, 3)\n\n# \u67e5\u8a62\u72c0\u614b\nprint(\"Task ID:\", result.id)\nprint(\"Task Status:\", result.status)\n\n# \u6aa2\u67e5\u662f\u5426\u5b8c\u6210\nif result.ready():\n    print(\"Task is done!\")\n    if result.successful():\n        print(\"Result:\", result.get())\n    else:\n        print(\"Task failed:\", result.get(propagate=False))\nelse:\n    print(\"Task is still running...\")\n</code></pre>"},{"location":"celery/task-status-tracking/#_6","title":"\u81ea\u5b9a\u7fa9\u72c0\u614b\u66f4\u65b0","text":"<p>\u5728\u9577\u6642\u9593\u904b\u884c\u7684\u4efb\u52d9\u4e2d\uff0c\u53ef\u624b\u52d5\u66f4\u65b0\u72c0\u614b\u4ee5\u63d0\u4f9b\u9032\u5ea6\u53cd\u994b\uff1a</p>"},{"location":"celery/task-status-tracking/#_7","title":"\u793a\u4f8b\uff1a\u66f4\u65b0\u4efb\u52d9\u9032\u5ea6","text":"<pre><code>@app.task(bind=True)\ndef long_running_task(self):\n    for i in range(10):\n        # \u66f4\u65b0\u4efb\u52d9\u72c0\u614b\u8207\u9032\u5ea6\n        self.update_state(state='PROGRESS', meta={'current': i, 'total': 10})\n        # \u6a21\u64ec\u8017\u6642\u64cd\u4f5c\n        import time\n        time.sleep(1)\n    return \"Task completed!\"\n\n# \u67e5\u8a62\u9032\u5ea6\nresult = long_running_task.delay()\nwhile not result.ready():\n    meta = result.info or {}\n    if result.status == 'PROGRESS':\n        print(f\"Progress: {meta.get('current', 0)}/{meta.get('total', 0)}\")\n    import time\n    time.sleep(0.5)\n</code></pre>"},{"location":"celery/task-status-tracking/#_8","title":"\u4efb\u52d9\u64a4\u92b7","text":"<p>\u82e5\u9700\u4e2d\u6b62\u4efb\u52d9\uff0c\u53ef\u4f7f\u7528 <code>revoke</code> \u65b9\u6cd5\uff1a <pre><code>result = long_running_task.delay()\n# \u64a4\u92b7\u4efb\u52d9\napp.control.revoke(result.id, terminate=True)\nprint(\"Task revoked\")\n</code></pre></p>"},{"location":"celery/task-status-tracking/#_9","title":"\u5c0f\u7d50","text":"<p>\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\u662f Celery \u7ba1\u7406\u7570\u6b65\u4efb\u52d9\u7684\u91cd\u8981\u529f\u80fd\uff0c\u901a\u904e\u67e5\u8a62\u72c0\u614b\u8207\u81ea\u5b9a\u7fa9\u9032\u5ea6\u66f4\u65b0\uff0c\u60a8\u53ef\u4ee5\u6709\u6548\u76e3\u63a7\u4efb\u52d9\u57f7\u884c\u904e\u7a0b\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u932f\u8aa4\u8655\u7406\u8207\u91cd\u8a66\u6a5f\u5236\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u61c9\u5c0d\u4efb\u52d9\u5931\u6557\u7684\u60c5\u6cc1\u3002</p> <p>\u63d0\u793a\uff1a\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\u4f9d\u8cf4\u7d50\u679c\u5f8c\u7aef\uff0c\u78ba\u4fdd\u5f8c\u7aef\u914d\u7f6e\u6b63\u78ba\u4e14\u6548\u80fd\u8db3\u5920\u3002</p>"},{"location":"celery/advanced/","title":"Celery \u9032\u968e\u529f\u80fd","text":"<p>\u6b61\u8fce\u4f86\u5230\u300cCelery \u9032\u968e\u529f\u80fd\u300d\u7ae0\u7bc0\uff01\u5728\u524d\u9762\u7684\u300cCelery \u57fa\u790e\u300d\u4e2d\uff0c\u6211\u5011\u5b78\u7fd2\u4e86 Celery \u7684\u57fa\u672c\u6982\u5ff5\u3001\u4efb\u52d9\u5b9a\u7fa9\u8207\u57f7\u884c\u3001\u7d50\u679c\u7ba1\u7406\u4ee5\u53ca\u932f\u8aa4\u8655\u7406\u3002\u672c\u7ae0\u7bc0\u5c07\u6df1\u5165\u63a2\u7d22 Celery \u7684\u9ad8\u7d1a\u529f\u80fd\uff0c\u5e6b\u52a9\u60a8\u61c9\u5c0d\u66f4\u8907\u96dc\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u9700\u6c42\uff0c\u9032\u4e00\u6b65\u63d0\u5347\u7cfb\u7d71\u7684\u9748\u6d3b\u6027\u8207\u6548\u80fd\u3002</p>"},{"location":"celery/advanced/#celery_1","title":"\u4ec0\u9ebc\u662f Celery \u9032\u968e\u529f\u80fd\uff1f","text":"<p>Celery \u9032\u968e\u529f\u80fd\u662f\u6307\u8d85\u8d8a\u57fa\u672c\u7570\u6b65\u4efb\u52d9\u57f7\u884c\u7684\u5de5\u5177\u8207\u6a5f\u5236\uff0c\u65e8\u5728\u89e3\u6c7a\u8907\u96dc\u5de5\u4f5c\u6d41\u3001\u4efb\u52d9\u8abf\u5ea6\u8207\u7cfb\u7d71\u512a\u5316\u554f\u984c\u3002\u9019\u4e9b\u529f\u80fd\u8b93\u60a8\u80fd\u5920\u8a2d\u8a08\u7cbe\u7d30\u7684\u4efb\u52d9\u6d41\u7a0b\u3001\u63a7\u5236\u4efb\u52d9\u57f7\u884c\u9806\u5e8f\u8207\u8cc7\u6e90\u4f7f\u7528\uff0c\u4e26\u5be6\u73fe\u9ad8\u6548\u7684\u5206\u6563\u5f0f\u8655\u7406\u3002</p> <ul> <li>\u89d2\u8272\uff1a\u652f\u63f4\u8907\u96dc\u4efb\u52d9\u7de8\u6392\u8207\u7cfb\u7d71\u512a\u5316\u3002</li> <li>\u6838\u5fc3\u529f\u80fd\uff1a\u5de5\u4f5c\u6d41\u7ba1\u7406\u3001\u4efb\u52d9\u8def\u7531\u3001\u512a\u5148\u7d1a\u63a7\u5236\u3001\u4e26\u767c\u9650\u5236\u8207\u9060\u7a0b\u8abf\u7528\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u5927\u898f\u6a21\u4efb\u52d9\u8655\u7406\u3001\u4f9d\u8cf4\u4efb\u52d9\u7de8\u6392\u3001\u8cc7\u6e90\u53d7\u9650\u74b0\u5883\u4e0b\u7684\u4efb\u52d9\u8abf\u5ea6\u3002</li> </ul>"},{"location":"celery/advanced/#_1","title":"\u672c\u7ae0\u7bc0\u5167\u5bb9\u6982\u8ff0","text":"<p>\u5728\u672c\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4ee5\u4e0b\u6838\u5fc3\u4e3b\u984c\uff1a - \u5de5\u4f5c\u6d41\uff08Canvas\uff09\uff1a\u5b78\u7fd2\u5982\u4f55\u4f7f\u7528 Chain\u3001Group\u3001Chord\u3001Map \u7b49\u5de5\u5177\u7de8\u6392\u8907\u96dc\u4efb\u52d9\u6d41\u7a0b\u3002 - \u4efb\u52d9\u8def\u7531\uff1a\u6839\u64da\u4efb\u52d9\u985e\u578b\u6216\u5c6c\u6027\u5c07\u4efb\u52d9\u5206\u767c\u5230\u7279\u5b9a\u968a\u5217\u6216\u5de5\u4f5c\u8005\u3002 - \u4efb\u52d9\u512a\u5148\u7d1a\uff1a\u70ba\u4efb\u52d9\u8a2d\u7f6e\u512a\u5148\u7d1a\uff0c\u78ba\u4fdd\u91cd\u8981\u4efb\u52d9\u512a\u5148\u8655\u7406\u3002 - \u4e26\u767c\u63a7\u5236\uff1a\u9650\u5236\u5de5\u4f5c\u8005\u4e26\u767c\u4efb\u52d9\u6578\u91cf\uff0c\u907f\u514d\u8cc7\u6e90\u904e\u8f09\u3002 - \u9060\u7a0b\u8abf\u7528\uff08RPC\uff09\uff1a\u5be6\u73fe\u540c\u6b65\u98a8\u683c\u7684\u9060\u7a0b\u904e\u7a0b\u8abf\u7528\uff0c\u7c21\u5316\u4efb\u52d9\u7d50\u679c\u7372\u53d6\u3002</p>"},{"location":"celery/advanced/#_2","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5b8c\u6210\u672c\u7ae0\u7bc0\u5f8c\uff0c\u60a8\u5c07\u80fd\u5920\uff1a - \u4f7f\u7528 Canvas \u5de5\u5177\u8a2d\u8a08\u8207\u57f7\u884c\u8907\u96dc\u4efb\u52d9\u5de5\u4f5c\u6d41\u3002 - \u914d\u7f6e\u4efb\u52d9\u8def\u7531\u8207\u512a\u5148\u7d1a\uff0c\u512a\u5316\u4efb\u52d9\u5206\u767c\u3002 - \u63a7\u5236\u4e26\u767c\u884c\u70ba\uff0c\u63d0\u5347\u7cfb\u7d71\u7a69\u5b9a\u6027\u3002 - \u5be6\u73fe\u9060\u7a0b\u8abf\u7528\uff0c\u7c21\u5316\u7570\u6b65\u4efb\u52d9\u8207\u7d50\u679c\u8655\u7406\u7684\u4ea4\u4e92\u3002</p> <p>\u8b93\u6211\u5011\u5f9e\u300c\u5de5\u4f5c\u6d41\uff08Canvas\uff09\u300d\u958b\u59cb\uff0c\u9010\u6b65\u63a2\u7d22 Celery \u7684\u9032\u968e\u529f\u80fd\uff01</p> <p>\u63d0\u793a\uff1a\u672c\u7ae0\u7bc0\u5047\u8a2d\u60a8\u5df2\u719f\u6089 Celery \u57fa\u790e\u6982\u5ff5\uff0c\u82e5\u9700\u8907\u7fd2\uff0c\u8acb\u53c3\u8003\u524d\u4e00\u7ae0\u7bc0\u300cCelery \u57fa\u790e\u300d\u3002</p>"},{"location":"celery/advanced/concurrency-control/","title":"\u4e26\u767c\u63a7\u5236","text":"<p>\u4e26\u767c\u63a7\u5236\u662f Celery \u7684\u4e00\u7a2e\u9032\u968e\u529f\u80fd\uff0c\u5141\u8a31\u60a8\u9650\u5236\u5de5\u4f5c\u8005\u540c\u6642\u8655\u7406\u7684\u4efb\u52d9\u6578\u91cf\uff0c\u907f\u514d\u8cc7\u6e90\u904e\u8f09\u8207\u7cfb\u7d71\u5d29\u6f70\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u4e26\u767c\u63a7\u5236\u7684\u914d\u7f6e\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/concurrency-control/#_2","title":"\u4ec0\u9ebc\u662f\u4e26\u767c\u63a7\u5236\uff1f","text":"<p>\u4e26\u767c\u63a7\u5236\u662f\u6307\u901a\u904e\u8a2d\u7f6e\u53c3\u6578\uff0c\u63a7\u5236\u6bcf\u500b\u5de5\u4f5c\u8005\u540c\u6642\u57f7\u884c\u7684\u4efb\u52d9\u6578\u91cf\uff08\u5373\u4e26\u767c\u5ea6\uff09\u3002\u9019\u6709\u52a9\u65bc\u5728\u8cc7\u6e90\u6709\u9650\u7684\u74b0\u5883\u4e2d\u9632\u6b62\u904e\u8f09\uff0c\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u6027\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u9650\u5236\u5de5\u4f5c\u8005\u4e26\u767c\u4efb\u52d9\u6578\u91cf\uff0c\u4fdd\u8b77\u7cfb\u7d71\u8cc7\u6e90\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u4f3a\u670d\u5668\u8cc7\u6e90\u6709\u9650\uff0c\u6216\u4efb\u52d9\u57f7\u884c\u53ef\u80fd\u5c0e\u81f4\u9ad8 CPU/\u8a18\u61b6\u9ad4\u4f7f\u7528\u6642\u3002</li> </ul>"},{"location":"celery/advanced/concurrency-control/#_3","title":"\u4e26\u767c\u63a7\u5236\u914d\u7f6e","text":"<p>Celery \u63d0\u4f9b\u591a\u7a2e\u65b9\u5f0f\u63a7\u5236\u4e26\u767c\u5ea6\uff0c\u5305\u62ec\u5de5\u4f5c\u8005\u7d1a\u5225\u8207\u4efb\u52d9\u7d1a\u5225\u7684\u9650\u5236\u3002</p>"},{"location":"celery/advanced/concurrency-control/#_4","title":"\u5de5\u4f5c\u8005\u7d1a\u5225\u4e26\u767c\u63a7\u5236","text":"<p>\u901a\u904e\u555f\u52d5\u5de5\u4f5c\u8005\u6642\u8a2d\u7f6e <code>--concurrency</code> \u53c3\u6578\uff0c\u9650\u5236\u6bcf\u500b\u5de5\u4f5c\u8005\u9032\u7a0b\u7684\u4e26\u767c\u4efb\u52d9\u6578\uff1a <pre><code># \u9650\u5236\u6bcf\u500b\u5de5\u4f5c\u8005\u9032\u7a0b\u540c\u6642\u8655\u7406 4 \u500b\u4efb\u52d9\ncelery -A app worker --loglevel=info --concurrency=4\n</code></pre></p> <ul> <li>--concurrency\uff1a\u8a2d\u7f6e\u5de5\u4f5c\u8005\u9032\u7a0b\u7684\u4e26\u767c\u5ea6\uff0c\u9810\u8a2d\u503c\u901a\u5e38\u8207 CPU \u6838\u5fc3\u6578\u76f8\u95dc\u3002</li> </ul>"},{"location":"celery/advanced/concurrency-control/#_5","title":"\u4f7f\u7528\u9032\u7a0b\u6c60\u63a7\u5236","text":"<p>Celery \u652f\u63f4\u591a\u7a2e\u4e26\u767c\u6a21\u578b\uff0c\u5e38\u7528\u7684\u662f <code>prefork</code> \u9032\u7a0b\u6c60\uff0c\u53ef\u4ee5\u901a\u904e\u914d\u7f6e\u9032\u4e00\u6b65\u9650\u5236\uff1a <pre><code># \u4f7f\u7528 prefork \u6a21\u578b\uff0c\u9650\u5236\u4e26\u767c\u5ea6\u70ba 2\ncelery -A app worker --loglevel=info --pool=prefork --concurrency=2\n</code></pre></p> <ul> <li>--pool=prefork\uff1a\u4f7f\u7528\u9032\u7a0b\u6c60\u6a21\u578b\uff0c\u9069\u5408 CPU \u5bc6\u96c6\u578b\u4efb\u52d9\u3002</li> <li>\u5176\u4ed6\u6a21\u578b\u5305\u62ec <code>solo</code>\uff08\u55ae\u9032\u7a0b\uff09\u3001<code>threads</code>\uff08\u7dda\u7a0b\u6c60\uff09\u7b49\uff0c\u6839\u64da\u4efb\u52d9\u6027\u8cea\u9078\u64c7\u3002</li> </ul>"},{"location":"celery/advanced/concurrency-control/#_6","title":"\u4efb\u52d9\u7d1a\u5225\u901f\u7387\u9650\u5236","text":"<p>Celery \u9084\u652f\u63f4\u70ba\u7279\u5b9a\u4efb\u52d9\u8a2d\u7f6e\u901f\u7387\u9650\u5236\uff08\u6bcf\u79d2\u57f7\u884c\u6b21\u6578\uff09\uff0c\u907f\u514d\u904e\u983b\u7e41\u57f7\u884c\uff1a <pre><code>@app.task(rate_limit='10/m')  # \u6bcf\u5206\u9418\u6700\u591a 10 \u6b21\ndef rate_limited_task(data):\n    return process_data(data)\n</code></pre></p> <ul> <li>rate_limit\uff1a\u8a2d\u7f6e\u4efb\u52d9\u57f7\u884c\u901f\u7387\uff0c\u5982 <code>10/m</code>\uff08\u6bcf\u5206\u9418 10 \u6b21\uff09\u3001<code>5/s</code>\uff08\u6bcf\u79d2 5 \u6b21\uff09\u3002</li> </ul>"},{"location":"celery/advanced/concurrency-control/#_7","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u8cc7\u6e90\u53d7\u9650\u74b0\u5883\uff1a\u5728\u4f4e\u914d\u4f3a\u670d\u5668\u4e0a\u904b\u884c Celery\uff0c\u9650\u5236\u4e26\u767c\u5ea6\u4ee5\u907f\u514d\u5d29\u6f70\u3002   <pre><code>celery -A app worker --concurrency=2\n</code></pre></li> <li>API \u8abf\u7528\u9650\u5236\uff1a\u907f\u514d\u904e\u983b\u7e41\u8abf\u7528\u5916\u90e8 API\uff0c\u8a2d\u7f6e\u901f\u7387\u9650\u5236\u3002   <pre><code>@app.task(rate_limit='100/h')  # \u6bcf\u5c0f\u6642 100 \u6b21\ndef call_external_api():\n    pass\n</code></pre></li> <li>\u4efb\u52d9\u6027\u8cea\u5dee\u7570\uff1a\u70ba CPU \u5bc6\u96c6\u578b\u4efb\u52d9\u8a2d\u7f6e\u4f4e\u4e26\u767c\u5ea6\uff0c\u70ba I/O \u5bc6\u96c6\u578b\u4efb\u52d9\u8a2d\u7f6e\u9ad8\u4e26\u767c\u5ea6\u3002</li> </ul>"},{"location":"celery/advanced/concurrency-control/#_8","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u4e26\u767c\u5ea6\u8a2d\u7f6e\uff1a\u904e\u4f4e\u53ef\u80fd\u5c0e\u81f4\u4efb\u52d9\u5806\u7a4d\uff0c\u904e\u9ad8\u53ef\u80fd\u5c0e\u81f4\u8cc7\u6e90\u8017\u76e1\uff0c\u9700\u6839\u64da\u4f3a\u670d\u5668\u80fd\u529b\u8207\u4efb\u52d9\u6027\u8cea\u8abf\u6574\u3002</li> <li>\u4e26\u767c\u6a21\u578b\u9078\u64c7\uff1aCPU \u5bc6\u96c6\u578b\u4efb\u52d9\u9069\u5408 <code>prefork</code>\uff0cI/O \u5bc6\u96c6\u578b\u4efb\u52d9\u53ef\u8003\u616e <code>threads</code> \u6216 <code>gevent</code>\u3002</li> <li>\u76e3\u63a7\u8207\u8abf\u6574\uff1a\u4f7f\u7528\u76e3\u63a7\u5de5\u5177\u89c0\u5bdf\u7cfb\u7d71\u8cc7\u6e90\u4f7f\u7528\uff0c\u52d5\u614b\u8abf\u6574\u4e26\u767c\u53c3\u6578\u3002</li> </ul>"},{"location":"celery/advanced/concurrency-control/#_9","title":"\u5c0f\u7d50","text":"<p>\u4e26\u767c\u63a7\u5236\u662f Celery \u4fdd\u8b77\u7cfb\u7d71\u8cc7\u6e90\u8207\u78ba\u4fdd\u7a69\u5b9a\u6027\u7684\u91cd\u8981\u529f\u80fd\uff0c\u901a\u904e\u5408\u7406\u8a2d\u7f6e\u4e26\u767c\u5ea6\u8207\u901f\u7387\u9650\u5236\uff0c\u60a8\u53ef\u4ee5\u907f\u514d\u8cc7\u6e90\u904e\u8f09\uff0c\u63d0\u5347\u7cfb\u7d71\u53ef\u9760\u6027\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u9060\u7a0b\u8abf\u7528\uff08RPC\uff09\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u4ee5\u540c\u6b65\u98a8\u683c\u8655\u7406\u7570\u6b65\u4efb\u52d9\u7d50\u679c\u3002</p> <p>\u63d0\u793a\uff1a\u4e26\u767c\u63a7\u5236\u61c9\u7d50\u5408\u5be6\u969b\u7cfb\u7d71\u8ca0\u8f09\u8207\u4efb\u52d9\u7279\u6027\u6e2c\u8a66\u8abf\u6574\uff0c\u907f\u514d\u4e00\u5200\u5207\u7684\u8a2d\u7f6e\u3002</p>"},{"location":"celery/advanced/remote-procedure-calls/","title":"\u9060\u7a0b\u8abf\u7528\uff08RPC\uff09","text":"<p>\u9060\u7a0b\u8abf\u7528\uff08Remote Procedure Call, RPC\uff09\u662f Celery \u7684\u4e00\u7a2e\u9032\u968e\u529f\u80fd\uff0c\u5141\u8a31\u60a8\u4ee5\u985e\u4f3c\u540c\u6b65\u8abf\u7528\u7684\u65b9\u5f0f\u8655\u7406\u7570\u6b65\u4efb\u52d9\u7d50\u679c\uff0c\u7c21\u5316\u7570\u6b65\u4efb\u52d9\u8207\u7d50\u679c\u7372\u53d6\u7684\u4ea4\u4e92\u3002\u672c\u6587\u5c07\u4ecb\u7d39 RPC \u7684\u914d\u7f6e\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/remote-procedure-calls/#rpc_1","title":"\u4ec0\u9ebc\u662f\u9060\u7a0b\u8abf\u7528\uff08RPC\uff09\uff1f","text":"<p>RPC \u662f\u4e00\u7a2e\u8a2d\u8a08\u6a21\u5f0f\uff0c\u5141\u8a31\u61c9\u7528\u7a0b\u5f0f\u4ee5\u985e\u4f3c\u672c\u5730\u51fd\u6578\u8abf\u7528\u7684\u65b9\u5f0f\u57f7\u884c\u9060\u7a0b\u4efb\u52d9\uff0c\u4e26\u76f4\u63a5\u7372\u53d6\u7d50\u679c\u3002Celery \u901a\u904e\u7d50\u679c\u5f8c\u7aef\u8207\u7279\u5b9a\u914d\u7f6e\u5be6\u73fe RPC \u98a8\u683c\u7684\u8abf\u7528\uff0c\u96b1\u85cf\u7570\u6b65\u4efb\u52d9\u7684\u8907\u96dc\u6027\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u4ee5\u540c\u6b65\u98a8\u683c\u8abf\u7528\u7570\u6b65\u4efb\u52d9\uff0c\u7c21\u5316\u7d50\u679c\u8655\u7406\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u9700\u8981\u5feb\u901f\u7372\u53d6\u4efb\u52d9\u7d50\u679c\uff0c\u4e14\u4efb\u52d9\u57f7\u884c\u6642\u9593\u8f03\u77ed\u7684\u5834\u666f\u3002</li> </ul>"},{"location":"celery/advanced/remote-procedure-calls/#rpc_2","title":"RPC \u914d\u7f6e","text":"<p>Celery \u7684 RPC \u529f\u80fd\u4f9d\u8cf4\u7d50\u679c\u5f8c\u7aef\uff08\u5982 Redis\uff09\uff0c\u4e26\u9700\u8a2d\u7f6e\u7279\u5b9a\u53c3\u6578\u4ee5\u555f\u7528\u540c\u6b65\u98a8\u683c\u8abf\u7528\u3002</p>"},{"location":"celery/advanced/remote-procedure-calls/#1","title":"\u6b65\u9a5f 1\uff1a\u914d\u7f6e\u7d50\u679c\u5f8c\u7aef","text":"<p>\u78ba\u4fdd Celery \u61c9\u7528\u914d\u7f6e\u4e86\u7d50\u679c\u5f8c\u7aef\uff1a <pre><code>from celery import Celery\n\napp = Celery('tasks',\n             broker='amqp://guest:guest@localhost:5672//',\n             backend='redis://localhost:6379/0')\n\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n    task_track_started=True,\n    task_ignore_result=False,\n)\n</code></pre></p> <ul> <li>backend\uff1a\u6307\u5b9a\u7d50\u679c\u5f8c\u7aef\uff08\u5982 Redis\uff09\uff0c\u7528\u65bc\u5b58\u5132\u4efb\u52d9\u7d50\u679c\u3002</li> <li>task_ignore_result=False\uff1a\u78ba\u4fdd\u4efb\u52d9\u7d50\u679c\u88ab\u5b58\u5132\u3002</li> </ul>"},{"location":"celery/advanced/remote-procedure-calls/#2-rpc","title":"\u6b65\u9a5f 2\uff1a\u4f7f\u7528 RPC \u5f8c\u7aef","text":"<p>Celery \u63d0\u4f9b\u4e86\u4e00\u7a2e\u7279\u6b8a\u7684\u7d50\u679c\u5f8c\u7aef <code>rpc://</code>\uff0c\u5c08\u70ba RPC \u98a8\u683c\u8abf\u7528\u8a2d\u8a08\u3002\u5b83\u6703\u81ea\u52d5\u8655\u7406\u7d50\u679c\u7684\u540c\u6b65\u8fd4\u56de\uff1a <pre><code>app = Celery('tasks',\n             broker='amqp://guest:guest@localhost:5672//',\n             backend='rpc://')\n\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n)\n</code></pre></p> <ul> <li>backend='rpc://'\uff1a\u4f7f\u7528 RPC \u5f8c\u7aef\uff0c\u4efb\u52d9\u7d50\u679c\u6703\u901a\u904e\u81e8\u6642\u968a\u5217\u76f4\u63a5\u8fd4\u56de\u7d66\u8abf\u7528\u8005\u3002</li> </ul>"},{"location":"celery/advanced/remote-procedure-calls/#3","title":"\u6b65\u9a5f 3\uff1a\u8abf\u7528\u4efb\u52d9\u4e26\u7372\u53d6\u7d50\u679c","text":"<p>\u4f7f\u7528 <code>apply_async</code> \u6216 <code>delay</code> \u8abf\u7528\u4efb\u52d9\uff0c\u4e26\u901a\u904e <code>get()</code> \u65b9\u6cd5\u540c\u6b65\u7372\u53d6\u7d50\u679c\uff1a <pre><code>from app import add  # \u5047\u8a2d\u9019\u662f\u4e00\u500b\u7c21\u55ae\u7684\u52a0\u6cd5\u4efb\u52d9\n\n# \u8abf\u7528\u4efb\u52d9\nresult = add.delay(2, 3)\n\n# \u540c\u6b65\u7372\u53d6\u7d50\u679c\uff08\u985e\u4f3c RPC\uff09\nprint(\"Result:\", result.get(timeout=10))  # \u7b49\u5f85\u6700\u591a 10 \u79d2\n</code></pre></p> <ul> <li>result.get(timeout=10)\uff1a\u8a2d\u7f6e\u8d85\u6642\u6642\u9593\uff0c\u9632\u6b62\u7121\u9650\u7b49\u5f85\u3002</li> </ul>"},{"location":"celery/advanced/remote-procedure-calls/#_1","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u7c21\u55ae\u8a08\u7b97\u670d\u52d9\uff1a\u5feb\u901f\u57f7\u884c\u7c21\u55ae\u8a08\u7b97\u4e26\u8fd4\u56de\u7d50\u679c\uff0c\u5982\u6578\u5b78\u904b\u7b97\u6216\u6578\u64da\u8655\u7406\u3002   <pre><code>result = compute_sum.delay(10, 20)\nprint(\"Sum:\", result.get(timeout=5))\n</code></pre></li> <li>\u5373\u6642\u67e5\u8a62\uff1a\u9700\u8981\u7acb\u5373\u8fd4\u56de\u7d50\u679c\u7684\u67e5\u8a62\u4efb\u52d9\uff0c\u5982\u67e5\u8a62\u7528\u6236\u8cc7\u6599\u3002</li> <li>\u540c\u6b65\u98a8\u683c API\uff1a\u5728\u9700\u8981\u540c\u6b65 API \u884c\u70ba\u7684\u5834\u666f\u4e2d\uff0c\u96b1\u85cf\u7570\u6b65\u4efb\u52d9\u7684\u8907\u96dc\u6027\u3002</li> </ul>"},{"location":"celery/advanced/remote-procedure-calls/#_2","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u57f7\u884c\u6642\u9593\uff1aRPC \u9069\u5408\u57f7\u884c\u6642\u9593\u8f03\u77ed\u7684\u4efb\u52d9\uff0c\u9577\u6642\u9593\u4efb\u52d9\u53ef\u80fd\u5c0e\u81f4\u8abf\u7528\u8005\u8d85\u6642\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1aRPC \u4f9d\u8cf4\u7d50\u679c\u5f8c\u7aef\u6216\u81e8\u6642\u968a\u5217\uff0c\u78ba\u4fdd\u914d\u7f6e\u6b63\u78ba\u3002</li> <li>\u8d85\u6642\u8a2d\u7f6e\uff1a\u4f7f\u7528 <code>get(timeout=...)</code> \u6642\u8a2d\u7f6e\u5408\u7406\u8d85\u6642\uff0c\u907f\u514d\u8abf\u7528\u8005\u9577\u671f\u963b\u585e\u3002</li> <li>\u6548\u80fd\u5f71\u97ff\uff1a\u983b\u7e41\u4f7f\u7528\u540c\u6b65\u8abf\u7528\u53ef\u80fd\u964d\u4f4e\u7cfb\u7d71\u7684\u7570\u6b65\u512a\u52e2\uff0c\u5efa\u8b70\u50c5\u5728\u5fc5\u8981\u6642\u4f7f\u7528\u3002</li> </ul>"},{"location":"celery/advanced/remote-procedure-calls/#_3","title":"\u5c0f\u7d50","text":"<p>\u9060\u7a0b\u8abf\u7528\uff08RPC\uff09\u662f Celery \u63d0\u4f9b\u7684\u4e00\u7a2e\u7c21\u5316\u7570\u6b65\u4efb\u52d9\u7d50\u679c\u8655\u7406\u7684\u529f\u80fd\uff0c\u901a\u904e\u4ee5\u540c\u6b65\u98a8\u683c\u8abf\u7528\u4efb\u52d9\uff0c\u60a8\u53ef\u4ee5\u964d\u4f4e\u7a0b\u5f0f\u8a2d\u8a08\u8907\u96dc\u6027\uff0c\u7279\u5225\u9069\u5408\u9700\u8981\u5feb\u901f\u97ff\u61c9\u7684\u5834\u666f\u3002\u672c\u7ae0\u7bc0\u7d50\u675f\u4e86\u300cCelery \u9032\u968e\u529f\u80fd\u300d\u7684\u5b78\u7fd2\uff0c\u60a8\u5df2\u638c\u63e1\u4e86\u5de5\u4f5c\u6d41\u7de8\u6392\u3001\u4efb\u52d9\u8def\u7531\u3001\u512a\u5148\u7d1a\u3001\u4e26\u767c\u63a7\u5236\u8207 RPC \u7b49\u9032\u968e\u6280\u8853\u3002</p> <p>\u63d0\u793a\uff1aRPC \u96d6\u7136\u65b9\u4fbf\uff0c\u4f46\u61c9\u907f\u514d\u5728\u9577\u6642\u9593\u4efb\u52d9\u4e2d\u4f7f\u7528\uff0c\u4ee5\u514d\u5f71\u97ff\u7cfb\u7d71\u6548\u80fd\u8207\u97ff\u61c9\u6027\u3002</p>"},{"location":"celery/advanced/task-priority/","title":"\u4efb\u52d9\u512a\u5148\u7d1a","text":"<p>\u4efb\u52d9\u512a\u5148\u7d1a\u662f Celery \u7684\u4e00\u7a2e\u9032\u968e\u529f\u80fd\uff0c\u5141\u8a31\u60a8\u70ba\u4efb\u52d9\u8a2d\u7f6e\u512a\u5148\u7d1a\uff0c\u78ba\u4fdd\u91cd\u8981\u4efb\u52d9\u512a\u5148\u8655\u7406\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u4efb\u52d9\u512a\u5148\u7d1a\u7684\u914d\u7f6e\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/task-priority/#_2","title":"\u4ec0\u9ebc\u662f\u4efb\u52d9\u512a\u5148\u7d1a\uff1f","text":"<p>\u4efb\u52d9\u512a\u5148\u7d1a\u662f\u6307\u901a\u904e\u8a2d\u5b9a\u6578\u503c\u6216\u898f\u5247\uff0c\u63a7\u5236\u4efb\u52d9\u5728\u968a\u5217\u4e2d\u7684\u8655\u7406\u9806\u5e8f\u3002\u9ad8\u512a\u5148\u7d1a\u4efb\u52d9\u6703\u512a\u5148\u88ab\u5de5\u4f5c\u8005\u53d6\u51fa\u57f7\u884c\uff0c\u5f9e\u800c\u6e1b\u5c11\u7b49\u5f85\u6642\u9593\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u78ba\u4fdd\u95dc\u9375\u4efb\u52d9\u512a\u5148\u8655\u7406\uff0c\u63d0\u5347\u7cfb\u7d71\u97ff\u61c9\u6027\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u696d\u52d9\u4e2d\u5b58\u5728\u7dca\u6025\u4efb\u52d9\u6216\u91cd\u8981\u5ba2\u6236\u9700\u6c42\u6642\u3002</li> </ul>"},{"location":"celery/advanced/task-priority/#_3","title":"\u4efb\u52d9\u512a\u5148\u7d1a\u914d\u7f6e","text":"<p>Celery \u652f\u63f4\u901a\u904e\u6d88\u606f\u4ee3\u7406\uff08\u5982 RabbitMQ\uff09\u5be6\u73fe\u4efb\u52d9\u512a\u5148\u7d1a\u3002\u4ee5\u4e0b\u4ee5 RabbitMQ \u70ba\u4f8b\uff0c\u4ecb\u7d39\u914d\u7f6e\u65b9\u6cd5\u3002</p>"},{"location":"celery/advanced/task-priority/#1","title":"\u6b65\u9a5f 1\uff1a\u555f\u7528\u512a\u5148\u7d1a\u968a\u5217","text":"<p>\u5728 RabbitMQ \u4e2d\uff0c\u9700\u70ba\u968a\u5217\u555f\u7528\u512a\u5148\u7d1a\u652f\u63f4\uff08\u6700\u5927\u512a\u5148\u7d1a\u503c\u901a\u5e38\u70ba 0-9\uff09\uff1a <pre><code>from celery import Celery\n\napp = Celery('tasks', broker='amqp://guest:guest@localhost:5672//')\n\n# \u5b9a\u7fa9\u968a\u5217\uff0c\u555f\u7528\u512a\u5148\u7d1a\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n    task_default_queue='default',\n    task_queues={\n        'default': {\n            'exchange': 'default',\n            'routing_key': 'default',\n            'queue_arguments': {'x-max-priority': 10},  # \u652f\u63f4 0-9 \u512a\u5148\u7d1a\n        },\n    },\n)\n</code></pre></p> <ul> <li>x-max-priority\uff1a\u8a2d\u7f6e\u968a\u5217\u652f\u63f4\u7684\u6700\u5927\u512a\u5148\u7d1a\u503c\uff0c\u7bc4\u570d\u901a\u5e38\u70ba 0-9\uff0c\u503c\u8d8a\u5927\u512a\u5148\u7d1a\u8d8a\u9ad8\u3002</li> </ul>"},{"location":"celery/advanced/task-priority/#2","title":"\u6b65\u9a5f 2\uff1a\u8a2d\u7f6e\u4efb\u52d9\u512a\u5148\u7d1a","text":"<p>\u5728\u4efb\u52d9\u8abf\u7528\u6642\uff0c\u901a\u904e <code>apply_async</code> \u6307\u5b9a\u512a\u5148\u7d1a\uff1a <pre><code>from app import critical_task, normal_task  # \u5047\u8a2d\u9019\u4e9b\u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u9ad8\u512a\u5148\u7d1a\u4efb\u52d9\nresult_high = critical_task.apply_async(args=[data], priority=9)\n\n# \u666e\u901a\u512a\u5148\u7d1a\u4efb\u52d9\nresult_normal = normal_task.apply_async(args=[data], priority=0)\n</code></pre></p> <ul> <li>priority\uff1a\u512a\u5148\u7d1a\u503c\uff0c\u503c\u8d8a\u5927\u512a\u5148\u7d1a\u8d8a\u9ad8\uff0c\u7bc4\u570d\u61c9\u8207\u968a\u5217\u914d\u7f6e\u7684 <code>x-max-priority</code> \u4e00\u81f4\u3002</li> </ul>"},{"location":"celery/advanced/task-priority/#3","title":"\u6b65\u9a5f 3\uff1a\u5de5\u4f5c\u8005\u914d\u7f6e","text":"<p>\u78ba\u4fdd\u5de5\u4f5c\u8005\u6b63\u78ba\u8655\u7406\u512a\u5148\u7d1a\u968a\u5217\uff0c\u7121\u9700\u984d\u5916\u914d\u7f6e\uff0cRabbitMQ \u6703\u81ea\u52d5\u6309\u512a\u5148\u7d1a\u5206\u767c\u4efb\u52d9\uff1a <pre><code>celery -A app worker --loglevel=info --queues=default\n</code></pre></p>"},{"location":"celery/advanced/task-priority/#_4","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u7dca\u6025\u4efb\u52d9\u8655\u7406\uff1a\u70ba\u95dc\u9375\u696d\u52d9\u4efb\u52d9\u8a2d\u7f6e\u9ad8\u512a\u5148\u7d1a\uff0c\u78ba\u4fdd\u5feb\u901f\u97ff\u61c9\u3002   <pre><code>emergency_task.apply_async(args=[data], priority=9)\n</code></pre></li> <li>\u5ba2\u6236\u5206\u7d1a\uff1a\u70ba VIP \u5ba2\u6236\u7684\u4efb\u52d9\u8a2d\u7f6e\u9ad8\u512a\u5148\u7d1a\uff0c\u63d0\u5347\u7528\u6236\u9ad4\u9a57\u3002</li> <li>\u8cc7\u6e90\u5206\u914d\uff1a\u5728\u8cc7\u6e90\u6709\u9650\u6642\uff0c\u78ba\u4fdd\u91cd\u8981\u4efb\u52d9\u512a\u5148\u7372\u5f97\u8655\u7406\u3002</li> </ul>"},{"location":"celery/advanced/task-priority/#_5","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6d88\u606f\u4ee3\u7406\u652f\u63f4\uff1a\u4efb\u52d9\u512a\u5148\u7d1a\u4f9d\u8cf4\u6d88\u606f\u4ee3\u7406\u7684\u652f\u63f4\uff0cRabbitMQ \u652f\u63f4\u512a\u5148\u7d1a\u968a\u5217\uff0c\u800c Redis \u7b49\u5176\u4ed6\u4ee3\u7406\u53ef\u80fd\u4e0d\u652f\u63f4\u6216\u9700\u8981\u984d\u5916\u63d2\u4ef6\u3002</li> <li>\u512a\u5148\u7d1a\u7bc4\u570d\uff1a\u78ba\u4fdd\u8a2d\u7f6e\u7684\u512a\u5148\u7d1a\u503c\u4e0d\u8d85\u904e\u968a\u5217\u914d\u7f6e\u7684 <code>x-max-priority</code>\uff0c\u5426\u5247\u53ef\u80fd\u7121\u6548\u3002</li> <li>\u6548\u80fd\u5f71\u97ff\uff1a\u904e\u591a\u9ad8\u512a\u5148\u7d1a\u4efb\u52d9\u53ef\u80fd\u5c0e\u81f4\u4f4e\u512a\u5148\u7d1a\u4efb\u52d9\u9577\u671f\u6392\u968a\uff0c\u9700\u5408\u7406\u8a2d\u8a08\u512a\u5148\u7d1a\u7b56\u7565\u3002</li> </ul>"},{"location":"celery/advanced/task-priority/#_6","title":"\u5c0f\u7d50","text":"<p>\u4efb\u52d9\u512a\u5148\u7d1a\u662f Celery \u78ba\u4fdd\u95dc\u9375\u4efb\u52d9\u5feb\u901f\u8655\u7406\u7684\u91cd\u8981\u529f\u80fd\uff0c\u901a\u904e\u5408\u7406\u8a2d\u7f6e\u512a\u5148\u7d1a\u503c\uff0c\u60a8\u53ef\u4ee5\u512a\u5316\u7cfb\u7d71\u97ff\u61c9\u6027\u8207\u8cc7\u6e90\u5206\u914d\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u4e26\u767c\u63a7\u5236\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u9650\u5236\u5de5\u4f5c\u8005\u4e26\u767c\u4efb\u52d9\u6578\u91cf\u4ee5\u907f\u514d\u8cc7\u6e90\u904e\u8f09\u3002</p> <p>\u63d0\u793a\uff1a\u4efb\u52d9\u512a\u5148\u7d1a\u61c9\u8b39\u614e\u4f7f\u7528\uff0c\u907f\u514d\u904e\u591a\u9ad8\u512a\u5148\u7d1a\u4efb\u52d9\u5c0e\u81f4\u7cfb\u7d71\u4e0d\u5e73\u8861\u3002</p>"},{"location":"celery/advanced/task-routing/","title":"\u4efb\u52d9\u8def\u7531","text":"<p>\u4efb\u52d9\u8def\u7531\u662f Celery \u7684\u4e00\u7a2e\u9032\u968e\u529f\u80fd\uff0c\u5141\u8a31\u60a8\u6839\u64da\u4efb\u52d9\u985e\u578b\u3001\u5c6c\u6027\u6216\u5176\u4ed6\u689d\u4ef6\u5c07\u4efb\u52d9\u5206\u767c\u5230\u7279\u5b9a\u7684\u968a\u5217\u6216\u5de5\u4f5c\u8005\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u4efb\u52d9\u8def\u7531\u7684\u914d\u7f6e\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/task-routing/#_2","title":"\u4ec0\u9ebc\u662f\u4efb\u52d9\u8def\u7531\uff1f","text":"<p>\u4efb\u52d9\u8def\u7531\u662f\u6307\u901a\u904e\u8a2d\u5b9a\u898f\u5247\uff0c\u5c07\u4e0d\u540c\u985e\u578b\u7684\u4efb\u52d9\u767c\u9001\u5230\u4e0d\u540c\u7684\u6d88\u606f\u968a\u5217\uff0c\u9032\u800c\u7531\u7279\u5b9a\u7684\u5de5\u4f5c\u8005\u8655\u7406\u3002\u9019\u6709\u52a9\u65bc\u4efb\u52d9\u5206\u985e\u7ba1\u7406\u8207\u8cc7\u6e90\u5206\u914d\u512a\u5316\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u5c07\u4efb\u52d9\u5206\u767c\u5230\u6307\u5b9a\u968a\u5217\uff0c\u5be6\u73fe\u4efb\u52d9\u5206\u985e\u8207\u5de5\u4f5c\u8005\u5c08\u7528\u5316\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u4e0d\u540c\u4efb\u52d9\u9700\u8981\u4e0d\u540c\u8cc7\u6e90\u6216\u512a\u5148\u7d1a\u6642\uff0c\u5982 CPU \u5bc6\u96c6\u578b\u4efb\u52d9\u8207 I/O \u5bc6\u96c6\u578b\u4efb\u52d9\u5206\u958b\u8655\u7406\u3002</li> </ul>"},{"location":"celery/advanced/task-routing/#_3","title":"\u4efb\u52d9\u8def\u7531\u57fa\u672c\u914d\u7f6e","text":"<p>Celery \u652f\u63f4\u901a\u904e\u914d\u7f6e\u6587\u4ef6\u6216\u4efb\u52d9\u88dd\u98fe\u5668\u6307\u5b9a\u4efb\u52d9\u8def\u7531\u898f\u5247\u3002\u4ee5\u4e0b\u4ee5 RabbitMQ \u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\u70ba\u4f8b\u3002</p>"},{"location":"celery/advanced/task-routing/#1","title":"\u6b65\u9a5f 1\uff1a\u5b9a\u7fa9\u968a\u5217\u8207\u8def\u7531\u898f\u5247","text":"<p>\u5728 Celery \u61c9\u7528\u914d\u7f6e\u4e2d\u5b9a\u7fa9\u968a\u5217\u8207\u8def\u7531\u898f\u5247\uff1a <pre><code>from celery import Celery\n\napp = Celery('tasks', broker='amqp://guest:guest@localhost:5672//')\n\n# \u5b9a\u7fa9\u968a\u5217\u8207\u8def\u7531\u898f\u5247\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n    task_default_queue='default',  # \u9810\u8a2d\u968a\u5217\n    task_queues={\n        'default': {'exchange': 'default', 'routing_key': 'default'},\n        'cpu_intensive': {'exchange': 'tasks', 'routing_key': 'cpu_intensive'},\n        'io_intensive': {'exchange': 'tasks', 'routing_key': 'io_intensive'},\n    },\n    task_routes={\n        'app.cpu_task': {'queue': 'cpu_intensive'},\n        'app.io_task': {'queue': 'io_intensive'},\n    },\n)\n</code></pre></p> <ul> <li>task_queues\uff1a\u5b9a\u7fa9\u591a\u500b\u968a\u5217\u53ca\u5176\u4ea4\u63db\u6a5f\u8207\u8def\u7531\u9375\u3002</li> <li>task_routes\uff1a\u6307\u5b9a\u4efb\u52d9\u5230\u968a\u5217\u7684\u6620\u5c04\u898f\u5247\u3002</li> </ul>"},{"location":"celery/advanced/task-routing/#2","title":"\u6b65\u9a5f 2\uff1a\u5b9a\u7fa9\u4efb\u52d9\u8207\u8def\u7531","text":"<p>\u5728\u4efb\u52d9\u5b9a\u7fa9\u6642\uff0c\u53ef\u4ee5\u901a\u904e\u88dd\u98fe\u5668\u6307\u5b9a\u968a\u5217\uff0c\u4e5f\u53ef\u4f9d\u8cf4\u914d\u7f6e\u4e2d\u7684\u8def\u7531\u898f\u5247\uff1a <pre><code>@app.task(queue='cpu_intensive')\ndef cpu_task(data):\n    # CPU \u5bc6\u96c6\u578b\u4efb\u52d9\n    return heavy_computation(data)\n\n@app.task\ndef io_task(data):\n    # I/O \u5bc6\u96c6\u578b\u4efb\u52d9\uff0c\u4f9d\u8cf4\u914d\u7f6e\u8def\u7531\u5230 io_intensive \u968a\u5217\n    return fetch_data_from_network(data)\n</code></pre></p>"},{"location":"celery/advanced/task-routing/#3","title":"\u6b65\u9a5f 3\uff1a\u555f\u52d5\u5c08\u7528\u5de5\u4f5c\u8005","text":"<p>\u70ba\u4e0d\u540c\u968a\u5217\u555f\u52d5\u5c08\u7528\u5de5\u4f5c\u8005\uff0c\u78ba\u4fdd\u4efb\u52d9\u7531\u5408\u9069\u7684\u5de5\u4f5c\u8005\u8655\u7406\uff1a <pre><code># \u8655\u7406 cpu_intensive \u968a\u5217\u7684\u5de5\u4f5c\u8005\ncelery -A app worker --loglevel=info --queues=cpu_intensive\n\n# \u8655\u7406 io_intensive \u968a\u5217\u7684\u5de5\u4f5c\u8005\ncelery -A app worker --loglevel=info --queues=io_intensive\n\n# \u8655\u7406\u9810\u8a2d\u968a\u5217\u7684\u5de5\u4f5c\u8005\ncelery -A app worker --loglevel=info --queues=default\n</code></pre></p> <ul> <li>--queues\uff1a\u6307\u5b9a\u5de5\u4f5c\u8005\u76e3\u807d\u7684\u968a\u5217\u540d\u7a31\u3002</li> </ul>"},{"location":"celery/advanced/task-routing/#_4","title":"\u52d5\u614b\u8def\u7531","text":"<p>\u9664\u4e86\u975c\u614b\u914d\u7f6e\uff0c\u60a8\u4e5f\u53ef\u4ee5\u5728\u4efb\u52d9\u8abf\u7528\u6642\u52d5\u614b\u6307\u5b9a\u968a\u5217\uff1a <pre><code># \u52d5\u614b\u6307\u5b9a\u968a\u5217\nresult = cpu_task.apply_async(args=[data], queue='high_priority_cpu')\n</code></pre></p>"},{"location":"celery/advanced/task-routing/#_5","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u4efb\u52d9\u5206\u985e\uff1a\u5c07 CPU \u5bc6\u96c6\u578b\u4efb\u52d9\u8207 I/O \u5bc6\u96c6\u578b\u4efb\u52d9\u5206\u958b\uff0c\u907f\u514d\u8cc7\u6e90\u722d\u7528\u3002</li> <li>\u512a\u5148\u7d1a\u8655\u7406\uff1a\u70ba\u9ad8\u512a\u5148\u7d1a\u4efb\u52d9\u5206\u914d\u5c08\u7528\u968a\u5217\u8207\u5de5\u4f5c\u8005\u3002</li> <li>\u5730\u7406\u5206\u4f48\uff1a\u5c07\u4efb\u52d9\u8def\u7531\u5230\u7279\u5b9a\u5340\u57df\u7684\u5de5\u4f5c\u8005\uff0c\u6e1b\u5c11\u5ef6\u9072\u3002</li> </ul>"},{"location":"celery/advanced/task-routing/#_6","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u968a\u5217\u7ba1\u7406\uff1a\u78ba\u4fdd\u968a\u5217\u8207\u5de5\u4f5c\u8005\u5339\u914d\uff0c\u5426\u5247\u4efb\u52d9\u53ef\u80fd\u5806\u7a4d\u3002</li> <li>\u6d88\u606f\u4ee3\u7406\u652f\u63f4\uff1a\u4e0d\u540c\u6d88\u606f\u4ee3\u7406\uff08\u5982 RabbitMQ\u3001Redis\uff09\u5c0d\u8def\u7531\u529f\u80fd\u7684\u652f\u63f4\u6709\u6240\u4e0d\u540c\uff0cRabbitMQ \u63d0\u4f9b\u66f4\u8c50\u5bcc\u7684\u4ea4\u63db\u6a5f\u985e\u578b\u3002</li> <li>\u914d\u7f6e\u4e00\u81f4\u6027\uff1a\u6240\u6709 Celery \u5be6\u4f8b\uff08\u751f\u7522\u8005\u8207\u5de5\u4f5c\u8005\uff09\u61c9\u4f7f\u7528\u76f8\u540c\u7684\u8def\u7531\u914d\u7f6e\uff0c\u907f\u514d\u4efb\u52d9\u4e1f\u5931\u3002</li> </ul>"},{"location":"celery/advanced/task-routing/#_7","title":"\u5c0f\u7d50","text":"<p>\u4efb\u52d9\u8def\u7531\u662f Celery \u5be6\u73fe\u4efb\u52d9\u5206\u985e\u8207\u8cc7\u6e90\u512a\u5316\u7684\u91cd\u8981\u529f\u80fd\uff0c\u901a\u904e\u5408\u7406\u914d\u7f6e\u968a\u5217\u8207\u8def\u7531\u898f\u5247\uff0c\u60a8\u53ef\u4ee5\u63d0\u5347\u7cfb\u7d71\u7684\u53ef\u64f4\u5c55\u6027\u8207\u6548\u7387\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u4efb\u52d9\u512a\u5148\u7d1a\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u78ba\u4fdd\u91cd\u8981\u4efb\u52d9\u512a\u5148\u8655\u7406\u3002</p> <p>\u63d0\u793a\uff1a\u4efb\u52d9\u8def\u7531\u61c9\u6839\u64da\u5be6\u969b\u696d\u52d9\u9700\u6c42\u8207\u7cfb\u7d71\u67b6\u69cb\u8a2d\u8a08\uff0c\u907f\u514d\u904e\u591a\u968a\u5217\u5c0e\u81f4\u7ba1\u7406\u8907\u96dc\u6027\u589e\u52a0\u3002</p>"},{"location":"celery/advanced/canvas/","title":"\u5de5\u4f5c\u6d41\uff08Canvas\uff09\u6982\u8ff0","text":"<p>Celery \u7684 Canvas \u6a21\u7d44\u63d0\u4f9b\u4e86\u4e00\u7d44\u5de5\u5177\uff0c\u7528\u65bc\u7de8\u6392\u8907\u96dc\u7684\u4efb\u52d9\u5de5\u4f5c\u6d41\uff0c\u5141\u8a31\u60a8\u5b9a\u7fa9\u4efb\u52d9\u4e4b\u9593\u7684\u4f9d\u8cf4\u95dc\u4fc2\u8207\u57f7\u884c\u9806\u5e8f\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Canvas \u7684\u57fa\u672c\u6982\u5ff5\u8207\u529f\u80fd\uff0c\u5f8c\u7e8c\u6587\u7ae0\u5c07\u6df1\u5165\u5404\u500b\u5de5\u5177\u7684\u5177\u9ad4\u7528\u6cd5\u3002</p>"},{"location":"celery/advanced/canvas/#canvas_1","title":"\u4ec0\u9ebc\u662f Canvas\uff1f","text":"<p>Canvas \u662f Celery \u63d0\u4f9b\u7684\u4e00\u7d44\u9ad8\u7d1a\u539f\u8a9e\uff08Primitives\uff09\uff0c\u7528\u65bc\u7d44\u5408\u8207\u7de8\u6392\u4efb\u52d9\uff0c\u5be6\u73fe\u8907\u96dc\u7684\u5de5\u4f5c\u6d41\u3002\u5b83\u5141\u8a31\u60a8\u5c07\u591a\u500b\u4efb\u52d9\u7d44\u7e54\u6210\u6709\u7d50\u69cb\u7684\u57f7\u884c\u6d41\u7a0b\uff0c\u6eff\u8db3\u696d\u52d9\u908f\u8f2f\u4e2d\u7684\u9806\u5e8f\u3001\u4e26\u884c\u6216\u689d\u4ef6\u57f7\u884c\u9700\u6c42\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u4efb\u52d9\u7de8\u6392\u8207\u6d41\u7a0b\u63a7\u5236\u3002</li> <li>\u6838\u5fc3\u5de5\u5177\uff1a</li> <li>Chain\uff1a\u6309\u9806\u5e8f\u57f7\u884c\u4e00\u7cfb\u5217\u4efb\u52d9\u3002</li> <li>Group\uff1a\u4e26\u884c\u57f7\u884c\u4e00\u7d44\u4efb\u52d9\u3002</li> <li>Chord\uff1a\u5728\u4e26\u884c\u4efb\u52d9\u5b8c\u6210\u5f8c\u57f7\u884c\u56de\u8abf\u4efb\u52d9\u3002</li> <li>Map &amp; Starmap\uff1a\u5c0d\u6578\u64da\u96c6\u61c9\u7528\u4efb\u52d9\uff0c\u985e\u4f3c\u65bc Python \u7684 <code>map</code> \u51fd\u6578\u3002</li> </ul>"},{"location":"celery/advanced/canvas/#canvas_2","title":"\u70ba\u4ec0\u9ebc\u9700\u8981 Canvas\uff1f","text":"<p>\u5728\u5be6\u969b\u61c9\u7528\u4e2d\uff0c\u55ae\u4e00\u4efb\u52d9\u5f80\u5f80\u7121\u6cd5\u6eff\u8db3\u8907\u96dc\u9700\u6c42\u3002\u4f8b\u5982\uff1a - \u8655\u7406\u8a02\u55ae\u6642\uff0c\u9700\u5148\u9a57\u8b49\u6578\u64da\u3001\u518d\u66f4\u65b0\u5eab\u5b58\u3001\u6700\u5f8c\u767c\u9001\u901a\u77e5\uff08\u9806\u5e8f\u57f7\u884c\uff09\u3002 - \u6279\u91cf\u8655\u7406\u591a\u500b\u7528\u6236\u6578\u64da\u6642\uff0c\u9700\u4e26\u884c\u8655\u7406\u4ee5\u63d0\u5347\u6548\u7387\uff08\u4e26\u884c\u57f7\u884c\uff09\u3002 - \u5728\u591a\u500b\u5b50\u4efb\u52d9\u5b8c\u6210\u5f8c\uff0c\u9700\u532f\u7e3d\u7d50\u679c\u9032\u884c\u5f8c\u7e8c\u8655\u7406\uff08\u4e26\u884c\u5f8c\u56de\u8abf\uff09\u3002</p> <p>Canvas \u5de5\u5177\u901a\u904e\u7d50\u69cb\u5316\u65b9\u5f0f\u89e3\u6c7a\u9019\u4e9b\u554f\u984c\uff0c\u8b93\u4efb\u52d9\u57f7\u884c\u66f4\u52a0\u9748\u6d3b\u8207\u53ef\u63a7\u3002</p>"},{"location":"celery/advanced/canvas/#canvas_3","title":"Canvas \u57fa\u672c\u7528\u6cd5","text":"<p>Canvas \u5de5\u5177\u901a\u904e Celery \u63d0\u4f9b\u7684\u51fd\u6578\u6216\u65b9\u6cd5\u7d44\u5408\u4efb\u52d9\uff0c\u751f\u6210\u4e00\u500b\u53ef\u57f7\u884c\u7684\u6d41\u7a0b\u3002\u4ee5\u4e0b\u662f\u7c21\u55ae\u793a\u4f8b\uff1a</p>"},{"location":"celery/advanced/canvas/#_1","title":"\u793a\u4f8b\uff1a\u7d44\u5408\u4efb\u52d9","text":"<pre><code>from celery import chain, group\nfrom app import task1, task2, task3  # \u5047\u8a2d\u9019\u4e9b\u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u5b9a\u7fa9\u9806\u5e8f\u57f7\u884c\u7684\u5de5\u4f5c\u6d41\nworkflow = chain(task1.s(), task2.s(), task3.s())\nresult = workflow.delay()\n\n# \u5b9a\u7fa9\u4e26\u884c\u57f7\u884c\u7684\u5de5\u4f5c\u6d41\nparallel_workflow = group(task1.s(), task2.s(), task3.s())\nresult = parallel_workflow.delay()\n</code></pre> <ul> <li><code>.s()</code>\uff1a\u751f\u6210\u4efb\u52d9\u7684\u7c3d\u540d\uff08Signature\uff09\uff0c\u7528\u65bc Canvas \u7d44\u5408\uff0c\u4e0d\u76f4\u63a5\u57f7\u884c\u3002</li> <li><code>.delay()</code>\uff1a\u555f\u52d5\u5de5\u4f5c\u6d41\uff0c\u5c07\u5176\u767c\u9001\u5230\u968a\u5217\u57f7\u884c\u3002</li> </ul>"},{"location":"celery/advanced/canvas/#_2","title":"\u5c0f\u7d50","text":"<p>Canvas \u662f Celery \u5be6\u73fe\u8907\u96dc\u4efb\u52d9\u5de5\u4f5c\u6d41\u7684\u95dc\u9375\u5de5\u5177\uff0c\u901a\u904e Chain\u3001Group\u3001Chord \u7b49\u539f\u8a9e\uff0c\u60a8\u53ef\u4ee5\u9748\u6d3b\u7de8\u6392\u4efb\u52d9\u57f7\u884c\u9806\u5e8f\u8207\u95dc\u4fc2\u3002\u63a5\u4e0b\u4f86\u7684\u6587\u7ae0\u5c07\u9010\u4e00\u4ecb\u7d39\u9019\u4e9b\u5de5\u5177\u7684\u5177\u9ad4\u7528\u6cd5\u8207\u61c9\u7528\u5834\u666f\u3002</p> <p>\u63d0\u793a\uff1a\u4f7f\u7528 Canvas \u6642\uff0c\u78ba\u4fdd\u4efb\u52d9\u4e4b\u9593\u7684\u4f9d\u8cf4\u95dc\u4fc2\u6e05\u6670\uff0c\u907f\u514d\u904e\u65bc\u8907\u96dc\u7684\u5d4c\u5957\u7d50\u69cb\u5c0e\u81f4\u8abf\u8a66\u56f0\u96e3\u3002</p>"},{"location":"celery/advanced/canvas/chain/","title":"Chain\uff1a\u9806\u5e8f\u57f7\u884c","text":"<p>Chain \u662f Celery Canvas \u4e2d\u7684\u4e00\u7a2e\u5de5\u5177\uff0c\u7528\u65bc\u6309\u9806\u5e8f\u57f7\u884c\u4e00\u7cfb\u5217\u4efb\u52d9\uff0c\u524d\u4e00\u500b\u4efb\u52d9\u7684\u7d50\u679c\u53ef\u4f5c\u70ba\u5f8c\u4e00\u500b\u4efb\u52d9\u7684\u8f38\u5165\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Chain \u7684\u7528\u6cd5\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/canvas/chain/#chain_1","title":"\u4ec0\u9ebc\u662f Chain\uff1f","text":"<p>Chain \u5141\u8a31\u60a8\u5c07\u591a\u500b\u4efb\u52d9\u4e32\u806f\u6210\u4e00\u500b\u9806\u5e8f\u57f7\u884c\u7684\u5de5\u4f5c\u6d41\uff0c\u78ba\u4fdd\u4efb\u52d9\u6309\u6307\u5b9a\u9806\u5e8f\u5b8c\u6210\u3002\u6bcf\u500b\u4efb\u52d9\u7684\u8f38\u51fa\u53ef\u4ee5\u50b3\u905e\u7d66\u4e0b\u4e00\u500b\u4efb\u52d9\uff0c\u5f62\u6210\u7ba1\u9053\u5f0f\u8655\u7406\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u6309\u9806\u5e8f\u57f7\u884c\u4efb\u52d9\uff0c\u652f\u63f4\u7d50\u679c\u50b3\u905e\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u696d\u52d9\u6d41\u7a0b\u4e2d\u9700\u8981\u56b4\u683c\u9806\u5e8f\u7684\u5834\u666f\uff0c\u5982\u6578\u64da\u8655\u7406\u7ba1\u9053\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chain/#chain_2","title":"Chain \u57fa\u672c\u7528\u6cd5","text":"<p>\u4f7f\u7528 <code>chain</code> \u51fd\u6578\u6216 <code>|</code> \u64cd\u4f5c\u7b26\u7d44\u5408\u4efb\u52d9\uff1a</p>"},{"location":"celery/advanced/canvas/chain/#chain_3","title":"\u793a\u4f8b\uff1a\u57fa\u672c Chain","text":"<pre><code>from celery import chain\nfrom app import validate_data, process_data, save_result  # \u5047\u8a2d\u9019\u4e9b\u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u5b9a\u7fa9 Chain \u5de5\u4f5c\u6d41\nworkflow = chain(validate_data.s(), process_data.s(), save_result.s())\n\n# \u57f7\u884c\u5de5\u4f5c\u6d41\nresult = workflow.delay()\nprint(\"Workflow started, ID:\", result.id)\n</code></pre> <ul> <li><code>.s()</code>\uff1a\u751f\u6210\u4efb\u52d9\u7c3d\u540d\uff0c\u7528\u65bc\u7d44\u5408\u3002</li> <li>\u9806\u5e8f\uff1a\u4efb\u52d9\u6309\u5b9a\u7fa9\u9806\u5e8f\u57f7\u884c\uff0c<code>validate_data</code> \u5b8c\u6210\u5f8c\u57f7\u884c <code>process_data</code>\uff0c\u6700\u5f8c\u57f7\u884c <code>save_result</code>\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chain/#_1","title":"\u793a\u4f8b\uff1a\u4f7f\u7528 <code>|</code> \u64cd\u4f5c\u7b26","text":"<pre><code># \u4f7f\u7528 | \u64cd\u4f5c\u7b26\u5b9a\u7fa9 Chain\nworkflow = validate_data.s() | process_data.s() | save_result.s()\nresult = workflow.delay()\n</code></pre>"},{"location":"celery/advanced/canvas/chain/#_2","title":"\u7d50\u679c\u50b3\u905e","text":"<p>Chain \u652f\u63f4\u5c07\u524d\u4e00\u4efb\u52d9\u7684\u7d50\u679c\u4f5c\u70ba\u5f8c\u4e00\u4efb\u52d9\u7684\u53c3\u6578\uff1a</p>"},{"location":"celery/advanced/canvas/chain/#_3","title":"\u793a\u4f8b\uff1a\u7d50\u679c\u50b3\u905e","text":"<pre><code>@app.task\ndef step1():\n    return 42\n\n@app.task\ndef step2(data):\n    return data * 2\n\n@app.task\ndef step3(data):\n    return f\"Final result: {data}\"\n\n# \u5b9a\u7fa9 Chain\uff0c\u7d50\u679c\u81ea\u52d5\u50b3\u905e\nworkflow = chain(step1.s(), step2.s(), step3.s())\nresult = workflow.delay()\n\n# \u7b49\u5f85\u7d50\u679c\nprint(\"Result:\", result.get())\n</code></pre>"},{"location":"celery/advanced/canvas/chain/#_4","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u8a02\u55ae\u8655\u7406\uff1a\u9a57\u8b49\u8a02\u55ae\u6578\u64da \u2192 \u66f4\u65b0\u5eab\u5b58 \u2192 \u767c\u9001\u901a\u77e5\u3002   <pre><code>workflow = chain(validate_order.s(), update_inventory.s(), send_notification.s())\nworkflow.delay(order_data)\n</code></pre></li> <li>\u6578\u64da\u8655\u7406\u7ba1\u9053\uff1a\u8b80\u53d6\u6578\u64da \u2192 \u6e05\u6d17\u6578\u64da \u2192 \u5b58\u5132\u7d50\u679c\u3002</li> <li>\u591a\u6b65\u8a08\u7b97\uff1a\u9010\u6b65\u8655\u7406\u8907\u96dc\u8a08\u7b97\u4efb\u52d9\uff0c\u6bcf\u6b65\u4f9d\u8cf4\u524d\u4e00\u6b65\u7d50\u679c\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chain/#_5","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u932f\u8aa4\u8655\u7406\uff1a\u82e5 Chain \u4e2d\u67d0\u500b\u4efb\u52d9\u5931\u6557\uff0c\u5f8c\u7e8c\u4efb\u52d9\u5c07\u4e0d\u6703\u57f7\u884c\u3002\u5efa\u8b70\u5728\u4efb\u52d9\u5167\u6355\u7372\u7570\u5e38\u6216\u4f7f\u7528\u91cd\u8a66\u6a5f\u5236\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1a\u78ba\u4fdd\u914d\u7f6e\u7d50\u679c\u5f8c\u7aef\u4ee5\u5b58\u5132\u4e2d\u9593\u7d50\u679c\uff0c\u5426\u5247\u7121\u6cd5\u7372\u53d6\u5b8c\u6574\u5de5\u4f5c\u6d41\u7d50\u679c\u3002</li> <li>\u57f7\u884c\u6642\u9593\uff1aChain \u7e3d\u57f7\u884c\u6642\u9593\u662f\u5404\u4efb\u52d9\u57f7\u884c\u6642\u9593\u4e4b\u548c\uff0c\u9069\u5408\u975e\u7dca\u6025\u4efb\u52d9\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chain/#_6","title":"\u5c0f\u7d50","text":"<p>Chain \u662f Celery Canvas \u4e2d\u7528\u65bc\u9806\u5e8f\u57f7\u884c\u4efb\u52d9\u7684\u7c21\u55ae\u800c\u5f37\u5927\u7684\u5de5\u5177\uff0c\u7279\u5225\u9069\u5408\u9700\u8981\u56b4\u683c\u9806\u5e8f\u7684\u696d\u52d9\u6d41\u7a0b\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cGroup\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u4e26\u884c\u57f7\u884c\u591a\u500b\u4efb\u52d9\u3002</p> <p>\u63d0\u793a\uff1a\u4f7f\u7528 Chain \u6642\uff0c\u78ba\u4fdd\u6bcf\u500b\u4efb\u52d9\u7684\u8f38\u5165\u8f38\u51fa\u683c\u5f0f\u4e00\u81f4\uff0c\u4ee5\u4fbf\u9806\u5229\u50b3\u905e\u7d50\u679c\u3002</p>"},{"location":"celery/advanced/canvas/chord/","title":"Chord\uff1a\u4e26\u884c\u5f8c\u56de\u8abf","text":"<p>Chord \u662f Celery Canvas \u4e2d\u7684\u4e00\u7a2e\u5de5\u5177\uff0c\u7528\u65bc\u5728\u4e26\u884c\u57f7\u884c\u4e00\u7d44\u4efb\u52d9\u5f8c\uff0c\u57f7\u884c\u4e00\u500b\u56de\u8abf\u4efb\u52d9\u4f86\u8655\u7406\u6240\u6709\u7d50\u679c\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Chord \u7684\u7528\u6cd5\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/canvas/chord/#chord_1","title":"\u4ec0\u9ebc\u662f Chord\uff1f","text":"<p>Chord \u662f\u4e00\u7a2e\u7d50\u5408 Group \u8207\u56de\u8abf\u4efb\u52d9\u7684\u5de5\u4f5c\u6d41\u5de5\u5177\u3002\u5b83\u9996\u5148\u4e26\u884c\u57f7\u884c\u4e00\u7d44\u4efb\u52d9\uff08\u985e\u4f3c Group\uff09\uff0c\u7136\u5f8c\u5728\u6240\u6709\u4efb\u52d9\u5b8c\u6210\u5f8c\uff0c\u5c07\u7d50\u679c\u50b3\u905e\u7d66\u6307\u5b9a\u7684\u56de\u8abf\u4efb\u52d9\u9032\u884c\u8655\u7406\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u4e26\u884c\u57f7\u884c\u4efb\u52d9\u5f8c\u9032\u884c\u7d50\u679c\u532f\u7e3d\u6216\u5f8c\u7e8c\u8655\u7406\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u6279\u91cf\u8655\u7406\u5f8c\u9700\u8981\u532f\u7e3d\u7d50\u679c\u7684\u5834\u666f\uff0c\u5982\u5206\u6563\u5f0f\u8a08\u7b97\u5f8c\u7d71\u8a08\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chord/#chord_2","title":"Chord \u57fa\u672c\u7528\u6cd5","text":"<p>\u4f7f\u7528 <code>chord</code> \u51fd\u6578\u5275\u5efa\u5de5\u4f5c\u6d41\uff0c\u6307\u5b9a\u4e26\u884c\u4efb\u52d9\u7d44\u8207\u56de\u8abf\u4efb\u52d9\uff1a</p>"},{"location":"celery/advanced/canvas/chord/#chord_3","title":"\u793a\u4f8b\uff1a\u57fa\u672c Chord","text":"<pre><code>from celery import chord, group\nfrom app import process_chunk, aggregate_results  # \u5047\u8a2d\u9019\u4e9b\u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u5b9a\u7fa9\u4e26\u884c\u4efb\u52d9\u7d44\ndata_chunks = [1, 2, 3, 4, 5]\nparallel_tasks = group(process_chunk.s(chunk) for chunk in data_chunks)\n\n# \u5b9a\u7fa9 Chord \u5de5\u4f5c\u6d41\uff1a\u4e26\u884c\u4efb\u52d9\u5b8c\u6210\u5f8c\u57f7\u884c\u56de\u8abf\nworkflow = chord(parallel_tasks)(aggregate_results.s())\n\n# \u57f7\u884c\u5de5\u4f5c\u6d41\nresult = workflow.delay()\nprint(\"Chord started, ID:\", result.id)\n\n# \u7b49\u5f85\u7d50\u679c\uff08\u56de\u8abf\u4efb\u52d9\u7684\u7d50\u679c\uff09\nprint(\"Final result:\", result.get())\n</code></pre> <ul> <li>\u4e26\u884c\u4efb\u52d9\uff1a<code>process_chunk</code> \u4efb\u52d9\u4e26\u884c\u8655\u7406\u6bcf\u500b\u6578\u64da\u584a\u3002</li> <li>\u56de\u8abf\u4efb\u52d9\uff1a<code>aggregate_results</code> \u63a5\u6536\u6240\u6709\u4e26\u884c\u4efb\u52d9\u7684\u7d50\u679c\uff08\u4f5c\u70ba\u5217\u8868\uff09\u9032\u884c\u8655\u7406\u3002</li> <li>\u7d50\u679c\uff1a\u6700\u7d42\u7d50\u679c\u662f\u56de\u8abf\u4efb\u52d9\u7684\u8fd4\u56de\u503c\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chord/#_1","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u5206\u6563\u5f0f\u8a08\u7b97\uff1a\u5c07\u5927\u6578\u64da\u96c6\u5206\u584a\u4e26\u884c\u8655\u7406\uff0c\u7136\u5f8c\u532f\u7e3d\u7d50\u679c\u3002   <pre><code>workflow = chord(group(compute_chunk.s(chunk) for chunk in chunks))(sum_results.s())\nworkflow.delay()\n</code></pre></li> <li>\u6279\u91cf\u66f4\u65b0\u5f8c\u901a\u77e5\uff1a\u4e26\u884c\u66f4\u65b0\u591a\u500b\u8a18\u9304\uff0c\u5b8c\u6210\u5f8c\u767c\u9001\u7e3d\u7d50\u901a\u77e5\u3002</li> <li>\u591a\u4efb\u52d9\u7d50\u679c\u8655\u7406\uff1a\u4e26\u884c\u57f7\u884c\u591a\u500b API \u8abf\u7528\uff0c\u7136\u5f8c\u5206\u6790\u6240\u6709\u97ff\u61c9\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chord/#_2","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u56de\u8abf\u4f9d\u8cf4\uff1a\u56de\u8abf\u4efb\u52d9\u50c5\u5728\u6240\u6709\u4e26\u884c\u4efb\u52d9\u6210\u529f\u5b8c\u6210\u5f8c\u57f7\u884c\uff0c\u82e5\u6709\u4efb\u52d9\u5931\u6557\uff0c\u9700\u59a5\u5584\u8655\u7406\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1aChord \u4f9d\u8cf4\u7d50\u679c\u5f8c\u7aef\u5b58\u5132\u4e2d\u9593\u7d50\u679c\uff0c\u78ba\u4fdd\u914d\u7f6e\u6b63\u78ba\u3002</li> <li>\u6548\u80fd\u8003\u91cf\uff1a\u4e26\u884c\u4efb\u52d9\u6578\u91cf\u8207\u56de\u8abf\u4efb\u52d9\u7684\u8655\u7406\u6642\u9593\u6703\u5f71\u97ff\u6574\u9ad4\u57f7\u884c\u6642\u9593\u3002</li> </ul>"},{"location":"celery/advanced/canvas/chord/#_3","title":"\u5c0f\u7d50","text":"<p>Chord \u662f Celery Canvas \u4e2d\u7528\u65bc\u4e26\u884c\u4efb\u52d9\u5f8c\u57f7\u884c\u56de\u8abf\u7684\u5de5\u5177\uff0c\u7279\u5225\u9069\u5408\u9700\u8981\u532f\u7e3d\u7d50\u679c\u7684\u5834\u666f\u3002\u901a\u904e Chord\uff0c\u60a8\u53ef\u4ee5\u5be6\u73fe\u9ad8\u6548\u7684\u5206\u6563\u5f0f\u8655\u7406\u8207\u7d50\u679c\u6574\u5408\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cMap &amp; Starmap\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u5c0d\u6578\u64da\u96c6\u61c9\u7528\u4efb\u52d9\u3002</p> <p>\u63d0\u793a\uff1a\u4f7f\u7528 Chord \u6642\uff0c\u78ba\u4fdd\u56de\u8abf\u4efb\u52d9\u80fd\u8655\u7406\u4e26\u884c\u4efb\u52d9\u7684\u6240\u6709\u7d50\u679c\uff0c\u4e26\u8003\u616e\u7570\u5e38\u60c5\u6cc1\u4e0b\u7684\u932f\u8aa4\u8655\u7406\u3002</p>"},{"location":"celery/advanced/canvas/group/","title":"Group\uff1a\u4e26\u884c\u57f7\u884c","text":"<p>Group \u662f Celery Canvas \u4e2d\u7684\u4e00\u7a2e\u5de5\u5177\uff0c\u7528\u65bc\u4e26\u884c\u57f7\u884c\u4e00\u7d44\u4efb\u52d9\uff0c\u9069\u5408\u9700\u8981\u540c\u6642\u8655\u7406\u591a\u500b\u7368\u7acb\u4efb\u52d9\u7684\u5834\u666f\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Group \u7684\u7528\u6cd5\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/canvas/group/#group_1","title":"\u4ec0\u9ebc\u662f Group\uff1f","text":"<p>Group \u5141\u8a31\u60a8\u5c07\u591a\u500b\u4efb\u52d9\u7d44\u6210\u4e00\u500b\u7d44\uff0c\u9019\u4e9b\u4efb\u52d9\u5c07\u4e26\u884c\u57f7\u884c\uff0c\u4e92\u4e0d\u4f9d\u8cf4\u3002Group \u6703\u7b49\u5f85\u6240\u6709\u4efb\u52d9\u5b8c\u6210\u5f8c\u8fd4\u56de\u7d50\u679c\u96c6\u5408\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u4e26\u884c\u57f7\u884c\u591a\u500b\u4efb\u52d9\uff0c\u63d0\u5347\u8655\u7406\u6548\u7387\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u6279\u91cf\u8655\u7406\u7368\u7acb\u6578\u64da\u6216\u57f7\u884c\u7121\u4f9d\u8cf4\u95dc\u4fc2\u7684\u4efb\u52d9\u3002</li> </ul>"},{"location":"celery/advanced/canvas/group/#group_2","title":"Group \u57fa\u672c\u7528\u6cd5","text":"<p>\u4f7f\u7528 <code>group</code> \u51fd\u6578\u5275\u5efa\u4e26\u884c\u4efb\u52d9\u7d44\uff1a</p>"},{"location":"celery/advanced/canvas/group/#group_3","title":"\u793a\u4f8b\uff1a\u57fa\u672c Group","text":"<pre><code>from celery import group\nfrom app import process_user_data  # \u5047\u8a2d\u9019\u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u5b9a\u7fa9 Group \u5de5\u4f5c\u6d41\nuser_ids = [1, 2, 3, 4, 5]\nworkflow = group(process_user_data.s(user_id) for user_id in user_ids)\n\n# \u57f7\u884c\u5de5\u4f5c\u6d41\nresult = workflow.delay()\nprint(\"Group started, ID:\", result.id)\n\n# \u7b49\u5f85\u7d50\u679c\nprint(\"Results:\", result.get())\n</code></pre> <ul> <li>\u4e26\u884c\u57f7\u884c\uff1a\u6bcf\u500b <code>process_user_data</code> \u4efb\u52d9\u7368\u7acb\u57f7\u884c\uff0c\u4e92\u4e0d\u5f71\u97ff\u3002</li> <li>\u7d50\u679c\u96c6\u5408\uff1a<code>result.get()</code> \u8fd4\u56de\u6240\u6709\u4efb\u52d9\u7d50\u679c\u7684\u5217\u8868\u3002</li> </ul>"},{"location":"celery/advanced/canvas/group/#_1","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u6279\u91cf\u7528\u6236\u8655\u7406\uff1a\u540c\u6642\u8655\u7406\u591a\u500b\u7528\u6236\u7684\u6578\u64da\uff0c\u5982\u767c\u9001\u6279\u91cf\u90f5\u4ef6\u3002   <pre><code>workflow = group(send_email.s(email) for email in email_list)\nworkflow.delay()\n</code></pre></li> <li>\u4e26\u884c\u8a08\u7b97\uff1a\u5c0d\u591a\u500b\u6578\u64da\u584a\u9032\u884c\u7368\u7acb\u8a08\u7b97\uff0c\u63d0\u5347\u8655\u7406\u901f\u5ea6\u3002</li> <li>\u591a\u670d\u52d9\u8abf\u7528\uff1a\u540c\u6642\u5411\u591a\u500b\u5916\u90e8 API \u767c\u9001\u8acb\u6c42\uff0c\u6536\u96c6\u7d50\u679c\u3002</li> </ul>"},{"location":"celery/advanced/canvas/group/#_2","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u8cc7\u6e90\u9650\u5236\uff1a\u4e26\u884c\u4efb\u52d9\u53ef\u80fd\u5c0e\u81f4\u8cc7\u6e90\u722d\u7528\uff0c\u9700\u6839\u64da\u7cfb\u7d71\u80fd\u529b\u8abf\u6574 Group \u5927\u5c0f\u3002</li> <li>\u932f\u8aa4\u8655\u7406\uff1a\u82e5\u67d0\u500b\u4efb\u52d9\u5931\u6557\uff0cGroup \u4ecd\u6703\u7b49\u5f85\u5176\u4ed6\u4efb\u52d9\u5b8c\u6210\uff0c\u4f46\u6574\u9ad4\u7d50\u679c\u53ef\u80fd\u5305\u542b\u7570\u5e38\u3002\u5efa\u8b70\u6aa2\u67e5\u7d50\u679c\uff1a   <pre><code>results = result.get(propagate=False)\nfor res in results:\n    if isinstance(res, Exception):\n        print(\"Task failed:\", res)\n</code></pre></li> <li>\u5de5\u4f5c\u8005\u6578\u91cf\uff1a\u78ba\u4fdd\u6709\u8db3\u5920\u7684\u5de5\u4f5c\u8005\u8655\u7406\u4e26\u884c\u4efb\u52d9\uff0c\u5426\u5247\u4efb\u52d9\u4ecd\u6703\u6392\u968a\u3002</li> </ul>"},{"location":"celery/advanced/canvas/group/#_3","title":"\u5c0f\u7d50","text":"<p>Group \u662f Celery Canvas \u4e2d\u7528\u65bc\u4e26\u884c\u57f7\u884c\u4efb\u52d9\u7684\u5de5\u5177\uff0c\u7279\u5225\u9069\u5408\u6279\u91cf\u8655\u7406\u7368\u7acb\u4efb\u52d9\u7684\u5834\u666f\u3002\u901a\u904e\u5408\u7406\u4f7f\u7528 Group\uff0c\u60a8\u53ef\u4ee5\u986f\u8457\u63d0\u5347\u4efb\u52d9\u8655\u7406\u6548\u7387\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cChord\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u5728\u4e26\u884c\u4efb\u52d9\u5f8c\u57f7\u884c\u56de\u8abf\u3002</p> <p>\u63d0\u793a\uff1a\u4f7f\u7528 Group \u6642\uff0c\u9700\u95dc\u6ce8\u7cfb\u7d71\u8cc7\u6e90\u4f7f\u7528\u60c5\u6cc1\uff0c\u907f\u514d\u904e\u591a\u4e26\u884c\u4efb\u52d9\u5c0e\u81f4\u6548\u80fd\u4e0b\u964d\u3002</p>"},{"location":"celery/advanced/canvas/map-starmap/","title":"Map &amp; Starmap\uff1a\u6578\u64da\u96c6\u6620\u5c04","text":"<p>Map \u548c Starmap \u662f Celery Canvas \u4e2d\u7528\u65bc\u5c0d\u6578\u64da\u96c6\u61c9\u7528\u4efb\u52d9\u7684\u5de5\u5177\uff0c\u985e\u4f3c\u65bc Python \u7684 <code>map</code> \u51fd\u6578\uff0c\u652f\u63f4\u5c0d\u591a\u500b\u6578\u64da\u9805\u4e26\u884c\u57f7\u884c\u4efb\u52d9\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Map \u548c Starmap \u7684\u7528\u6cd5\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery/advanced/canvas/map-starmap/#map-starmap_1","title":"\u4ec0\u9ebc\u662f Map \u548c Starmap\uff1f","text":"<ul> <li>Map\uff1a\u5c07\u55ae\u4e00\u4efb\u52d9\u61c9\u7528\u65bc\u6578\u64da\u96c6\u4e2d\u7684\u6bcf\u500b\u5143\u7d20\uff0c\u7b49\u540c\u65bc\u5c0d\u6bcf\u500b\u5143\u7d20\u8abf\u7528 <code>task.delay()</code>\uff0c\u4e26\u884c\u57f7\u884c\u3002</li> <li> <p>Starmap\uff1a\u985e\u4f3c Map\uff0c\u4f46\u7528\u65bc\u9700\u8981\u591a\u500b\u53c3\u6578\u7684\u4efb\u52d9\uff0c\u5c07\u6578\u64da\u96c6\u4e2d\u7684\u6bcf\u500b\u5143\u7d20\u89e3\u5305\u70ba\u53c3\u6578\u50b3\u5165\u4efb\u52d9\u3002</p> </li> <li> <p>\u4f5c\u7528\uff1a\u5c0d\u6578\u64da\u96c6\u4e26\u884c\u61c9\u7528\u4efb\u52d9\uff0c\u63d0\u5347\u8655\u7406\u6548\u7387\u3002</p> </li> <li>\u61c9\u7528\u5834\u666f\uff1a\u6279\u91cf\u8655\u7406\u6578\u64da\u96c6\uff0c\u5982\u5c0d\u591a\u500b\u6587\u4ef6\u6216\u8a18\u9304\u57f7\u884c\u76f8\u540c\u64cd\u4f5c\u3002</li> </ul>"},{"location":"celery/advanced/canvas/map-starmap/#map","title":"Map \u57fa\u672c\u7528\u6cd5","text":"<p>\u4f7f\u7528 <code>map</code> \u65b9\u6cd5\u5c0d\u6578\u64da\u96c6\u61c9\u7528\u4efb\u52d9\uff1a</p>"},{"location":"celery/advanced/canvas/map-starmap/#map_1","title":"\u793a\u4f8b\uff1a\u57fa\u672c Map","text":"<pre><code>from app import process_item  # \u5047\u8a2d\u9019\u662f\u5df2\u5b9a\u7fa9\u7684\u4efb\u52d9\n\n# \u5b9a\u7fa9\u6578\u64da\u96c6\nitems = [1, 2, 3, 4, 5]\n\n# \u4f7f\u7528 Map \u5c0d\u6bcf\u500b\u5143\u7d20\u61c9\u7528\u4efb\u52d9\nresult = process_item.map(items).delay()\nprint(\"Map started, ID:\", result.id)\n\n# \u7b49\u5f85\u7d50\u679c\nprint(\"Results:\", result.get())\n</code></pre> <ul> <li>\u4e26\u884c\u57f7\u884c\uff1a\u6bcf\u500b\u5143\u7d20\u7368\u7acb\u61c9\u7528 <code>process_item</code> \u4efb\u52d9\u3002</li> <li>\u7d50\u679c\uff1a\u8fd4\u56de\u7d50\u679c\u5217\u8868\uff0c\u8207\u8f38\u5165\u9806\u5e8f\u4e00\u81f4\u3002</li> </ul>"},{"location":"celery/advanced/canvas/map-starmap/#starmap","title":"Starmap \u57fa\u672c\u7528\u6cd5","text":"<p>\u4f7f\u7528 <code>starmap</code> \u65b9\u6cd5\u5c0d\u6578\u64da\u96c6\u61c9\u7528\u591a\u53c3\u6578\u4efb\u52d9\uff1a</p>"},{"location":"celery/advanced/canvas/map-starmap/#starmap_1","title":"\u793a\u4f8b\uff1a\u57fa\u672c Starmap","text":"<pre><code>from app import process_pair  # \u5047\u8a2d\u9019\u662f\u63a5\u53d7\u5169\u500b\u53c3\u6578\u7684\u4efb\u52d9\n\n# \u5b9a\u7fa9\u6578\u64da\u96c6\uff08\u6bcf\u500b\u5143\u7d20\u662f\u53c3\u6578\u5143\u7d44\uff09\npairs = [(1, 10), (2, 20), (3, 30)]\n\n# \u4f7f\u7528 Starmap \u5c0d\u6bcf\u500b\u5143\u7d44\u89e3\u5305\u4e26\u61c9\u7528\u4efb\u52d9\nresult = process_pair.starmap(pairs).delay()\nprint(\"Starmap started, ID:\", result.id)\n\n# \u7b49\u5f85\u7d50\u679c\nprint(\"Results:\", result.get())\n</code></pre> <ul> <li>\u89e3\u5305\u53c3\u6578\uff1a\u6bcf\u500b\u5143\u7d44 <code>(x, y)</code> \u89e3\u5305\u70ba <code>process_pair(x, y)</code>\u3002</li> <li>\u7d50\u679c\uff1a\u8fd4\u56de\u7d50\u679c\u5217\u8868\uff0c\u8207\u8f38\u5165\u9806\u5e8f\u4e00\u81f4\u3002</li> </ul>"},{"location":"celery/advanced/canvas/map-starmap/#_1","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u6279\u91cf\u6578\u64da\u8655\u7406\uff1a\u5c0d\u591a\u500b\u6578\u64da\u9805\u57f7\u884c\u76f8\u540c\u64cd\u4f5c\uff0c\u5982\u5716\u7247\u7e2e\u653e\u6216\u6587\u672c\u8655\u7406\u3002   <pre><code>images = [\"img1.jpg\", \"img2.jpg\", \"img3.jpg\"]\nresult = resize_image.map(images).delay()\n</code></pre></li> <li>\u591a\u53c3\u6578\u6279\u91cf\u64cd\u4f5c\uff1a\u5c0d\u6210\u5c0d\u6578\u64da\u57f7\u884c\u64cd\u4f5c\uff0c\u5982\u8a08\u7b97\u591a\u7d44\u6578\u64da\u7684\u8ddd\u96e2\u3002   <pre><code>coordinates = [(0, 0, 1, 1), (1, 1, 2, 2)]\nresult = calculate_distance.starmap(coordinates).delay()\n</code></pre></li> </ul>"},{"location":"celery/advanced/canvas/map-starmap/#_2","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u8cc7\u6e90\u9650\u5236\uff1aMap \u548c Starmap \u6703\u4e26\u884c\u57f7\u884c\u4efb\u52d9\uff0c\u53ef\u80fd\u5c0e\u81f4\u8cc7\u6e90\u722d\u7528\uff0c\u9700\u6839\u64da\u7cfb\u7d71\u80fd\u529b\u8abf\u6574\u6578\u64da\u96c6\u5927\u5c0f\u3002</li> <li>\u932f\u8aa4\u8655\u7406\uff1a\u82e5\u67d0\u500b\u4efb\u52d9\u5931\u6557\uff0c\u6574\u9ad4\u7d50\u679c\u53ef\u80fd\u5305\u542b\u7570\u5e38\uff0c\u5efa\u8b70\u6aa2\u67e5\u7d50\u679c\uff1a   <pre><code>results = result.get(propagate=False)\nfor res in results:\n    if isinstance(res, Exception):\n        print(\"Task failed:\", res)\n</code></pre></li> <li>\u5de5\u4f5c\u8005\u6578\u91cf\uff1a\u78ba\u4fdd\u6709\u8db3\u5920\u7684\u5de5\u4f5c\u8005\u8655\u7406\u4e26\u884c\u4efb\u52d9\uff0c\u5426\u5247\u4efb\u52d9\u4ecd\u6703\u6392\u968a\u57f7\u884c\u3002</li> </ul>"},{"location":"celery/advanced/canvas/map-starmap/#_3","title":"\u5c0f\u7d50","text":"<p>Map \u548c Starmap \u662f Celery Canvas \u4e2d\u7528\u65bc\u5c0d\u6578\u64da\u96c6\u4e26\u884c\u61c9\u7528\u4efb\u52d9\u7684\u5de5\u5177\uff0c\u7279\u5225\u9069\u5408\u6279\u91cf\u8655\u7406\u5834\u666f\u3002\u901a\u904e\u9019\u4e9b\u5de5\u5177\uff0c\u60a8\u53ef\u4ee5\u9ad8\u6548\u8655\u7406\u5927\u898f\u6a21\u6578\u64da\uff0c\u63d0\u5347\u7cfb\u7d71\u541e\u5410\u91cf\u3002\u672c\u7ae0\u7bc0\u7d50\u675f\u4e86\u300c\u5de5\u4f5c\u6d41\uff08Canvas\uff09\u300d\u7684\u5b78\u7fd2\uff0c\u4e0b\u4e00\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u300c\u4efb\u52d9\u8def\u7531\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u5c07\u4efb\u52d9\u5206\u767c\u5230\u7279\u5b9a\u968a\u5217\u6216\u5de5\u4f5c\u8005\u3002</p> <p>\u63d0\u793a\uff1a\u4f7f\u7528 Map \u548c Starmap \u6642\uff0c\u9700\u95dc\u6ce8\u7cfb\u7d71\u8cc7\u6e90\u4f7f\u7528\u60c5\u6cc1\uff0c\u907f\u514d\u904e\u591a\u4e26\u884c\u4efb\u52d9\u5c0e\u81f4\u6548\u80fd\u4e0b\u964d\u3002</p>"},{"location":"celery-beat/","title":"Celery Beat \u6982\u8ff0","text":"<p>\u6b61\u8fce\u4f86\u5230\u300cCelery Beat\u300d\u7ae0\u7bc0\uff01\u5728\u4e4b\u524d\u7684\u300cCelery \u57fa\u790e\u300d\u8207\u300cCelery \u9032\u968e\u529f\u80fd\u300d\u4e2d\uff0c\u6211\u5011\u5b78\u7fd2\u4e86\u5982\u4f55\u4f7f\u7528 Celery \u8655\u7406\u7570\u6b65\u4efb\u52d9\u8207\u8907\u96dc\u5de5\u4f5c\u6d41\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39 Celery Beat\uff0c\u4e00\u500b\u7528\u65bc\u4efb\u52d9\u8abf\u5ea6\u7684\u64f4\u5c55\u5de5\u5177\uff0c\u5e6b\u52a9\u60a8\u5be6\u73fe\u5b9a\u6642\u4efb\u52d9\u8207\u9031\u671f\u6027\u4efb\u52d9\u7684\u81ea\u52d5\u5316\u57f7\u884c\u3002</p>"},{"location":"celery-beat/#celery-beat_1","title":"\u4ec0\u9ebc\u662f Celery Beat\uff1f","text":"<p>Celery Beat \u662f\u4e00\u500b Celery \u7684\u64f4\u5c55\u5eab\uff0c\u7528\u65bc\u7ba1\u7406\u548c\u57f7\u884c\u5b9a\u6642\u4efb\u52d9\u8207\u9031\u671f\u6027\u4efb\u52d9\u3002\u5b83\u5141\u8a31\u60a8\u6839\u64da\u6642\u9593\u8868\uff08Schedule\uff09\u5b89\u6392\u4efb\u52d9\u57f7\u884c\uff0c\u985e\u4f3c\u65bc\u64cd\u4f5c\u7cfb\u7d71\u4e2d\u7684 <code>cron</code> \u5de5\u5177\uff0c\u4f46\u5c08\u70ba Celery \u4efb\u52d9\u8a2d\u8a08\uff0c\u63d0\u4f9b\u66f4\u9ad8\u7684\u9748\u6d3b\u6027\u8207\u6574\u5408\u6027\u3002</p> <ul> <li>\u89d2\u8272\uff1a\u5b9a\u6642\u8207\u9031\u671f\u6027\u4efb\u52d9\u8abf\u5ea6\u5668\u3002</li> <li>\u6838\u5fc3\u529f\u80fd\uff1a\u652f\u63f4\u5b9a\u6642\u4efb\u52d9\u914d\u7f6e\u3001Crontab \u8868\u9054\u5f0f\u3001\u52d5\u614b\u8abf\u5ea6\u8207\u6301\u4e45\u5316\u8abf\u5ea6\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u81ea\u52d5\u5316\u5831\u544a\u751f\u6210\u3001\u5b9a\u6642\u6578\u64da\u540c\u6b65\u3001\u5b9a\u671f\u6e05\u7406\u4efb\u52d9\u7b49\u3002</li> </ul>"},{"location":"celery-beat/#celery-beat_2","title":"\u70ba\u4ec0\u9ebc\u9700\u8981 Celery Beat\uff1f","text":"<p>\u5728\u8a31\u591a\u696d\u52d9\u5834\u666f\u4e2d\uff0c\u4efb\u52d9\u4e0d\u50c5\u9700\u8981\u7570\u6b65\u57f7\u884c\uff0c\u9084\u9700\u8981\u6309\u7279\u5b9a\u6642\u9593\u6216\u9031\u671f\u57f7\u884c\u3002\u4f8b\u5982\uff1a - \u6bcf\u5929\u51cc\u6668\u751f\u6210\u696d\u52d9\u5831\u544a\u3002 - \u6bcf\u5c0f\u6642\u540c\u6b65\u5916\u90e8\u6578\u64da\u4f86\u6e90\u3002 - \u6bcf\u9031\u6e05\u7406\u904e\u671f\u6578\u64da\u3002</p> <p>Celery Beat \u63d0\u4f9b\u4e86\u4e00\u500b\u7d71\u4e00\u7684\u6846\u67b6\u4f86\u7ba1\u7406\u9019\u4e9b\u5b9a\u6642\u4efb\u52d9\uff0c\u7121\u9700\u4f9d\u8cf4\u5916\u90e8\u5de5\u5177\uff08\u5982\u7cfb\u7d71 cron\uff09\uff0c\u4e26\u8207 Celery \u751f\u614b\u7121\u7e2b\u6574\u5408\u3002</p>"},{"location":"celery-beat/#_1","title":"\u672c\u7ae0\u7bc0\u5167\u5bb9\u6982\u8ff0","text":"<p>\u5728\u672c\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4ee5\u4e0b\u6838\u5fc3\u4e3b\u984c\uff1a - \u5b9a\u6642\u4efb\u52d9\u914d\u7f6e\uff1a\u5982\u4f55\u5b89\u88dd\u8207\u914d\u7f6e Celery Beat\uff0c\u5b9a\u7fa9\u7c21\u55ae\u7684\u5b9a\u6642\u4efb\u52d9\u3002 - Crontab \u8868\u9054\u5f0f\uff1a\u4f7f\u7528 Crontab \u8a9e\u6cd5\u5b9a\u7fa9\u8907\u96dc\u7684\u9031\u671f\u6027\u4efb\u52d9\u3002 - \u52d5\u614b\u8abf\u5ea6\uff1a\u5728\u904b\u884c\u6642\u52d5\u614b\u6dfb\u52a0\u6216\u4fee\u6539\u4efb\u52d9\u8abf\u5ea6\u3002 - \u6301\u4e45\u5316\u8abf\u5ea6\u5668\uff1a\u4f7f\u7528\u6578\u64da\u5eab\u6216\u5176\u4ed6\u5b58\u5132\u65b9\u5f0f\u6301\u4e45\u5316\u8abf\u5ea6\u4fe1\u606f\uff0c\u907f\u514d\u8abf\u5ea6\u4e1f\u5931\u3002</p>"},{"location":"celery-beat/#_2","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5b8c\u6210\u672c\u7ae0\u7bc0\u5f8c\uff0c\u60a8\u5c07\u80fd\u5920\uff1a - \u5b89\u88dd\u8207\u914d\u7f6e Celery Beat\uff0c\u5be6\u73fe\u57fa\u672c\u5b9a\u6642\u4efb\u52d9\u3002 - \u4f7f\u7528 Crontab \u8868\u9054\u5f0f\u5b9a\u7fa9\u9748\u6d3b\u7684\u4efb\u52d9\u8abf\u5ea6\u6642\u9593\u8868\u3002 - \u52d5\u614b\u7ba1\u7406\u4efb\u52d9\u8abf\u5ea6\uff0c\u9069\u61c9\u696d\u52d9\u9700\u6c42\u8b8a\u5316\u3002 - \u914d\u7f6e\u6301\u4e45\u5316\u8abf\u5ea6\u5668\uff0c\u78ba\u4fdd\u8abf\u5ea6\u4fe1\u606f\u53ef\u9760\u5b58\u5132\u3002</p> <p>\u8b93\u6211\u5011\u5f9e\u300c\u5b9a\u6642\u4efb\u52d9\u914d\u7f6e\u300d\u958b\u59cb\uff0c\u9010\u6b65\u63a2\u7d22 Celery Beat \u7684\u5f37\u5927\u529f\u80fd\uff01</p> <p>\u63d0\u793a\uff1a\u672c\u7ae0\u7bc0\u5047\u8a2d\u60a8\u5df2\u719f\u6089 Celery \u57fa\u790e\u6982\u5ff5\uff0c\u82e5\u9700\u8907\u7fd2\uff0c\u8acb\u53c3\u8003\u524d\u9762\u7684\u300cCelery \u57fa\u790e\u300d\u7ae0\u7bc0\u3002</p>"},{"location":"celery-beat/crontab-expressions/","title":"Crontab \u8868\u9054\u5f0f","text":"<p>Crontab \u8868\u9054\u5f0f\u662f Celery Beat \u4e2d\u7528\u65bc\u5b9a\u7fa9\u8907\u96dc\u9031\u671f\u6027\u4efb\u52d9\u6642\u9593\u8868\u7684\u4e00\u7a2e\u8a9e\u6cd5\uff0c\u985e\u4f3c\u65bc Linux \u7cfb\u7d71\u4e2d\u7684 <code>cron</code> \u5de5\u5177\u3002\u672c\u6587\u5c07\u4ecb\u7d39 Crontab \u8868\u9054\u5f0f\u7684\u57fa\u672c\u683c\u5f0f\u8207\u7528\u6cd5\u3002</p>"},{"location":"celery-beat/crontab-expressions/#crontab_1","title":"\u4ec0\u9ebc\u662f Crontab \u8868\u9054\u5f0f\uff1f","text":"<p>Crontab \u8868\u9054\u5f0f\u662f\u4e00\u7a2e\u7528\u65bc\u6307\u5b9a\u4efb\u52d9\u57f7\u884c\u6642\u9593\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\uff0c\u901a\u904e\u5b9a\u7fa9\u5206\u9418\u3001\u5c0f\u6642\u3001\u65e5\u671f\u3001\u6708\u4efd\u548c\u661f\u671f\u7b49\u5b57\u6bb5\uff0c\u5be6\u73fe\u9748\u6d3b\u7684\u4efb\u52d9\u8abf\u5ea6\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u5b9a\u7fa9\u7cbe\u78ba\u7684\u4efb\u52d9\u57f7\u884c\u6642\u9593\u8868\uff0c\u652f\u63f4\u8907\u96dc\u9031\u671f\u6027\u8abf\u5ea6\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u9700\u8981\u6309\u7279\u5b9a\u6642\u9593\u6216\u9031\u671f\u57f7\u884c\u4efb\u52d9\uff0c\u5982\u6bcf\u5929\u7279\u5b9a\u6642\u9593\u3001\u6bcf\u9031\u7279\u5b9a\u65e5\u671f\u7b49\u3002</li> </ul>"},{"location":"celery-beat/crontab-expressions/#crontab_2","title":"Crontab \u8868\u9054\u5f0f\u683c\u5f0f","text":"<p>Crontab \u8868\u9054\u5f0f\u7531\u4e94\u500b\u5b57\u6bb5\u7d44\u6210\uff0c\u6309\u9806\u5e8f\u5206\u5225\u8868\u793a\uff1a <pre><code>* * * * *\n\u5206\u9418 \u5c0f\u6642 \u65e5\u671f \u6708\u4efd \u661f\u671f\n</code></pre></p> <ul> <li>\u5206\u9418\uff1a0-59\uff0c\u8868\u793a\u6bcf\u5c0f\u6642\u7684\u7b2c\u5e7e\u5206\u9418\u3002</li> <li>\u5c0f\u6642\uff1a0-23\uff0c\u8868\u793a\u6bcf\u5929\u7684\u7b2c\u5e7e\u5c0f\u6642\u3002</li> <li>\u65e5\u671f\uff1a1-31\uff0c\u8868\u793a\u6bcf\u6708\u7684\u7b2c\u5e7e\u5929\u3002</li> <li>\u6708\u4efd\uff1a1-12\uff0c\u8868\u793a\u6bcf\u5e74\u7684\u7b2c\u5e7e\u500b\u6708\u3002</li> <li>\u661f\u671f\uff1a0-6\uff080 \u8868\u793a\u661f\u671f\u65e5\uff09\uff0c\u8868\u793a\u6bcf\u9031\u7684\u7b2c\u5e7e\u5929\u3002</li> </ul> <p>\u6bcf\u500b\u5b57\u6bb5\u652f\u63f4\u4ee5\u4e0b\u7279\u6b8a\u5b57\u7b26\uff1a - <code>*</code>\uff1a\u8868\u793a\u4efb\u610f\u503c\uff08\u5373\u6bcf\u4e00\u500b\uff09\u3002 - <code>,</code>\uff1a\u5217\u8209\u591a\u500b\u503c\uff0c\u5982 <code>1,3,5</code>\u3002 - <code>-</code>\uff1a\u8868\u793a\u7bc4\u570d\uff0c\u5982 <code>1-5</code>\u3002 - <code>/</code>\uff1a\u8868\u793a\u6b65\u9577\uff0c\u5982 <code>*/5</code>\uff08\u6bcf 5 \u500b\u55ae\u4f4d\u57f7\u884c\u4e00\u6b21\uff09\u3002</p>"},{"location":"celery-beat/crontab-expressions/#celery-beat-crontab","title":"\u5728 Celery Beat \u4e2d\u4f7f\u7528 Crontab","text":"<p>Celery Beat \u63d0\u4f9b <code>crontab</code> \u51fd\u6578\u4f86\u89e3\u6790 Crontab \u8868\u9054\u5f0f\uff0c\u5b9a\u7fa9\u4efb\u52d9\u8abf\u5ea6\u6642\u9593\u8868\u3002</p>"},{"location":"celery-beat/crontab-expressions/#crontab_3","title":"\u793a\u4f8b\uff1a\u57fa\u672c Crontab \u8868\u9054\u5f0f","text":"<pre><code>from celery.schedules import crontab\n\nbeat_schedule = {\n    'run-every-minute': {\n        'task': 'app.tasks.my_task',\n        'schedule': crontab(),  # \u6bcf\u5206\u9418\u57f7\u884c\uff0c\u7b49\u540c\u65bc * * * * *\n    },\n    'run-daily-at-3am': {\n        'task': 'app.tasks.daily_task',\n        'schedule': crontab(hour=3, minute=0),  # \u6bcf\u5929\u51cc\u6668 3 \u9ede\u57f7\u884c\n    },\n    'run-every-hour-on-weekdays': {\n        'task': 'app.tasks.hourly_task',\n        'schedule': crontab(minute=0, day_of_week='1-5'),  # \u5de5\u4f5c\u65e5\u6bcf\u5c0f\u6642\u57f7\u884c\n    },\n}\n</code></pre>"},{"location":"celery-beat/crontab-expressions/#crontab_4","title":"\u793a\u4f8b\uff1a\u8907\u96dc Crontab \u8868\u9054\u5f0f","text":"<pre><code>beat_schedule = {\n    'run-every-5-minutes': {\n        'task': 'app.tasks.frequent_task',\n        'schedule': crontab(minute='*/5'),  # \u6bcf 5 \u5206\u9418\u57f7\u884c\n    },\n    'run-on-specific-days': {\n        'task': 'app.tasks.special_task',\n        'schedule': crontab(hour=9, minute=0, day_of_month='1,15'),  # \u6bcf\u6708 1 \u865f\u8207 15 \u865f\u4e0a\u5348 9 \u9ede\u57f7\u884c\n    },\n}\n</code></pre>"},{"location":"celery-beat/crontab-expressions/#_1","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u6bcf\u65e5\u5831\u544a\uff1a\u6bcf\u5929\u51cc\u6668\u751f\u6210\u696d\u52d9\u5831\u544a\u3002   <pre><code>beat_schedule = {\n    'daily-report': {\n        'task': 'app.tasks.generate_report',\n        'schedule': crontab(hour=0, minute=0),\n    },\n}\n</code></pre></li> <li>\u5de5\u4f5c\u65e5\u63d0\u9192\uff1a\u5de5\u4f5c\u65e5\u4e0a\u5348 9 \u9ede\u767c\u9001\u63d0\u9192\u3002   <pre><code>beat_schedule = {\n    'weekday-reminder': {\n        'task': 'app.tasks.send_reminder',\n        'schedule': crontab(hour=9, minute=0, day_of_week='1-5'),\n    },\n}\n</code></pre></li> <li>\u5b9a\u671f\u6aa2\u67e5\uff1a\u6bcf 15 \u5206\u9418\u6aa2\u67e5\u7cfb\u7d71\u72c0\u614b\u3002   <pre><code>beat_schedule = {\n    'system-check': {\n        'task': 'app.tasks.check_system',\n        'schedule': crontab(minute='*/15'),\n    },\n}\n</code></pre></li> </ul>"},{"location":"celery-beat/crontab-expressions/#_2","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u661f\u671f\u8207\u65e5\u671f\u885d\u7a81\uff1a\u7576\u540c\u6642\u6307\u5b9a <code>day_of_month</code> \u548c <code>day_of_week</code> \u6642\uff0cCelery Beat \u6703\u5c07\u5176\u8996\u70ba\u300c\u6216\u300d\u95dc\u4fc2\uff0c\u5373\u6eff\u8db3\u4efb\u4e00\u689d\u4ef6\u5373\u57f7\u884c\u3002</li> <li>\u6642\u9593\u7cbe\u78ba\u5ea6\uff1aCrontab \u8868\u9054\u5f0f\u6700\u5c0f\u55ae\u4f4d\u70ba\u5206\u9418\uff0c\u7121\u6cd5\u5be6\u73fe\u79d2\u7d1a\u8abf\u5ea6\u3002</li> <li>\u6642\u5340\u8a2d\u7f6e\uff1a\u78ba\u4fdd Celery \u61c9\u7528\u7684\u6642\u5340\u914d\u7f6e\u6b63\u78ba\uff08<code>timezone</code>\uff09\uff0c\u4ee5\u907f\u514d\u8abf\u5ea6\u6642\u9593\u504f\u5dee\u3002</li> </ul>"},{"location":"celery-beat/crontab-expressions/#_3","title":"\u5c0f\u7d50","text":"<p>Crontab \u8868\u9054\u5f0f\u662f Celery Beat \u4e2d\u5b9a\u7fa9\u8907\u96dc\u9031\u671f\u6027\u4efb\u52d9\u6642\u9593\u8868\u7684\u5f37\u5927\u5de5\u5177\uff0c\u901a\u904e\u9748\u6d3b\u7d44\u5408\u5404\u500b\u6642\u9593\u5b57\u6bb5\uff0c\u60a8\u53ef\u4ee5\u6eff\u8db3\u591a\u6a23\u5316\u7684\u8abf\u5ea6\u9700\u6c42\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u52d5\u614b\u8abf\u5ea6\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u5728\u904b\u884c\u6642\u6dfb\u52a0\u6216\u4fee\u6539\u4efb\u52d9\u8abf\u5ea6\u3002</p> <p>\u63d0\u793a\uff1a\u4f7f\u7528 Crontab \u8868\u9054\u5f0f\u6642\uff0c\u5efa\u8b70\u5148\u5728\u7dda\u4e0a\u5de5\u5177\uff08\u5982 crontab.guru\uff09\u6e2c\u8a66\u8868\u9054\u5f0f\uff0c\u78ba\u4fdd\u7b26\u5408\u9810\u671f\u3002</p>"},{"location":"celery-beat/dynamic-scheduling/","title":"\u52d5\u614b\u8abf\u5ea6","text":"<p>\u52d5\u614b\u8abf\u5ea6\u662f Celery Beat \u7684\u4e00\u7a2e\u9032\u968e\u529f\u80fd\uff0c\u5141\u8a31\u60a8\u5728\u904b\u884c\u6642\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u522a\u9664\u4efb\u52d9\u8abf\u5ea6\uff0c\u800c\u7121\u9700\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u91cd\u555f\u670d\u52d9\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u52d5\u614b\u8abf\u5ea6\u7684\u5be6\u73fe\u65b9\u6cd5\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery-beat/dynamic-scheduling/#_2","title":"\u4ec0\u9ebc\u662f\u52d5\u614b\u8abf\u5ea6\uff1f","text":"<p>\u52d5\u614b\u8abf\u5ea6\u662f\u6307\u901a\u904e\u7a0b\u5f0f\u78bc\u6216 API \u5728 Celery Beat \u904b\u884c\u6642\u66f4\u65b0\u4efb\u52d9\u8abf\u5ea6\u6642\u9593\u8868\uff0c\u7121\u9700\u4f9d\u8cf4\u975c\u614b\u914d\u7f6e\u6587\u4ef6\u3002\u9019\u4f7f\u5f97\u4efb\u52d9\u8abf\u5ea6\u66f4\u52a0\u9748\u6d3b\uff0c\u80fd\u5920\u6839\u64da\u696d\u52d9\u9700\u6c42\u5373\u6642\u8abf\u6574\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u904b\u884c\u6642\u7ba1\u7406\u4efb\u52d9\u8abf\u5ea6\uff0c\u9069\u61c9\u52d5\u614b\u696d\u52d9\u9700\u6c42\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u7528\u6236\u81ea\u5b9a\u7fa9\u4efb\u52d9\u57f7\u884c\u6642\u9593\u3001\u81e8\u6642\u4efb\u52d9\u5b89\u6392\u3001\u6839\u64da\u4e8b\u4ef6\u89f8\u767c\u8abf\u5ea6\u3002</li> </ul>"},{"location":"celery-beat/dynamic-scheduling/#_3","title":"\u5be6\u73fe\u52d5\u614b\u8abf\u5ea6","text":"<p>Celery Beat \u652f\u63f4\u901a\u904e\u6301\u4e45\u5316\u8abf\u5ea6\u5668\uff08\u5982\u6578\u64da\u5eab\uff09\u5be6\u73fe\u52d5\u614b\u8abf\u5ea6\uff0c\u5e38\u7528\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 <code>django-celery-beat</code> \u64f4\u5c55\uff0c\u5b83\u63d0\u4f9b\u4e86\u57fa\u65bc Django \u6a21\u578b\u7684\u8abf\u5ea6\u7ba1\u7406\u529f\u80fd\u3002</p>"},{"location":"celery-beat/dynamic-scheduling/#1-django-celery-beat","title":"\u6b65\u9a5f 1\uff1a\u5b89\u88dd django-celery-beat","text":"<p>\u9996\u5148\u5b89\u88dd <code>django-celery-beat</code>\uff0c\u4e26\u5c07\u5176\u6574\u5408\u5230 Django \u9805\u76ee\u4e2d\uff1a <pre><code>pip install django-celery-beat\n</code></pre></p> <p>\u5728 Django \u8a2d\u5b9a\u4e2d\u6dfb\u52a0\u61c9\u7528\uff1a <pre><code>INSTALLED_APPS = [\n    ...\n    'django_celery_beat',\n]\n</code></pre></p>"},{"location":"celery-beat/dynamic-scheduling/#2-celery-beat","title":"\u6b65\u9a5f 2\uff1a\u914d\u7f6e Celery Beat \u8abf\u5ea6\u5668","text":"<p>\u5728 Django \u8a2d\u5b9a\u4e2d\u6307\u5b9a Celery Beat \u4f7f\u7528\u6578\u64da\u5eab\u8abf\u5ea6\u5668\uff1a <pre><code># settings.py\nCELERY_BEAT_SCHEDULER = 'django_celery_beat.schedulers:DatabaseScheduler'\n</code></pre></p> <p>\u904b\u884c\u6578\u64da\u5eab\u9077\u79fb\u4ee5\u5275\u5efa\u8abf\u5ea6\u8868\uff1a <pre><code>python manage.py migrate\n</code></pre></p>"},{"location":"celery-beat/dynamic-scheduling/#3","title":"\u6b65\u9a5f 3\uff1a\u52d5\u614b\u6dfb\u52a0\u8207\u4fee\u6539\u8abf\u5ea6","text":"<p>\u4f7f\u7528 Django \u6a21\u578b API \u52d5\u614b\u7ba1\u7406\u4efb\u52d9\u8abf\u5ea6\uff1a <pre><code>from django_celery_beat.models import PeriodicTask, CrontabSchedule\n\n# \u5275\u5efa\u4e00\u500b Crontab \u6642\u9593\u8868\uff08\u4f8b\u5982\u6bcf\u5929\u51cc\u6668\u57f7\u884c\uff09\nschedule, created = CrontabSchedule.objects.get_or_create(\n    hour=0,\n    minute=0,\n)\n\n# \u5275\u5efa\u6216\u66f4\u65b0\u4e00\u500b\u5b9a\u6642\u4efb\u52d9\ntask, created = PeriodicTask.objects.get_or_create(\n    name='Dynamic Daily Task',\n    defaults={\n        'task': 'app.tasks.my_dynamic_task',  # \u4efb\u52d9\u8def\u5f91\n        'crontab': schedule,\n        'args': json.dumps([arg1, arg2]),  # \u4efb\u52d9\u53c3\u6578\uff0c\u53ef\u9078\n    },\n)\n\n# \u4fee\u6539\u73fe\u6709\u4efb\u52d9\u7684\u6642\u9593\u8868\ntask.crontab.hour = 1  # \u4fee\u6539\u70ba\u51cc\u6668 1 \u9ede\u57f7\u884c\ntask.crontab.save()\ntask.save()\n\n# \u522a\u9664\u4efb\u52d9\ntask.delete()\n</code></pre></p> <ul> <li>CrontabSchedule\uff1a\u5b9a\u7fa9\u4efb\u52d9\u57f7\u884c\u6642\u9593\u8868\u3002</li> <li>PeriodicTask\uff1a\u5b9a\u7fa9\u5b9a\u6642\u4efb\u52d9\uff0c\u95dc\u806f\u6642\u9593\u8868\u8207\u4efb\u52d9\u8def\u5f91\u3002</li> </ul>"},{"location":"celery-beat/dynamic-scheduling/#4-celery-beat","title":"\u6b65\u9a5f 4\uff1a\u555f\u52d5 Celery Beat","text":"<p>\u4f7f\u7528\u6578\u64da\u5eab\u8abf\u5ea6\u5668\u555f\u52d5 Celery Beat\uff1a <pre><code>celery -A app beat --loglevel=info\n</code></pre></p> <p>\u78ba\u4fdd Celery \u5de5\u4f5c\u8005\u4e5f\u5728\u904b\u884c\uff1a <pre><code>celery -A app worker --loglevel=info\n</code></pre></p>"},{"location":"celery-beat/dynamic-scheduling/#_4","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u7528\u6236\u81ea\u5b9a\u7fa9\u8abf\u5ea6\uff1a\u5141\u8a31\u7528\u6236\u901a\u904e\u4ecb\u9762\u8a2d\u5b9a\u4efb\u52d9\u57f7\u884c\u6642\u9593\u3002   <pre><code>def schedule_user_task(user_id, task_time):\n    schedule, _ = CrontabSchedule.objects.get_or_create(\n        hour=task_time.hour,\n        minute=task_time.minute,\n    )\n    PeriodicTask.objects.create(\n        name=f'User Task {user_id}',\n        task='app.tasks.user_task',\n        crontab=schedule,\n        args=json.dumps([user_id]),\n    )\n</code></pre></li> <li>\u81e8\u6642\u4efb\u52d9\u5b89\u6392\uff1a\u6839\u64da\u4e8b\u4ef6\u81e8\u6642\u6dfb\u52a0\u4e00\u6b21\u6027\u4efb\u52d9\u3002</li> <li>\u8abf\u5ea6\u8abf\u6574\uff1a\u6839\u64da\u696d\u52d9\u9ad8\u5cf0\u671f\u52d5\u614b\u8abf\u6574\u4efb\u52d9\u983b\u7387\u3002</li> </ul>"},{"location":"celery-beat/dynamic-scheduling/#_5","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6578\u64da\u5eab\u4f9d\u8cf4\uff1a\u52d5\u614b\u8abf\u5ea6\u4f9d\u8cf4\u6301\u4e45\u5316\u8abf\u5ea6\u5668\uff08\u5982 <code>django-celery-beat</code>\uff09\uff0c\u9700\u78ba\u4fdd\u6578\u64da\u5eab\u53ef\u7528\u3002</li> <li>\u4efb\u52d9\u885d\u7a81\uff1a\u907f\u514d\u5275\u5efa\u540d\u7a31\u6216\u529f\u80fd\u91cd\u8907\u7684\u4efb\u52d9\uff0c\u5efa\u8b70</li> </ul>"},{"location":"celery-beat/persistent-scheduler/","title":"\u6301\u4e45\u5316\u8abf\u5ea6\u5668","text":"<p>\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u662f Celery Beat \u7684\u4e00\u7a2e\u9032\u968e\u529f\u80fd\uff0c\u5141\u8a31\u60a8\u5c07\u4efb\u52d9\u8abf\u5ea6\u4fe1\u606f\u5b58\u5132\u5728\u6301\u4e45\u5316\u5b58\u5132\uff08\u5982\u6578\u64da\u5eab\uff09\u4e2d\uff0c\u800c\u4e0d\u662f\u4f9d\u8cf4\u81e8\u6642\u6587\u4ef6\u6216\u8a18\u61b6\u9ad4\uff0c\u5f9e\u800c\u78ba\u4fdd\u8abf\u5ea6\u4fe1\u606f\u5728\u670d\u52d9\u91cd\u555f\u5f8c\u4e0d\u6703\u4e1f\u5931\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u7684\u914d\u7f6e\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"celery-beat/persistent-scheduler/#_2","title":"\u4ec0\u9ebc\u662f\u6301\u4e45\u5316\u8abf\u5ea6\u5668\uff1f","text":"<p>\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u662f\u6307 Celery Beat \u4f7f\u7528\u6301\u4e45\u5316\u5b58\u5132\uff08\u5982\u6578\u64da\u5eab\uff09\u4f86\u4fdd\u5b58\u4efb\u52d9\u8abf\u5ea6\u6642\u9593\u8868\u8207\u76f8\u95dc\u914d\u7f6e\u3002\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0cCelery Beat \u4f7f\u7528 SQLite \u6587\u4ef6\u4f5c\u70ba\u8abf\u5ea6\u5b58\u5132\uff0c\u4f46\u9019\u5728\u5206\u4f48\u5f0f\u74b0\u5883\u6216\u9ad8\u53ef\u7528\u6027\u5834\u666f\u4e2d\u53ef\u80fd\u4e0d\u8db3\u4ee5\u6eff\u8db3\u9700\u6c42\u3002\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u89e3\u6c7a\u4e86\u9019\u4e00\u554f\u984c\uff0c\u63d0\u4f9b\u53ef\u9760\u7684\u8abf\u5ea6\u4fe1\u606f\u7ba1\u7406\u3002</p> <ul> <li>\u4f5c\u7528\uff1a\u5c07\u4efb\u52d9\u8abf\u5ea6\u4fe1\u606f\u6301\u4e45\u5316\u5b58\u5132\uff0c\u907f\u514d\u670d\u52d9\u91cd\u555f\u6216\u6545\u969c\u5c0e\u81f4\u8abf\u5ea6\u4e1f\u5931\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u5206\u4f48\u5f0f\u7cfb\u7d71\u3001\u591a\u7bc0\u9ede\u90e8\u7f72\u3001\u9700\u8981\u9ad8\u53ef\u7528\u6027\u7684\u4efb\u52d9\u8abf\u5ea6\u3002</li> </ul>"},{"location":"celery-beat/persistent-scheduler/#_3","title":"\u914d\u7f6e\u6301\u4e45\u5316\u8abf\u5ea6\u5668","text":"<p>Celery Beat \u652f\u63f4\u591a\u7a2e\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u5be6\u73fe\uff0c\u5176\u4e2d\u6700\u5e38\u7528\u7684\u662f\u57fa\u65bc\u6578\u64da\u5eab\u7684\u8abf\u5ea6\u5668\uff0c\u7279\u5225\u662f\u901a\u904e <code>django-celery-beat</code> \u64f4\u5c55\u5be6\u73fe\u7684 <code>DatabaseScheduler</code>\u3002\u4ee5\u4e0b\u662f\u914d\u7f6e\u6b65\u9a5f\u3002</p>"},{"location":"celery-beat/persistent-scheduler/#1","title":"\u6b65\u9a5f 1\uff1a\u5b89\u88dd\u5fc5\u8981\u5957\u4ef6","text":"<p>\u5b89\u88dd Celery Beat \u8207\u6301\u4e45\u5316\u8abf\u5ea6\u76f8\u95dc\u7684\u5957\u4ef6\uff1a <pre><code>pip install celery[beat] django-celery-beat\n</code></pre></p> <ul> <li>django-celery-beat\uff1a\u63d0\u4f9b\u57fa\u65bc Django \u6a21\u578b\u7684\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u3002</li> </ul>"},{"location":"celery-beat/persistent-scheduler/#2-django","title":"\u6b65\u9a5f 2\uff1a\u914d\u7f6e Django \u9805\u76ee","text":"<p>\u5c07 <code>django_celery_beat</code> \u6dfb\u52a0\u5230 Django \u9805\u76ee\u7684 <code>INSTALLED_APPS</code> \u4e2d\uff1a <pre><code># settings.py\nINSTALLED_APPS = [\n    ...\n    'django_celery_beat',\n]\n</code></pre></p> <p>\u6307\u5b9a Celery Beat \u4f7f\u7528\u6578\u64da\u5eab\u8abf\u5ea6\u5668\uff1a <pre><code># settings.py\nCELERY_BEAT_SCHEDULER = 'django_celery_beat.schedulers:DatabaseScheduler'\n</code></pre></p> <p>\u914d\u7f6e Celery \u61c9\u7528\u8207\u6578\u64da\u5eab\u9023\u63a5\uff08\u5047\u8a2d\u4f7f\u7528 MySQL \u6216 PostgreSQL\uff09\uff1a <pre><code># settings.py\nCELERY_BROKER_URL = 'redis://localhost:6379/0'\nCELERY_RESULT_BACKEND = 'redis://localhost:6379/1'\nCELERY_ACCEPT_CONTENT = ['json']\nCELERY_TASK_SERIALIZER = 'json'\nCELERY_RESULT_SERIALIZER = 'json'\nCELERY_TIMEZONE = 'UTC'\n\n# \u6578\u64da\u5eab\u914d\u7f6e\nDATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.mysql',  # \u6216 postgresql\n        'NAME': 'celery_beat_db',\n        'USER': 'user',\n        'PASSWORD': 'password',\n        'HOST': 'localhost',\n        'PORT': '3306',\n    }\n}\n</code></pre></p>"},{"location":"celery-beat/persistent-scheduler/#3","title":"\u6b65\u9a5f 3\uff1a\u904b\u884c\u6578\u64da\u5eab\u9077\u79fb","text":"<p>\u57f7\u884c\u6578\u64da\u5eab\u9077\u79fb\uff0c\u5275\u5efa\u5fc5\u8981\u7684\u8abf\u5ea6\u8868\uff1a <pre><code>python manage.py migrate\n</code></pre></p> <p>\u9019\u5c07\u5275\u5efa <code>django_celery_beat</code> \u6240\u9700\u7684\u6578\u64da\u8868\uff0c\u7528\u65bc\u5b58\u5132\u4efb\u52d9\u8abf\u5ea6\u4fe1\u606f\u3002</p>"},{"location":"celery-beat/persistent-scheduler/#4-celery-beat","title":"\u6b65\u9a5f 4\uff1a\u555f\u52d5 Celery Beat \u8207\u5de5\u4f5c\u8005","text":"<p>\u555f\u52d5 Celery Beat\uff0c\u4f7f\u7528\u6578\u64da\u5eab\u4f5c\u70ba\u6301\u4e45\u5316\u8abf\u5ea6\u5668\uff1a <pre><code>celery -A your_app beat --loglevel=info\n</code></pre></p> <p>\u540c\u6642\u555f\u52d5 Celery \u5de5\u4f5c\u8005\u4ee5\u57f7\u884c\u4efb\u52d9\uff1a <pre><code>celery -A your_app worker --loglevel=info\n</code></pre></p>"},{"location":"celery-beat/persistent-scheduler/#5","title":"\u6b65\u9a5f 5\uff1a\u7ba1\u7406\u8abf\u5ea6\u4fe1\u606f","text":"<p>\u4f7f\u7528 Django Admin \u4ecb\u9762\u6216\u7a0b\u5f0f\u78bc\u7ba1\u7406\u8abf\u5ea6\u4fe1\u606f\u3002\u555f\u7528 Django Admin\uff1a <pre><code># urls.py\nfrom django.contrib import admin\nfrom django.urls import path\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n]\n</code></pre></p> <p>\u5728 Admin \u4ecb\u9762\u4e2d\uff0c\u60a8\u53ef\u4ee5\u624b\u52d5\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u522a\u9664\u5b9a\u6642\u4efb\u52d9\u8207\u6642\u9593\u8868\u3002</p> <p>\u6216\u8005\u901a\u904e\u7a0b\u5f0f\u78bc\u7ba1\u7406\uff1a <pre><code>from django_celery_beat.models import PeriodicTask, CrontabSchedule\nimport json\n\n# \u5275\u5efa\u6642\u9593\u8868\uff08\u6bcf\u5929\u51cc\u6668\u57f7\u884c\uff09\nschedule, created = CrontabSchedule.objects.get_or_create(\n    hour=0,\n    minute=0,\n)\n\n# \u5275\u5efa\u5b9a\u6642\u4efb\u52d9\nPeriodicTask.objects.create(\n    name='Daily Persistent Task',\n    task='app.tasks.my_persistent_task',\n    crontab=schedule,\n    args=json.dumps(['param1', 'param2']),\n)\n</code></pre></p>"},{"location":"celery-beat/persistent-scheduler/#_4","title":"\u5176\u4ed6\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u9078\u9805","text":"<p>\u9664\u4e86 <code>django-celery-beat</code>\uff0cCelery Beat \u9084\u652f\u63f4\u5176\u4ed6\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u5be6\u73fe\uff1a - ShelveScheduler\uff1a\u4f7f\u7528 Python \u7684 <code>shelve</code> \u6a21\u7d44\u5b58\u5132\u8abf\u5ea6\u4fe1\u606f\u5230\u6587\u4ef6\uff0c\u9069\u5408\u7c21\u55ae\u5834\u666f\u3002   <pre><code>celery -A app beat --scheduler=celery.beat:ShelveScheduler --schedule=/path/to/schedule.db\n</code></pre> - RedisScheduler\uff1a\u4f7f\u7528 Redis \u4f5c\u70ba\u8abf\u5ea6\u5b58\u5132\uff0c\u9069\u5408\u5206\u4f48\u5f0f\u74b0\u5883\uff08\u9700\u984d\u5916\u5957\u4ef6\u652f\u63f4\uff09\u3002 - \u81ea\u5b9a\u7fa9\u8abf\u5ea6\u5668\uff1a\u60a8\u53ef\u4ee5\u5be6\u73fe\u81ea\u5df1\u7684\u8abf\u5ea6\u5668\u985e\uff0c\u6eff\u8db3\u7279\u5b9a\u9700\u6c42\u3002</p>"},{"location":"celery-beat/persistent-scheduler/#_5","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u5206\u4f48\u5f0f\u90e8\u7f72\uff1a\u5728\u591a\u7bc0\u9ede\u74b0\u5883\u4e2d\u4f7f\u7528\u6578\u64da\u5eab\u4f5c\u70ba\u7d71\u4e00\u8abf\u5ea6\u5b58\u5132\uff0c\u907f\u514d\u8abf\u5ea6\u885d\u7a81\u3002   <pre><code>CELERY_BEAT_SCHEDULER = 'django_celery_beat.schedulers:DatabaseScheduler'\n</code></pre></li> <li>\u9ad8\u53ef\u7528\u6027\uff1a\u78ba\u4fdd\u8abf\u5ea6\u4fe1\u606f\u5728\u670d\u52d9\u91cd\u555f\u6216\u6545\u969c\u5f8c\u4ecd\u53ef\u6062\u5fa9\u3002</li> <li>\u7ba1\u7406\u4ecb\u9762\uff1a\u901a\u904e Django Admin \u63d0\u4f9b\u53cb\u597d\u7684\u8abf\u5ea6\u7ba1\u7406\u4ecb\u9762\uff0c\u65b9\u4fbf\u975e\u6280\u8853\u4eba\u54e1\u64cd\u4f5c\u3002</li> </ul>"},{"location":"celery-beat/persistent-scheduler/#_6","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6578\u64da\u5eab\u6548\u80fd\uff1a\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u4f9d\u8cf4\u6578\u64da\u5eab\uff0c\u983b\u7e41\u7684\u8abf\u5ea6\u67e5\u8a62\u53ef\u80fd\u5f71\u97ff\u6548\u80fd\uff0c\u5efa\u8b70\u4f7f\u7528\u9ad8\u6548\u6578\u64da\u5eab\uff08\u5982 PostgreSQL\uff09\u4e26\u8a2d\u7f6e\u7d22\u5f15\u3002</li> <li>\u55ae\u4e00\u8abf\u5ea6\u5668\u5be6\u4f8b\uff1a\u907f\u514d\u591a\u500b Celery Beat \u5be6\u4f8b\u540c\u6642\u904b\u884c\u76f8\u540c\u7684\u8abf\u5ea6\u5668\uff0c\u53ef\u80fd\u5c0e\u81f4\u4efb\u52d9\u91cd\u8907\u57f7\u884c\u3002\u53ef\u4ee5\u4f7f\u7528\u9396\u6a5f\u5236\uff08\u5982 <code>django-celery-beat</code> \u7684\u5167\u5efa\u9396\uff09\u3002</li> <li>\u5099\u4efd\u8207\u6062\u5fa9\uff1a\u5b9a\u671f\u5099\u4efd\u8abf\u5ea6\u6578\u64da\u5eab\uff0c\u907f\u514d\u6578\u64da\u4e1f\u5931\u5c0e\u81f4\u8abf\u5ea6\u4e2d\u65b7\u3002</li> </ul>"},{"location":"celery-beat/persistent-scheduler/#_7","title":"\u5c0f\u7d50","text":"<p>\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u662f Celery Beat \u5728\u5206\u4f48\u5f0f\u8207\u9ad8\u53ef\u7528\u6027\u5834\u666f\u4e2d\u7684\u91cd\u8981\u529f\u80fd\uff0c\u901a\u904e\u5c07\u8abf\u5ea6\u4fe1\u606f\u5b58\u5132\u5728\u6578\u64da\u5eab\u6216\u5176\u4ed6\u6301\u4e45\u5316\u5b58\u5132\u4e2d\uff0c\u60a8\u53ef\u4ee5\u78ba\u4fdd\u8abf\u5ea6\u7684\u53ef\u9760\u6027\u8207\u53ef\u7ba1\u7406\u6027\u3002\u672c\u7ae0\u7bc0\u7d50\u675f\u4e86\u300cCelery Beat\u300d\u7684\u5b78\u7fd2\uff0c\u60a8\u5df2\u638c\u63e1\u5b9a\u6642\u4efb\u52d9\u914d\u7f6e\u3001Crontab \u8868\u9054\u5f0f\u3001\u52d5\u614b\u8abf\u5ea6\u8207\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u7684\u6838\u5fc3\u6280\u8853\u3002</p> <p>\u63d0\u793a\uff1a\u9078\u64c7\u6301\u4e45\u5316\u8abf\u5ea6\u5668\u6642\uff0c\u6839\u64da\u7cfb\u7d71\u898f\u6a21\u8207\u9700\u6c42\u9078\u64c7\u5408\u9069\u7684\u5b58\u5132\u5f8c\u7aef\uff0c\u907f\u514d\u904e\u5ea6\u8907\u96dc\u5316\u914d\u7f6e\u3002</p>"},{"location":"celery-beat/scheduled-tasks/","title":"\u5b9a\u6642\u4efb\u52d9\u914d\u7f6e","text":"<p>Celery Beat \u662f\u7528\u65bc\u5b9a\u6642\u4efb\u52d9\u8abf\u5ea6\u7684\u64f4\u5c55\u5de5\u5177\uff0c\u672c\u6587\u5c07\u4ecb\u7d39\u5982\u4f55\u5b89\u88dd\u8207\u914d\u7f6e Celery Beat\uff0c\u4e26\u5b9a\u7fa9\u57fa\u672c\u7684\u5b9a\u6642\u4efb\u52d9\u3002</p>"},{"location":"celery-beat/scheduled-tasks/#celery-beat","title":"\u5b89\u88dd Celery Beat","text":"<p>Celery Beat \u662f\u4e00\u500b\u7368\u7acb\u7684 Python \u5305\uff0c\u9700\u55ae\u7368\u5b89\u88dd\u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88dd\uff1a <pre><code>pip install celery[redis] celery[beat]\n</code></pre></p> <ul> <li>celery[redis]\uff1a\u78ba\u4fdd\u5b89\u88dd Redis \u652f\u63f4\uff0c\u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\u6216\u7d50\u679c\u5f8c\u7aef\u3002</li> <li>celery[beat]\uff1a\u5b89\u88dd Celery Beat \u64f4\u5c55\u3002</li> </ul>"},{"location":"celery-beat/scheduled-tasks/#celery-beat_1","title":"\u914d\u7f6e Celery Beat","text":"<p>Celery Beat \u8207 Celery \u61c9\u7528\u6574\u5408\u4f7f\u7528\uff0c\u9700\u5728 Celery \u61c9\u7528\u4e2d\u555f\u7528 Beat \u8abf\u5ea6\u529f\u80fd\u3002</p>"},{"location":"celery-beat/scheduled-tasks/#1-celery","title":"\u6b65\u9a5f 1\uff1a\u5275\u5efa Celery \u61c9\u7528","text":"<p>\u78ba\u4fdd\u60a8\u5df2\u6709\u4e00\u500b Celery \u61c9\u7528\uff0c\u914d\u7f6e\u597d\u6d88\u606f\u4ee3\u7406\u8207\u7d50\u679c\u5f8c\u7aef\uff1a <pre><code>from celery import Celery\n\napp = Celery('tasks',\n             broker='redis://localhost:6379/0',\n             backend='redis://localhost:6379/1')\n\napp.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n    timezone='UTC',\n)\n</code></pre></p>"},{"location":"celery-beat/scheduled-tasks/#2-beat","title":"\u6b65\u9a5f 2\uff1a\u914d\u7f6e Beat \u8abf\u5ea6","text":"<p>\u5275\u5efa\u4e00\u500b Beat \u914d\u7f6e\u6587\u4ef6\uff08\u4f8b\u5982 <code>beatconfig.py</code>\uff09\uff0c\u5b9a\u7fa9\u4efb\u52d9\u8abf\u5ea6\u6642\u9593\u8868\uff1a <pre><code>from celery.schedules import crontab\n\nbeat_schedule = {\n    'run-every-30-seconds': {\n        'task': 'app.tasks.my_task',  # \u6307\u5b9a\u4efb\u52d9\u8def\u5f91\n        'schedule': 30.0,  # \u6bcf 30 \u79d2\u57f7\u884c\u4e00\u6b21\n        'args': (arg1, arg2),  # \u4efb\u52d9\u53c3\u6578\uff0c\u53ef\u9078\n    },\n    'run-daily-at-midnight': {\n        'task': 'app.tasks.daily_report',\n        'schedule': crontab(hour=0, minute=0),  # \u6bcf\u5929\u51cc\u6668\u57f7\u884c\n    },\n}\n</code></pre></p> <ul> <li>beat_schedule\uff1a\u5b9a\u7fa9\u4efb\u52d9\u8abf\u5ea6\u6642\u9593\u8868\uff0c\u6bcf\u500b\u4efb\u52d9\u5305\u542b\u4efb\u52d9\u8def\u5f91\u3001\u57f7\u884c\u6642\u9593\u8868\u8207\u53ef\u9078\u53c3\u6578\u3002</li> <li>schedule\uff1a\u53ef\u4ee5\u662f\u6d6e\u9ede\u6578\uff08\u79d2\u6578\u9593\u9694\uff09\u6216 Crontab \u8868\u9054\u5f0f\u3002</li> </ul>"},{"location":"celery-beat/scheduled-tasks/#3-celery-beat","title":"\u6b65\u9a5f 3\uff1a\u555f\u52d5 Celery Beat","text":"<p>\u4f7f\u7528 <code>celery beat</code> \u547d\u4ee4\u555f\u52d5\u8abf\u5ea6\u5668\uff0c\u78ba\u4fdd Celery \u5de5\u4f5c\u8005\u4e5f\u5728\u904b\u884c\uff1a <pre><code># \u555f\u52d5 Celery Beat\uff0c\u6307\u5b9a Beat \u914d\u7f6e\u6587\u4ef6\ncelery -A app beat --loglevel=info --schedule=/path/to/beat_schedule.db\n</code></pre></p> <ul> <li>-A app\uff1a\u6307\u5b9a Celery \u61c9\u7528\u6a21\u7d44\u3002</li> <li>--schedule\uff1a\u6307\u5b9a\u8abf\u5ea6\u4fe1\u606f\u5b58\u5132\u6587\u4ef6\uff08\u9810\u8a2d\u70ba SQLite \u6578\u64da\u5eab\uff09\u3002</li> </ul> <p>\u540c\u6642\uff0c\u555f\u52d5 Celery \u5de5\u4f5c\u8005\u4ee5\u57f7\u884c\u4efb\u52d9\uff1a <pre><code>celery -A app worker --loglevel=info\n</code></pre></p>"},{"location":"celery-beat/scheduled-tasks/#_2","title":"\u5b9a\u7fa9\u5b9a\u6642\u4efb\u52d9","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u500b\u7c21\u55ae\u7684\u5b9a\u6642\u4efb\u52d9\u793a\u4f8b\uff1a <pre><code>from celery import Celery\n\napp = Celery('tasks', broker='redis://localhost:6379/0')\n\n@app.task\ndef my_task(arg1, arg2):\n    print(f\"Task executed with args: {arg1}, {arg2}\")\n    return arg1 + arg2\n</code></pre></p> <p>\u5728 Beat \u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u8a72\u4efb\u52d9\u7684\u8abf\u5ea6\uff1a <pre><code>beat_schedule = {\n    'run-my-task-every-minute': {\n        'task': 'app.tasks.my_task',\n        'schedule': 60.0,  # \u6bcf 60 \u79d2\u57f7\u884c\u4e00\u6b21\n        'args': (10, 20),\n    },\n}\n</code></pre></p>"},{"location":"celery-beat/scheduled-tasks/#_3","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u5b9a\u671f\u6578\u64da\u5099\u4efd\uff1a\u6bcf\u5929\u51cc\u6668\u57f7\u884c\u6578\u64da\u5099\u4efd\u4efb\u52d9\u3002   <pre><code>beat_schedule = {\n    'backup-data-daily': {\n        'task': 'app.tasks.backup_data',\n        'schedule': crontab(hour=0, minute=0),\n    },\n}\n</code></pre></li> <li>\u5b9a\u6642\u901a\u77e5\uff1a\u6bcf\u5c0f\u6642\u5411\u7528\u6236\u767c\u9001\u63d0\u9192\u3002</li> <li>\u6578\u64da\u540c\u6b65\uff1a\u6bcf 30 \u5206\u9418\u5f9e\u5916\u90e8 API \u540c\u6b65\u6578\u64da\u3002</li> </ul>"},{"location":"celery-beat/scheduled-tasks/#_4","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6642\u9593\u540c\u6b65\uff1a\u78ba\u4fdd\u4f3a\u670d\u5668\u6642\u9593\u6b63\u78ba\uff0c\u5426\u5247\u5b9a\u6642\u4efb\u52d9\u53ef\u80fd\u504f\u96e2\u9810\u671f\u3002</li> <li>\u5de5\u4f5c\u8005\u53ef\u7528\u6027\uff1a\u78ba\u4fdd\u6709\u8db3\u5920\u7684\u5de5\u4f5c\u8005\u57f7\u884c\u5b9a\u6642\u4efb\u52d9\uff0c\u907f\u514d\u4efb\u52d9\u5806\u7a4d\u3002</li> <li>\u8abf\u5ea6\u91cd\u758a\uff1a\u907f\u514d\u4efb\u52d9\u57f7\u884c\u6642\u9593\u904e\u9577\u5c0e\u81f4\u4e0b\u4e00\u6b21\u8abf\u5ea6\u6642\u4ecd\u672a\u5b8c\u6210\uff0c\u53ef\u8a2d\u7f6e\u4efb\u52d9\u8d85\u6642\u3002</li> </ul>"},{"location":"celery-beat/scheduled-tasks/#_5","title":"\u5c0f\u7d50","text":"<p>\u901a\u904e\u5b89\u88dd\u8207\u914d\u7f6e Celery Beat\uff0c\u60a8\u53ef\u4ee5\u8f15\u9b06\u5be6\u73fe\u5b9a\u6642\u4efb\u52d9\u7684\u81ea\u52d5\u5316\u57f7\u884c\uff0c\u70ba\u696d\u52d9\u81ea\u52d5\u5316\u63d0\u4f9b\u5f37\u5927\u652f\u6301\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cCrontab \u8868\u9054\u5f0f\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u5b9a\u7fa9\u66f4\u8907\u96dc\u7684\u9031\u671f\u6027\u4efb\u52d9\u6642\u9593\u8868\u3002</p> <p>\u63d0\u793a\uff1a\u521d\u6b21\u4f7f\u7528 Celery Beat \u6642\uff0c\u5efa\u8b70\u5f9e\u7c21\u55ae\u7684\u9593\u9694\u8abf\u5ea6\u958b\u59cb\uff0c\u78ba\u4fdd\u914d\u7f6e\u6b63\u78ba\u5f8c\u518d\u5f15\u5165\u8907\u96dc\u6642\u9593\u8868\u3002</p>"},{"location":"integration/","title":"\u6574\u5408\u8207\u6700\u4f73\u5be6\u8e10","text":"<p>\u5728\u5b78\u7fd2\u4e86\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7684\u57fa\u672c\u6982\u5ff5\u3001RabbitMQ \u7684\u6838\u5fc3\u529f\u80fd\u3001Celery \u7684\u57fa\u790e\u8207\u9032\u968e\u529f\u80fd\u4ee5\u53ca Kombu \u7684\u6df1\u5165\u539f\u7406\u5f8c\uff0c\u73fe\u5728\u662f\u6642\u5019\u5c07\u9019\u4e9b\u5de5\u5177\u6574\u5408\u5230\u5be6\u969b\u9805\u76ee\u4e2d\uff0c\u4e26\u5b78\u7fd2\u5982\u4f55\u4ee5\u6700\u4f73\u65b9\u5f0f\u4f7f\u7528\u5b83\u5011\u3002\u9019\u4e00\u90e8\u5206\u5c07\u5e6b\u52a9\u60a8\u7406\u89e3\u5982\u4f55\u5c07 Celery\u3001Kombu \u548c RabbitMQ \u8207\u5176\u4ed6\u7cfb\u7d71\u7d50\u5408\uff0c\u540c\u6642\u63d0\u4f9b\u5be6\u7528\u7684\u5efa\u8b70\u4f86\u512a\u5316\u6027\u80fd\u3001\u78ba\u4fdd\u53ef\u9760\u6027\uff0c\u4e26\u907f\u514d\u5e38\u898b\u7684\u554f\u984c\u3002</p> <p>\u672c\u7ae0\u7bc0\u5c07\u6db5\u84cb\u4ee5\u4e0b\u4e3b\u984c\uff1a</p> <ul> <li>\u5982\u4f55\u5c07 Celery \u8207 Web \u6846\u67b6\uff08\u5982 Flask\u3001Django\uff09\u6574\u5408</li> <li>\u76e3\u63a7\u548c\u65e5\u8a8c\u8a18\u9304\u7684\u6700\u4f73\u5be6\u8e10</li> <li>\u6027\u80fd\u512a\u5316\u6280\u5de7</li> <li>\u64f4\u5c55\u6027\u8a2d\u8a08\u4ee5\u61c9\u5c0d\u5927\u898f\u6a21\u4efb\u52d9</li> <li>\u9ad8\u53ef\u7528\u6027\u914d\u7f6e\u4ee5\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u6027</li> </ul>"},{"location":"integration/#_2","title":"\u5167\u5bb9\u5c0e\u89bd","text":"<ul> <li>Celery \u8207 Web \u6846\u67b6\u6574\u5408</li> <li>\u76e3\u63a7\u8207\u65e5\u8a8c</li> <li>\u6027\u80fd\u512a\u5316</li> <li>\u64f4\u5c55\u6027\u8a2d\u8a08</li> <li>\u9ad8\u53ef\u7528\u914d\u7f6e</li> </ul>"},{"location":"integration/high-availability/","title":"\u9ad8\u53ef\u7528\u914d\u7f6e","text":"<p>\u5728\u751f\u7522\u74b0\u5883\u4e2d\uff0c\u78ba\u4fdd Celery\u3001Kombu \u548c RabbitMQ \u7cfb\u7d71\u7684\u9ad8\u53ef\u7528\u6027\uff08High Availability, HA\uff09\u81f3\u95dc\u91cd\u8981\uff0c\u4ee5\u907f\u514d\u55ae\u9ede\u6545\u969c\u5c0e\u81f4\u7684\u670d\u52d9\u4e2d\u65b7\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u914d\u7f6e\u9019\u4e9b\u5de5\u5177\u4ee5\u5be6\u73fe\u9ad8\u53ef\u7528\u6027\uff0c\u5f9e\u5197\u9918\u8a2d\u8a08\u5230\u6545\u969c\u6062\u5fa9\uff0c\u63d0\u4f9b\u5177\u9ad4\u7684\u5efa\u8b70\u3002</p>"},{"location":"integration/high-availability/#_2","title":"\u9ad8\u53ef\u7528\u6027\u57fa\u790e","text":"<p>\u9ad8\u53ef\u7528\u6027\u7684\u76ee\u6a19\u662f\u78ba\u4fdd\u7cfb\u7d71\u5728\u9762\u5c0d\u786c\u9ad4\u6545\u969c\u3001\u7db2\u7d61\u554f\u984c\u6216\u8edf\u9ad4\u932f\u8aa4\u6642\u4ecd\u80fd\u6b63\u5e38\u904b\u884c\u3002</p>"},{"location":"integration/high-availability/#_3","title":"\u5197\u9918\u8a2d\u8a08","text":"<p>\u5197\u9918\u662f\u9ad8\u53ef\u7528\u6027\u7684\u6838\u5fc3\uff0c\u901a\u904e\u591a\u7bc0\u9ede\u90e8\u7f72\u907f\u514d\u55ae\u9ede\u6545\u969c\uff1a</p> <ul> <li>Celery Worker\uff1a\u5728\u591a\u53f0\u4f3a\u670d\u5668\u4e0a\u904b\u884c\u591a\u500b Worker\u3002</li> <li>RabbitMQ\uff1a\u90e8\u7f72\u96c6\u7fa4\uff0c\u78ba\u4fdd\u6d88\u606f\u4ee3\u7406\u53ef\u7528\u3002</li> <li>\u7d50\u679c\u5f8c\u7aef\uff1a\u4f7f\u7528\u5177\u6709\u5197\u9918\u529f\u80fd\u7684\u5f8c\u7aef\uff08\u5982 Redis \u96c6\u7fa4\uff09\u3002</li> </ul>"},{"location":"integration/high-availability/#_4","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u6bcf\u500b\u7d44\u4ef6\u81f3\u5c11\u6709\u5169\u500b\u5be6\u4f8b\uff0c\u5206\u5e03\u5728\u4e0d\u540c\u786c\u9ad4\u6216\u53ef\u7528\u5340\u3002</li> <li>\u4f7f\u7528\u8ca0\u8f09\u5747\u8861\u5668\u5206\u767c\u6d41\u91cf\uff0c\u907f\u514d\u55ae\u4e00\u5165\u53e3\u9ede\u6545\u969c\u3002</li> </ul>"},{"location":"integration/high-availability/#_5","title":"\u6545\u969c\u6aa2\u6e2c\u8207\u5207\u63db","text":"<p>\u5feb\u901f\u6aa2\u6e2c\u6545\u969c\u4e26\u5207\u63db\u5230\u5099\u7528\u8cc7\u6e90\u662f\u9ad8\u53ef\u7528\u6027\u7684\u95dc\u9375\u3002</p>"},{"location":"integration/high-availability/#_6","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u76e3\u63a7\u5de5\u5177\uff08\u5982 Prometheus\uff09\u6aa2\u6e2c\u7d44\u4ef6\u72c0\u614b\uff0c\u8a2d\u5b9a\u544a\u8b66\u3002</li> <li>\u914d\u7f6e\u81ea\u52d5\u5207\u63db\u6a5f\u5236\uff0c\u4f8b\u5982 RabbitMQ \u96c6\u7fa4\u7684\u93e1\u50cf\u968a\u5217\u3002</li> </ul>"},{"location":"integration/high-availability/#rabbitmq","title":"RabbitMQ \u9ad8\u53ef\u7528\u914d\u7f6e","text":"<p>RabbitMQ \u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\uff0c\u5176\u53ef\u7528\u6027\u76f4\u63a5\u5f71\u97ff\u6574\u9ad4\u7cfb\u7d71\u3002</p>"},{"location":"integration/high-availability/#_7","title":"\u96c6\u7fa4\u914d\u7f6e","text":"<p>RabbitMQ \u96c6\u7fa4\u5141\u8a31\u591a\u500b\u7bc0\u9ede\u5354\u540c\u5de5\u4f5c\uff0c\u7576\u67d0\u500b\u7bc0\u9ede\u6545\u969c\u6642\uff0c\u5176\u4ed6\u7bc0\u9ede\u53ef\u4ee5\u63a5\u7ba1\uff1a</p>"},{"location":"integration/high-availability/#_8","title":"\u8a2d\u5b9a\u6b65\u9a5f","text":"<ol> <li>\u5728\u591a\u53f0\u4f3a\u670d\u5668\u4e0a\u5b89\u88dd RabbitMQ\u3002</li> <li>\u914d\u7f6e\u96c6\u7fa4\uff0c\u4f7f\u7bc0\u9ede\u5171\u4eab\u76f8\u540c\u7684 Erlang Cookie \u548c hostname\uff08\u53c3\u8003\u5b98\u65b9\u6587\u6a94\uff09\u3002</li> <li>\u555f\u7528\u93e1\u50cf\u968a\u5217\uff0c\u78ba\u4fdd\u6d88\u606f\u5728\u591a\u500b\u7bc0\u9ede\u4e0a\u5099\u4efd\uff1a</li> </ol> <pre><code>rabbitmqctl set_policy ha-all \"^\" '{\"ha-mode\":\"all\"}'\n</code></pre>"},{"location":"integration/high-availability/#_9","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u96c6\u7fa4\u7bc0\u9ede\u6578\u91cf\u70ba\u5947\u6578\uff08\u5982 3 \u6216 5\uff09\uff0c\u907f\u514d\u8166\u88c2\u554f\u984c\u3002</li> <li>\u914d\u7f6e\u5ba2\u6236\u7aef\u81ea\u52d5\u91cd\u9023\uff0c\u907f\u514d\u56e0\u55ae\u7bc0\u9ede\u6545\u969c\u5c0e\u81f4\u9023\u63a5\u4e2d\u65b7\u3002</li> </ul>"},{"location":"integration/high-availability/#_10","title":"\u8ca0\u8f09\u5747\u8861","text":"<p>\u4f7f\u7528\u8ca0\u8f09\u5747\u8861\u5668\uff08\u5982 HAProxy \u6216 Nginx\uff09\u5206\u767c\u5ba2\u6236\u7aef\u9023\u63a5\u5230 RabbitMQ \u96c6\u7fa4\uff1a</p>"},{"location":"integration/high-availability/#haproxy","title":"\u914d\u7f6e\u793a\u4f8b\uff08HAProxy\uff09","text":"<pre><code>frontend rabbitmq_frontend\n    bind *:5672\n    default_backend rabbitmq_backend\n\nbackend rabbitmq_backend\n    balance roundrobin\n    server rabbit1 192.168.1.101:5672 check\n    server rabbit2 192.168.1.102:5672 check\n    server rabbit3 192.168.1.103:5672 check\n</code></pre>"},{"location":"integration/high-availability/#_11","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u5065\u5eb7\u6aa2\u67e5\uff0c\u78ba\u4fdd\u53ea\u5c07\u6d41\u91cf\u5c0e\u5411\u6b63\u5e38\u7bc0\u9ede\u3002</li> <li>\u76e3\u63a7\u8ca0\u8f09\u5747\u8861\u5668\u6027\u80fd\uff0c\u907f\u514d\u5176\u6210\u70ba\u74f6\u9838\u3002</li> </ul>"},{"location":"integration/high-availability/#celery-worker","title":"Celery Worker \u9ad8\u53ef\u7528\u914d\u7f6e","text":"<p>Celery Worker \u8ca0\u8cac\u4efb\u52d9\u57f7\u884c\uff0c\u78ba\u4fdd\u5176\u9ad8\u53ef\u7528\u6027\u53ef\u4ee5\u907f\u514d\u4efb\u52d9\u8655\u7406\u4e2d\u65b7\u3002</p>"},{"location":"integration/high-availability/#worker","title":"\u591a Worker \u90e8\u7f72","text":"<p>\u5728\u591a\u53f0\u4f3a\u670d\u5668\u4e0a\u904b\u884c Worker\uff0c\u78ba\u4fdd\u5373\u4f7f\u90e8\u5206 Worker \u6545\u969c\uff0c\u7cfb\u7d71\u4ecd\u80fd\u8655\u7406\u4efb\u52d9\uff1a</p> <pre><code>celery -A your_module worker --concurrency=4 -n worker1@host1\ncelery -A your_module worker --concurrency=4 -n worker2@host2\n</code></pre>"},{"location":"integration/high-availability/#_12","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c07 Worker \u5206\u5e03\u5728\u4e0d\u540c\u53ef\u7528\u5340\u6216\u6578\u64da\u4e2d\u5fc3\uff0c\u964d\u4f4e\u5340\u57df\u6027\u6545\u969c\u98a8\u96aa\u3002</li> <li>\u4f7f\u7528\u76e3\u63a7\u5de5\u5177\u6aa2\u67e5 Worker \u72c0\u614b\uff0c\u81ea\u52d5\u91cd\u555f\u6545\u969c Worker\u3002</li> </ul>"},{"location":"integration/high-availability/#_13","title":"\u4efb\u52d9\u91cd\u8a66\u8207\u932f\u8aa4\u8655\u7406","text":"<p>\u8a2d\u5b9a\u4efb\u52d9\u91cd\u8a66\u6a5f\u5236\uff0c\u78ba\u4fdd\u4efb\u52d9\u5728 Worker \u6545\u969c\u6642\u4ecd\u80fd\u5b8c\u6210\uff1a</p> <pre><code>@task(retry_backoff=True, retry_jitter=True, max_retries=3)\ndef unreliable_task():\n    # \u6a21\u64ec\u4e0d\u53ef\u9760\u4efb\u52d9\n    pass\n</code></pre>"},{"location":"integration/high-availability/#_14","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u70ba\u95dc\u9375\u4efb\u52d9\u8a2d\u5b9a\u91cd\u8a66\u7b56\u7565\uff0c\u907f\u514d\u56e0\u81e8\u6642\u6545\u969c\u5931\u6557\u3002</li> <li>\u8a18\u9304\u91cd\u8a66\u65e5\u8a8c\uff0c\u65b9\u4fbf\u6392\u67e5\u554f\u984c\u3002</li> </ul>"},{"location":"integration/high-availability/#_15","title":"\u7d50\u679c\u5f8c\u7aef\u9ad8\u53ef\u7528\u914d\u7f6e","text":"<p>\u7d50\u679c\u5f8c\u7aef\u5132\u5b58\u4efb\u52d9\u7d50\u679c\uff0c\u5176\u53ef\u7528\u6027\u5f71\u97ff\u4efb\u52d9\u72c0\u614b\u67e5\u8a62\u3002</p>"},{"location":"integration/high-availability/#_16","title":"\u4f7f\u7528\u9ad8\u53ef\u7528\u5f8c\u7aef","text":"<p>\u9078\u64c7\u652f\u6301\u9ad8\u53ef\u7528\u7684\u7d50\u679c\u5f8c\u7aef\uff0c\u5982 Redis \u96c6\u7fa4\u6216\u8cc7\u6599\u5eab\u96c6\u7fa4\uff1a</p>"},{"location":"integration/high-availability/#redis","title":"Redis \u96c6\u7fa4\u8a2d\u5b9a","text":"<ol> <li>\u90e8\u7f72 Redis \u96c6\u7fa4\uff0c\u5305\u542b\u4e3b\u7bc0\u9ede\u548c\u5f9e\u7bc0\u9ede\u3002</li> <li>\u914d\u7f6e Celery \u4f7f\u7528 Redis \u96c6\u7fa4\uff1a</li> </ol> <pre><code>app.conf.result_backend = 'redis://:password@host1:6379,host2:6379/0'\n</code></pre>"},{"location":"integration/high-availability/#_17","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u78ba\u4fdd\u7d50\u679c\u5f8c\u7aef\u652f\u6301\u81ea\u52d5\u6545\u969c\u5207\u63db\u3002</li> <li>\u5b9a\u671f\u5099\u4efd\u7d50\u679c\u6578\u64da\uff0c\u907f\u514d\u6578\u64da\u4e1f\u5931\u3002</li> </ul>"},{"location":"integration/high-availability/#_18","title":"\u7d50\u679c\u904e\u671f\u8207\u6e05\u7406","text":"<p>\u8a2d\u5b9a\u7d50\u679c\u904e\u671f\u6642\u9593\uff0c\u907f\u514d\u5f8c\u7aef\u8cc7\u6e90\u8017\u76e1\uff1a</p> <pre><code>app.conf.result_expires = 3600  # \u7d50\u679c1\u5c0f\u6642\u5f8c\u904e\u671f\n</code></pre>"},{"location":"integration/high-availability/#_19","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u81ea\u52d5\u5316\u6e05\u7406\u904e\u671f\u7d50\u679c\uff0c\u4fdd\u6301\u5f8c\u7aef\u9ad8\u6548\u904b\u884c\u3002</li> <li>\u76e3\u63a7\u5f8c\u7aef\u8cc7\u6e90\u4f7f\u7528\u60c5\u6cc1\uff0c\u53ca\u6642\u64f4\u5c55\u5bb9\u91cf\u3002</li> </ul>"},{"location":"integration/high-availability/#_20","title":"\u6545\u969c\u6062\u5fa9\u8207\u5099\u4efd","text":"<p>\u9ad8\u53ef\u7528\u7cfb\u7d71\u9700\u8981\u5b8c\u5584\u7684\u6545\u969c\u6062\u5fa9\u548c\u5099\u4efd\u7b56\u7565\uff0c\u78ba\u4fdd\u5728\u707d\u96e3\u767c\u751f\u6642\u80fd\u5feb\u901f\u6062\u5fa9\u3002</p>"},{"location":"integration/high-availability/#rabbitmq_1","title":"RabbitMQ \u6578\u64da\u5099\u4efd","text":"<p>\u5b9a\u671f\u5099\u4efd RabbitMQ \u7684\u6578\u64da\u548c\u914d\u7f6e\uff0c\u78ba\u4fdd\u5728\u7bc0\u9ede\u6545\u969c\u6642\u80fd\u6062\u5fa9\uff1a</p>"},{"location":"integration/high-availability/#_21","title":"\u5099\u4efd\u6b65\u9a5f","text":"<ol> <li>\u5099\u4efd RabbitMQ \u7684\u6578\u64da\u76ee\u9304\uff08\u901a\u5e38\u4f4d\u65bc <code>/var/lib/rabbitmq</code>\uff09\u3002</li> <li>\u5099\u4efd\u914d\u7f6e\u6587\u4ef6\uff08\u901a\u5e38\u4f4d\u65bc <code>/etc/rabbitmq</code>\uff09\u3002</li> </ol>"},{"location":"integration/high-availability/#_22","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c07\u5099\u4efd\u6578\u64da\u5132\u5b58\u5728\u7570\u5730\uff0c\u907f\u514d\u55ae\u4e00\u6578\u64da\u4e2d\u5fc3\u6545\u969c\u5f71\u97ff\u6062\u5fa9\u3002</li> <li>\u5b9a\u671f\u6e2c\u8a66\u5099\u4efd\u6062\u5fa9\u6d41\u7a0b\uff0c\u78ba\u4fdd\u6578\u64da\u5b8c\u6574\u6027\u3002</li> </ul>"},{"location":"integration/high-availability/#celery","title":"Celery \u4efb\u52d9\u6062\u5fa9","text":"<p>\u5c0d\u65bc\u95dc\u9375\u4efb\u52d9\uff0c\u78ba\u4fdd\u4efb\u52d9\u53ef\u4ee5\u5728 Worker \u6545\u969c\u5f8c\u91cd\u65b0\u57f7\u884c\uff1a</p> <pre><code>app.conf.task_track_started = True  # \u8ffd\u8e64\u4efb\u52d9\u958b\u59cb\u72c0\u614b\napp.conf.task_ignore_result = False  # \u4fdd\u7559\u4efb\u52d9\u7d50\u679c\n</code></pre>"},{"location":"integration/high-availability/#_23","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u76e3\u63a7\u5de5\u5177\u6aa2\u6e2c\u672a\u5b8c\u6210\u4efb\u52d9\uff0c\u81ea\u52d5\u91cd\u65b0\u6392\u968a\u3002</li> <li>\u70ba\u9577\u6642\u9593\u4efb\u52d9\u8a2d\u5b9a\u6aa2\u67e5\u9ede\uff0c\u5141\u8a31\u5f9e\u4e2d\u65b7\u9ede\u6062\u5fa9\u3002</li> </ul>"},{"location":"integration/high-availability/#_24","title":"\u81ea\u52d5\u5316\u6545\u969c\u6062\u5fa9","text":"<p>\u4f7f\u7528\u81ea\u52d5\u5316\u5de5\u5177\uff08\u5982 Kubernetes\uff09\u7ba1\u7406\u7d44\u4ef6\uff0c\u5be6\u73fe\u6545\u969c\u81ea\u52d5\u6062\u5fa9\uff1a</p>"},{"location":"integration/high-availability/#kubernetes","title":"Kubernetes \u914d\u7f6e\u793a\u4f8b","text":"<ol> <li>\u70ba Celery Worker \u548c RabbitMQ \u8a2d\u5b9a Pod \u91cd\u555f\u7b56\u7565\u3002</li> <li>\u914d\u7f6e\u5065\u5eb7\u6aa2\u67e5\uff0c\u78ba\u4fdd\u50c5\u904b\u884c\u5065\u5eb7\u7684\u5be6\u4f8b\u3002</li> </ol>"},{"location":"integration/high-availability/#_25","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u5408\u7406\u7684\u91cd\u555f\u5ef6\u9072\uff0c\u907f\u514d\u983b\u7e41\u91cd\u555f\u5c0e\u81f4\u7cfb\u7d71\u4e0d\u7a69\u5b9a\u3002</li> <li>\u8a18\u9304\u6545\u969c\u6062\u5fa9\u65e5\u8a8c\uff0c\u5206\u6790\u554f\u984c\u6839\u56e0\u3002</li> </ul>"},{"location":"integration/high-availability/#_26","title":"\u5b89\u5168\u6027\u8207\u9ad8\u53ef\u7528\u6027","text":"<p>\u9ad8\u53ef\u7528\u7cfb\u7d71\u9700\u8981\u8003\u616e\u5b89\u5168\u6027\uff0c\u907f\u514d\u56e0\u5b89\u5168\u554f\u984c\u5c0e\u81f4\u670d\u52d9\u4e2d\u65b7\u3002</p>"},{"location":"integration/high-availability/#_27","title":"\u8a2a\u554f\u63a7\u5236","text":"<p>\u9650\u5236\u5c0d RabbitMQ \u548c Celery \u7d44\u4ef6\u7684\u8a2a\u554f\uff0c\u9632\u6b62\u672a\u6388\u6b0a\u64cd\u4f5c\uff1a</p>"},{"location":"integration/high-availability/#rabbitmq_2","title":"RabbitMQ \u8a2a\u554f\u63a7\u5236","text":"<ul> <li>\u5275\u5efa\u5c08\u7528\u7528\u6236\uff0c\u7981\u7528\u9ed8\u8a8d <code>guest</code> \u5e33\u6236\uff1a</li> </ul> <pre><code>rabbitmqctl delete_user guest\nrabbitmqctl add_user myuser mypassword\nrabbitmqctl set_permissions -p / myuser \".*\" \".*\" \".*\"\n</code></pre>"},{"location":"integration/high-availability/#_28","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u5f37\u5bc6\u78bc\u548c\u89d2\u8272\u5206\u96e2\uff0c\u9650\u5236\u7528\u6236\u6b0a\u9650\u3002</li> <li>\u5b9a\u671f\u5be9\u6838\u8a2a\u554f\u65e5\u8a8c\uff0c\u767c\u73fe\u7570\u5e38\u884c\u70ba\u3002</li> </ul>"},{"location":"integration/high-availability/#_29","title":"\u6578\u64da\u52a0\u5bc6","text":"<p>\u78ba\u4fdd\u6d88\u606f\u548c\u9023\u63a5\u7684\u5b89\u5168\uff0c\u4f7f\u7528 SSL/TLS \u52a0\u5bc6\u901a\u4fe1\uff1a</p>"},{"location":"integration/high-availability/#rabbitmq-ssl","title":"RabbitMQ SSL \u914d\u7f6e","text":"<ol> <li>\u751f\u6210 SSL \u8b49\u66f8\u4e26\u914d\u7f6e RabbitMQ\uff08\u53c3\u8003\u5b98\u65b9\u6587\u6a94\uff09\u3002</li> <li>\u914d\u7f6e Celery \u548c Kombu \u4f7f\u7528 SSL \u9023\u63a5\uff1a</li> </ol> <pre><code>app.conf.broker_url = 'amqp://user:pass@host:5672//?ssl=true'\n</code></pre>"},{"location":"integration/high-availability/#_30","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5b9a\u671f\u66f4\u65b0\u8b49\u66f8\uff0c\u907f\u514d\u4f7f\u7528\u904e\u671f\u8b49\u66f8\u3002</li> <li>\u78ba\u4fdd\u6240\u6709\u7d44\u4ef6\u652f\u6301\u52a0\u5bc6\u9023\u63a5\uff0c\u907f\u514d\u660e\u6587\u50b3\u8f38\u3002</li> </ul>"},{"location":"integration/high-availability/#_31","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u5197\u9918\u8207\u5206\u5e03\uff1a\u901a\u904e\u591a\u7bc0\u9ede\u90e8\u7f72\u548c\u5730\u7406\u5206\u5e03\u5be6\u73fe\u9ad8\u53ef\u7528\u6027\u3002</li> <li>\u81ea\u52d5\u5316\u6062\u5fa9\uff1a\u4f7f\u7528\u5de5\u5177\u548c\u7b56\u7565\u5be6\u73fe\u6545\u969c\u81ea\u52d5\u6aa2\u6e2c\u548c\u6062\u5fa9\u3002</li> <li>\u5099\u4efd\u8207\u6e2c\u8a66\uff1a\u5b9a\u671f\u5099\u4efd\u6578\u64da\u4e26\u6e2c\u8a66\u6062\u5fa9\u6d41\u7a0b\uff0c\u78ba\u4fdd\u707d\u96e3\u6642\u80fd\u5feb\u901f\u97ff\u61c9\u3002</li> <li>\u5b89\u5168\u8207\u7a69\u5b9a\uff1a\u5728\u8ffd\u6c42\u9ad8\u53ef\u7528\u6027\u7684\u540c\u6642\uff0c\u78ba\u4fdd\u7cfb\u7d71\u5b89\u5168\uff0c\u907f\u514d\u65b0\u6f0f\u6d1e\u3002</li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u9ad8\u53ef\u7528\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u69cb\u5efa\u4e00\u500b\u7a69\u5065\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\uff0c\u61c9\u5c0d\u5404\u7a2e\u6545\u969c\u5834\u666f\uff0c\u78ba\u4fdd\u670d\u52d9\u9023\u7e8c\u6027\u3002</p>"},{"location":"integration/monitoring-logging/","title":"\u76e3\u63a7\u8207\u65e5\u8a8c","text":"<p>\u5728\u751f\u7522\u74b0\u5883\u4e2d\uff0c\u76e3\u63a7 Celery\u3001Kombu \u548c RabbitMQ \u7684\u904b\u884c\u72c0\u614b\u4ee5\u53ca\u8a18\u9304\u8a73\u7d30\u7684\u65e5\u8a8c\u662f\u78ba\u4fdd\u7cfb\u7d71\u7a69\u5b9a\u6027\u548c\u5feb\u901f\u6392\u67e5\u554f\u984c\u7684\u95dc\u9375\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u8a2d\u5b9a\u76e3\u63a7\u5de5\u5177\u548c\u65e5\u8a8c\u7cfb\u7d71\uff0c\u4ee5\u4fbf\u60a8\u80fd\u53ca\u6642\u767c\u73fe\u554f\u984c\u4e26\u512a\u5316\u7cfb\u7d71\u6027\u80fd\u3002</p>"},{"location":"integration/monitoring-logging/#celery","title":"Celery \u76e3\u63a7\u5de5\u5177","text":"<p>Celery \u63d0\u4f9b\u4e86\u591a\u7a2e\u76e3\u63a7\u5de5\u5177\uff0c\u5e6b\u52a9\u60a8\u8ffd\u8e64\u4efb\u52d9\u72c0\u614b\u3001Worker \u904b\u884c\u72c0\u6cc1\u548c\u968a\u5217\u5065\u5eb7\u3002</p>"},{"location":"integration/monitoring-logging/#flower","title":"\u4f7f\u7528 Flower \u9032\u884c\u76e3\u63a7","text":"<p>Flower \u662f\u4e00\u500b\u57fa\u65bc Web \u7684 Celery \u76e3\u63a7\u5de5\u5177\uff0c\u63d0\u4f9b\u5373\u6642\u7684\u4efb\u52d9\u72c0\u614b\u3001Worker \u72c0\u614b\u548c\u968a\u5217\u8cc7\u8a0a\u3002</p>"},{"location":"integration/monitoring-logging/#_2","title":"\u5b89\u88dd\u8207\u555f\u52d5","text":"<pre><code>pip install flower\ncelery -A your_module flower --port=5555\n</code></pre> <p>\u555f\u52d5\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5728 <code>http://localhost:5555</code> \u8a2a\u554f Flower \u7684 Web \u4ecb\u9762\u3002</p>"},{"location":"integration/monitoring-logging/#_3","title":"\u4e3b\u8981\u529f\u80fd","text":"<ul> <li>\u4efb\u52d9\u72c0\u614b\uff1a\u67e5\u770b\u4efb\u52d9\u7684\u57f7\u884c\u72c0\u614b\uff08\u6210\u529f\u3001\u5931\u6557\u3001\u91cd\u8a66\u4e2d\uff09\u3002</li> <li>Worker \u76e3\u63a7\uff1a\u6aa2\u67e5 Worker \u7684\u5728\u7dda\u72c0\u614b\u548c\u8655\u7406\u4efb\u52d9\u6578\u91cf\u3002</li> <li>\u968a\u5217\u8cc7\u8a0a\uff1a\u67e5\u770b\u968a\u5217\u4e2d\u7684\u4efb\u52d9\u6578\u91cf\uff0c\u907f\u514d\u7a4d\u58d3\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#_4","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5728\u751f\u7522\u74b0\u5883\u4e2d\uff0c\u8a2d\u5b9a Flower \u7684\u8a8d\u8b49\u529f\u80fd\uff0c\u907f\u514d\u672a\u6388\u6b0a\u8a2a\u554f\uff1a</li> </ul> <pre><code>celery -A your_module flower --basic_auth=user:password\n</code></pre> <ul> <li>\u5b9a\u671f\u6aa2\u67e5\u968a\u5217\u9577\u5ea6\uff0c\u8a2d\u5b9a\u544a\u8b66\u4ee5\u907f\u514d\u4efb\u52d9\u7a4d\u58d3\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#celery-events","title":"\u4f7f\u7528 Celery Events","text":"<p>Celery Events \u662f\u4e00\u500b\u5167\u5efa\u7684\u4e8b\u4ef6\u7cfb\u7d71\uff0c\u5141\u8a31\u60a8\u76e3\u807d\u4efb\u52d9\u548c Worker \u7684\u4e8b\u4ef6\u3002</p>"},{"location":"integration/monitoring-logging/#_5","title":"\u4f7f\u7528\u793a\u4f8b","text":"<pre><code>from celery import Celery\nfrom celery.events import EventReceiver\n\napp = Celery('tasks', broker='amqp://localhost')\n\ndef my_monitor(app):\n    state = app.events.State()\n\n    def on_event(event):\n        state.event(event)\n        task = state.tasks.get(event['uuid'])\n        print(f\"\u4efb\u52d9 {task.name} \u72c0\u614b\uff1a{task.state}\")\n\n    with app.connection() as connection:\n        recv = EventReceiver(connection, handlers={'*': on_event})\n        recv.capture(limit=None, timeout=None, wakeup=True)\n\nif __name__ == '__main__':\n    my_monitor(app)\n</code></pre>"},{"location":"integration/monitoring-logging/#_6","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c07\u4e8b\u4ef6\u8a18\u9304\u5230\u65e5\u8a8c\u7cfb\u7d71\u6216\u8cc7\u6599\u5eab\u4e2d\uff0c\u4ee5\u4fbf\u9577\u671f\u5206\u6790\u3002</li> <li>\u4f7f\u7528\u4e8b\u4ef6\u76e3\u807d\u4f86\u89f8\u767c\u544a\u8b66\uff0c\u4f8b\u5982\u4efb\u52d9\u5931\u6557\u6642\u767c\u9001\u901a\u77e5\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#rabbitmq","title":"RabbitMQ \u76e3\u63a7","text":"<p>RabbitMQ \u63d0\u4f9b\u4e86\u7ba1\u7406\u63d2\u4ef6\u548c API\uff0c\u5e6b\u52a9\u60a8\u76e3\u63a7\u968a\u5217\u3001\u4ea4\u63db\u6a5f\u548c\u9023\u63a5\u72c0\u614b\u3002</p>"},{"location":"integration/monitoring-logging/#rabbitmq_1","title":"RabbitMQ \u7ba1\u7406\u63d2\u4ef6","text":"<p>\u555f\u7528 RabbitMQ \u7ba1\u7406\u63d2\u4ef6\uff1a</p> <pre><code>rabbitmq-plugins enable rabbitmq_management\n</code></pre> <p>\u555f\u52d5\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5728 <code>http://localhost:15672</code> \u8a2a\u554f\u7ba1\u7406\u4ecb\u9762\uff08\u9ed8\u8a8d\u7528\u6236\uff1aguest\uff0c\u5bc6\u78bc\uff1aguest\uff09\u3002</p>"},{"location":"integration/monitoring-logging/#_7","title":"\u4e3b\u8981\u529f\u80fd","text":"<ul> <li>\u67e5\u770b\u968a\u5217\u9577\u5ea6\u3001\u6d88\u606f\u901f\u7387\u548c\u6d88\u8cbb\u8005\u6578\u91cf\u3002</li> <li>\u6aa2\u67e5\u4ea4\u63db\u6a5f\u548c\u7d81\u5b9a\u95dc\u4fc2\u3002</li> <li>\u76e3\u63a7\u4f3a\u670d\u5668\u8cc7\u6e90\u4f7f\u7528\u60c5\u6cc1\uff08\u5982\u8a18\u61b6\u9ad4\u548c CPU\uff09\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#_8","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u8cc7\u6e90\u9650\u5236\uff0c\u907f\u514d\u55ae\u500b\u968a\u5217\u4f54\u7528\u904e\u591a\u8cc7\u6e90\u3002</li> <li>\u5b9a\u671f\u6aa2\u67e5\u672a\u78ba\u8a8d\u6d88\u606f\u6578\u91cf\uff0c\u78ba\u4fdd\u6d88\u8cbb\u8005\u6b63\u5e38\u5de5\u4f5c\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#prometheus-grafana","title":"\u4f7f\u7528 Prometheus \u548c Grafana","text":"<p>RabbitMQ \u652f\u6301 Prometheus \u6307\u6a19\u532f\u51fa\uff0c\u53ef\u4ee5\u8207 Grafana \u6574\u5408\u9032\u884c\u53ef\u8996\u5316\u76e3\u63a7\u3002</p>"},{"location":"integration/monitoring-logging/#_9","title":"\u8a2d\u5b9a\u6b65\u9a5f","text":"<ol> <li>\u555f\u7528 <code>rabbitmq_prometheus</code> \u63d2\u4ef6\uff1a</li> </ol> <pre><code>rabbitmq-plugins enable rabbitmq_prometheus\n</code></pre> <ol> <li>\u914d\u7f6e Prometheus \u6293\u53d6 RabbitMQ \u6307\u6a19\u3002</li> <li>\u5728 Grafana \u4e2d\u532f\u5165 RabbitMQ \u5100\u8868\u677f\u3002</li> </ol>"},{"location":"integration/monitoring-logging/#_10","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u544a\u8b66\u898f\u5247\uff0c\u4f8b\u5982\u968a\u5217\u9577\u5ea6\u8d85\u904e\u95be\u503c\u6642\u767c\u9001\u901a\u77e5\u3002</li> <li>\u9577\u671f\u5132\u5b58\u6307\u6a19\u6578\u64da\uff0c\u5206\u6790\u7cfb\u7d71\u8da8\u52e2\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#_11","title":"\u65e5\u8a8c\u8a18\u9304","text":"<p>\u8a73\u7d30\u7684\u65e5\u8a8c\u8a18\u9304\u662f\u6392\u67e5\u554f\u984c\u7684\u57fa\u790e\uff0cCelery\u3001Kombu \u548c RabbitMQ \u90fd\u652f\u6301\u65e5\u8a8c\u914d\u7f6e\u3002</p>"},{"location":"integration/monitoring-logging/#celery_1","title":"Celery \u65e5\u8a8c","text":"<p>\u8a2d\u5b9a Celery \u7684\u65e5\u8a8c\u7d1a\u5225\u548c\u8f38\u51fa\u4f4d\u7f6e\uff1a</p> <pre><code>from celery import Celery\nimport logging\n\napp = Celery('tasks', broker='amqp://localhost')\n\n# \u8a2d\u5b9a\u65e5\u8a8c\nlogging.basicConfig(filename='celery.log', level=logging.INFO)\napp.conf.task_track_started = True  # \u8a18\u9304\u4efb\u52d9\u958b\u59cb\u6642\u9593\napp.conf.task_send_sent_event = True  # \u8a18\u9304\u4efb\u52d9\u767c\u9001\u4e8b\u4ef6\n</code></pre>"},{"location":"integration/monitoring-logging/#kombu","title":"Kombu \u65e5\u8a8c","text":"<p>Kombu \u7684\u65e5\u8a8c\u53ef\u4ee5\u5e6b\u52a9\u6392\u67e5\u6d88\u606f\u50b3\u8f38\u554f\u984c\uff1a</p> <pre><code>import logging\n\nlogging.getLogger('kombu').setLevel(logging.DEBUG)\n</code></pre>"},{"location":"integration/monitoring-logging/#rabbitmq_2","title":"RabbitMQ \u65e5\u8a8c","text":"<p>RabbitMQ \u7684\u65e5\u8a8c\u6587\u4ef6\u901a\u5e38\u4f4d\u65bc\u5b89\u88dd\u76ee\u9304\u4e0b\uff0c\u6aa2\u67e5\u65e5\u8a8c\u4ee5\u4e86\u89e3\u4f3a\u670d\u5668\u932f\u8aa4\u6216\u9023\u63a5\u554f\u984c\u3002</p>"},{"location":"integration/monitoring-logging/#_12","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u65e5\u8a8c\u8f2a\u8f49\u5de5\u5177\uff08\u5982 <code>logrotate</code>\uff09\u7ba1\u7406\u65e5\u8a8c\u6587\u4ef6\u5927\u5c0f\u3002</li> <li>\u5c07\u65e5\u8a8c\u96c6\u4e2d\u5230\u65e5\u8a8c\u7ba1\u7406\u7cfb\u7d71\uff08\u5982 ELK Stack\uff09\u9032\u884c\u5206\u6790\u3002</li> </ul>"},{"location":"integration/monitoring-logging/#_13","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u9078\u64c7\u5408\u9069\u7684\u76e3\u63a7\u5de5\u5177\uff1aFlower \u9069\u5408 Celery \u4efb\u52d9\u76e3\u63a7\uff0cRabbitMQ \u7ba1\u7406\u63d2\u4ef6\u9069\u5408\u6d88\u606f\u4ee3\u7406\u76e3\u63a7\uff0cPrometheus \u548c Grafana \u9069\u5408\u9577\u671f\u6307\u6a19\u5206\u6790\u3002</li> <li>\u8a2d\u5b9a\u544a\u8b66\uff1a\u5c0d\u65bc\u95dc\u9375\u6307\u6a19\uff08\u5982\u968a\u5217\u9577\u5ea6\u3001\u4efb\u52d9\u5931\u6557\u7387\uff09\uff0c\u8a2d\u5b9a\u544a\u8b66\u4ee5\u4fbf\u53ca\u6642\u97ff\u61c9\u3002</li> <li>\u8a18\u9304\u8a73\u7d30\u65e5\u8a8c\uff1a\u78ba\u4fdd Celery\u3001Kombu \u548c RabbitMQ \u7684\u65e5\u8a8c\u7d1a\u5225\u9069\u7576\uff0c\u65b9\u4fbf\u6392\u67e5\u554f\u984c\u3002</li> <li>\u5b9a\u671f\u5be9\u67e5\uff1a\u5b9a\u671f\u6aa2\u67e5\u76e3\u63a7\u6578\u64da\u548c\u65e5\u8a8c\uff0c\u767c\u73fe\u6f5b\u5728\u554f\u984c\u4e26\u512a\u5316\u7cfb\u7d71\u3002</li> </ul> <p>\u901a\u904e\u6709\u6548\u7684\u76e3\u63a7\u548c\u65e5\u8a8c\u8a18\u9304\uff0c\u60a8\u53ef\u4ee5\u78ba\u4fdd\u5206\u6563\u5f0f\u4efb\u52d9\u7cfb\u7d71\u7684\u7a69\u5b9a\u904b\u884c\uff0c\u4e26\u5feb\u901f\u89e3\u6c7a\u554f\u984c\u3002</p>"},{"location":"integration/performance-optimization/","title":"\u6027\u80fd\u512a\u5316","text":"<p>\u5728\u751f\u7522\u74b0\u5883\u4e2d\uff0cCelery\u3001Kombu \u548c RabbitMQ \u7684\u6027\u80fd\u76f4\u63a5\u5f71\u97ff\u7cfb\u7d71\u7684\u97ff\u61c9\u901f\u5ea6\u548c\u541e\u5410\u91cf\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u512a\u5316\u9019\u4e9b\u5de5\u5177\u7684\u6027\u80fd\uff0c\u5f9e\u4efb\u52d9\u57f7\u884c\u3001\u6d88\u606f\u50b3\u8f38\u5230\u968a\u5217\u7ba1\u7406\uff0c\u63d0\u4f9b\u5177\u9ad4\u7684\u5efa\u8b70\u548c\u6280\u8853\u3002</p>"},{"location":"integration/performance-optimization/#celery","title":"Celery \u4efb\u52d9\u57f7\u884c\u512a\u5316","text":"<p>Celery \u4efb\u52d9\u7684\u57f7\u884c\u6548\u7387\u662f\u7cfb\u7d71\u6027\u80fd\u7684\u6838\u5fc3\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e9b\u512a\u5316\u5efa\u8b70\u3002</p>"},{"location":"integration/performance-optimization/#worker","title":"\u8abf\u6574 Worker \u4e26\u767c\u6027","text":"<p>Celery Worker \u7684\u4e26\u767c\u6578\u91cf\u6c7a\u5b9a\u4e86\u540c\u6642\u8655\u7406\u4efb\u52d9\u7684\u80fd\u529b\uff0c\u6839\u64da\u786c\u9ad4\u8cc7\u6e90\u8abf\u6574\u4e26\u767c\u6578\uff1a</p> <pre><code>celery -A your_module worker --concurrency=4\n</code></pre>"},{"location":"integration/performance-optimization/#_2","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c0d\u65bc CPU \u5bc6\u96c6\u578b\u4efb\u52d9\uff0c\u8a2d\u5b9a\u4e26\u767c\u6578\u63a5\u8fd1 CPU \u6838\u5fc3\u6578\u3002</li> <li>\u5c0d\u65bc I/O \u5bc6\u96c6\u578b\u4efb\u52d9\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u66f4\u9ad8\u7684\u4e26\u767c\u6578\uff0c\u4f46\u907f\u514d\u904e\u9ad8\u5c0e\u81f4\u8cc7\u6e90\u722d\u7528\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_3","title":"\u4f7f\u7528\u5408\u9069\u7684\u57f7\u884c\u6c60","text":"<p>Celery \u652f\u6301\u591a\u7a2e\u57f7\u884c\u6c60\uff08\u5982 <code>prefork</code>\u3001<code>eventlet</code>\u3001<code>gevent</code>\uff09\uff0c\u9078\u64c7\u9069\u5408\u4efb\u52d9\u985e\u578b\u7684\u6c60\uff1a</p> <ul> <li>prefork\uff1a\u9ed8\u8a8d\u6c60\uff0c\u9069\u5408 CPU \u5bc6\u96c6\u578b\u4efb\u52d9\u3002</li> <li>eventlet/gevent\uff1a\u9069\u5408 I/O \u5bc6\u96c6\u578b\u4efb\u52d9\uff0c\u652f\u6301\u66f4\u9ad8\u7684\u4e26\u767c\u3002</li> </ul> <p>\u555f\u7528 eventlet\uff1a</p> <pre><code>pip install eventlet\ncelery -A your_module worker --pool=eventlet --concurrency=100\n</code></pre>"},{"location":"integration/performance-optimization/#_4","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u6e2c\u8a66\u4e0d\u540c\u6c60\u7684\u6027\u80fd\uff0c\u9078\u64c7\u6700\u9069\u5408\u60a8\u4efb\u52d9\u985e\u578b\u7684\u6c60\u3002</li> <li>\u6ce8\u610f <code>eventlet</code> \u548c <code>gevent</code> \u53ef\u80fd\u8207\u67d0\u4e9b\u5eab\u4e0d\u517c\u5bb9\uff0c\u78ba\u4fdd\u5145\u5206\u6e2c\u8a66\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_5","title":"\u4efb\u52d9\u6279\u8655\u7406","text":"<p>\u5c0d\u65bc\u5c0f\u4efb\u52d9\uff0c\u6279\u8655\u7406\u53ef\u4ee5\u6e1b\u5c11\u8abf\u5ea6\u958b\u92b7\uff1a</p> <pre><code>from celery import group\n\n# \u5275\u5efa\u4e00\u7d44\u4efb\u52d9\u4e26\u6279\u91cf\u57f7\u884c\ntasks = group(process_data.s(data) for data in large_dataset)\nresult = tasks.apply_async()\n</code></pre>"},{"location":"integration/performance-optimization/#kombu","title":"Kombu \u6d88\u606f\u50b3\u8f38\u512a\u5316","text":"<p>Kombu \u8ca0\u8cac\u6d88\u606f\u7684\u767c\u9001\u548c\u63a5\u6536\uff0c\u5176\u6027\u80fd\u76f4\u63a5\u5f71\u97ff\u6574\u9ad4\u7cfb\u7d71\u3002</p>"},{"location":"integration/performance-optimization/#_6","title":"\u9078\u64c7\u9ad8\u6548\u7684\u5e8f\u5217\u5316\u683c\u5f0f","text":"<p>\u6d88\u606f\u5e8f\u5217\u5316\u683c\u5f0f\u5f71\u97ff\u50b3\u8f38\u901f\u5ea6\uff0cJSON \u662f\u5b89\u5168\u7684\u9ed8\u8a8d\u9078\u64c7\uff0c\u4f46 MessagePack \u53ef\u80fd\u66f4\u5feb\uff1a</p> <pre><code>app.conf.task_serializer = 'msgpack'\napp.conf.accept_content = ['msgpack']\n</code></pre>"},{"location":"integration/performance-optimization/#_7","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5982\u679c\u6027\u80fd\u81f3\u95dc\u91cd\u8981\uff0c\u6e2c\u8a66 MessagePack \u6216\u5176\u4ed6\u9ad8\u6548\u683c\u5f0f\u3002</li> <li>\u78ba\u4fdd\u6240\u6709\u6d88\u8cbb\u8005\u652f\u6301\u6240\u9078\u683c\u5f0f\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_8","title":"\u6279\u91cf\u7372\u53d6\u6d88\u606f","text":"<p>\u8a2d\u5b9a <code>prefetch_count</code>\uff0c\u8b93\u6d88\u8cbb\u8005\u4e00\u6b21\u8655\u7406\u591a\u689d\u6d88\u606f\uff0c\u6e1b\u5c11\u7db2\u7d61\u958b\u92b7\uff1a</p> <pre><code>from kombu import Consumer, Queue\n\nqueue = Queue('my_queue')\nconsumer = Consumer(connection, queues=queue, prefetch_count=10)\n</code></pre>"},{"location":"integration/performance-optimization/#_9","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u6839\u64da\u4efb\u52d9\u8655\u7406\u6642\u9593\u8abf\u6574 <code>prefetch_count</code>\uff0c\u907f\u514d\u904e\u9ad8\u5c0e\u81f4\u6d88\u606f\u5206\u914d\u4e0d\u5747\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_10","title":"\u9023\u63a5\u6c60\u7ba1\u7406","text":"<p>\u4f7f\u7528 Kombu \u7684\u9023\u63a5\u6c60\uff0c\u6e1b\u5c11\u9023\u63a5\u5efa\u7acb\u7684\u958b\u92b7\uff1a</p> <pre><code>from kombu import Connection\n\nconn = Connection('amqp://localhost', transport_options={'client_properties': {'connection_name': 'my-app'}})\nconn.pool  # \u4f7f\u7528\u9023\u63a5\u6c60\n</code></pre>"},{"location":"integration/performance-optimization/#_11","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5728\u9ad8\u4f75\u767c\u74b0\u5883\u4e2d\uff0c\u9069\u7576\u589e\u52a0\u9023\u63a5\u6c60\u5927\u5c0f\uff0c\u4f46\u907f\u514d\u904e\u591a\u9023\u63a5\u5c0e\u81f4\u8cc7\u6e90\u8017\u76e1\u3002</li> <li>\u5b9a\u671f\u6aa2\u67e5\u9023\u63a5\u6c60\u4f7f\u7528\u60c5\u6cc1\uff0c\u78ba\u4fdd\u9023\u63a5\u672a\u88ab\u6d29\u6f0f\u3002</li> </ul>"},{"location":"integration/performance-optimization/#rabbitmq","title":"RabbitMQ \u968a\u5217\u8207\u6d88\u606f\u4ee3\u7406\u512a\u5316","text":"<p>RabbitMQ \u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\uff0c\u5176\u914d\u7f6e\u548c\u4f7f\u7528\u65b9\u5f0f\u5c0d\u6027\u80fd\u6709\u5f88\u5927\u5f71\u97ff\u3002</p>"},{"location":"integration/performance-optimization/#_12","title":"\u968a\u5217\u8207\u4ea4\u63db\u6a5f\u8a2d\u8a08","text":"<p>\u8a2d\u8a08\u9ad8\u6548\u7684\u968a\u5217\u548c\u4ea4\u63db\u6a5f\u7d50\u69cb\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u8def\u7531\u958b\u92b7\uff1a</p> <ul> <li>\u4f7f\u7528 Direct Exchange \u9032\u884c\u7c21\u55ae\u7684\u9ede\u5c0d\u9ede\u6d88\u606f\u50b3\u905e\u3002</li> <li>\u4f7f\u7528 Topic Exchange \u9032\u884c\u9748\u6d3b\u7684\u8def\u7531\uff0c\u4f46\u907f\u514d\u904e\u65bc\u8907\u96dc\u7684\u8def\u7531\u898f\u5247\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_13","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u70ba\u4e0d\u540c\u985e\u578b\u7684\u4efb\u52d9\u5275\u5efa\u7368\u7acb\u7684\u968a\u5217\uff0c\u65b9\u4fbf\u7ba1\u7406\u548c\u76e3\u63a7\u3002</li> <li>\u907f\u514d\u5275\u5efa\u904e\u591a\u81e8\u6642\u968a\u5217\uff0c\u6e1b\u5c11\u8cc7\u6e90\u4f54\u7528\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_14","title":"\u6301\u4e45\u5316\u8207\u975e\u6301\u4e45\u5316","text":"<p>\u6301\u4e45\u5316\u6d88\u606f\u548c\u968a\u5217\u53ef\u4ee5\u78ba\u4fdd\u6578\u64da\u4e0d\u4e1f\u5931\uff0c\u4f46\u6703\u5f71\u97ff\u6027\u80fd\uff1a</p> <pre><code>producer.publish(\n    {'task': 'important_task'},\n    serializer='json',\n    delivery_mode=2  # \u6301\u4e45\u5316\u6a21\u5f0f\n)\n</code></pre>"},{"location":"integration/performance-optimization/#_15","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5c0d\u65bc\u95dc\u9375\u4efb\u52d9\uff0c\u555f\u7528\u6301\u4e45\u5316\uff1b\u5c0d\u65bc\u975e\u95dc\u9375\u4efb\u52d9\uff0c\u53ef\u4ee5\u4f7f\u7528\u975e\u6301\u4e45\u5316\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002</li> <li>\u78ba\u4fdd\u78c1\u76e4 I/O \u6027\u80fd\u8db3\u5920\u652f\u6301\u6301\u4e45\u5316\u64cd\u4f5c\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_16","title":"\u968a\u5217\u9577\u5ea6\u9650\u5236","text":"<p>\u8a2d\u5b9a\u968a\u5217\u7684\u6700\u5927\u9577\u5ea6\uff0c\u907f\u514d\u7121\u9650\u7a4d\u58d3\u5c0e\u81f4\u8a18\u61b6\u9ad4\u8017\u76e1\uff1a</p> <pre><code>queue = Queue('limited_queue', exchange, routing_key='key', queue_arguments={'x-max-length': 10000})\n</code></pre>"},{"location":"integration/performance-optimization/#_17","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u7d50\u5408\u76e3\u63a7\u5de5\u5177\uff0c\u8a2d\u5b9a\u544a\u8b66\u4ee5\u4fbf\u5728\u968a\u5217\u63a5\u8fd1\u9650\u5236\u6642\u63a1\u53d6\u884c\u52d5\u3002</li> <li>\u5c0d\u65bc\u8d85\u51fa\u9650\u5236\u7684\u6d88\u606f\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u4e1f\u68c4\u7b56\u7565\u6216\u8f49\u767c\u5230\u5176\u4ed6\u968a\u5217\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_18","title":"\u7d50\u679c\u5f8c\u7aef\u512a\u5316","text":"<p>Celery \u7684\u7d50\u679c\u5f8c\u7aef\u7528\u65bc\u5132\u5b58\u4efb\u52d9\u7d50\u679c\uff0c\u9078\u64c7\u5408\u9069\u7684\u5f8c\u7aef\u4e26\u512a\u5316\u5176\u6027\u80fd\u81f3\u95dc\u91cd\u8981\u3002</p>"},{"location":"integration/performance-optimization/#_19","title":"\u9078\u64c7\u5408\u9069\u7684\u7d50\u679c\u5f8c\u7aef","text":"<ul> <li>RPC\uff1a\u9069\u5408\u7c21\u55ae\u5834\u666f\uff0c\u4e0d\u9700\u8981\u9577\u671f\u5132\u5b58\u7d50\u679c\u3002</li> <li>Redis\uff1a\u9ad8\u6548\u4e14\u9069\u5408\u9ad8\u4f75\u767c\uff0c\u4f46\u9700\u8981\u8003\u616e\u6301\u4e45\u5316\u3002</li> <li>Database\uff1a\u9069\u5408\u9700\u8981\u9577\u671f\u5132\u5b58\u7d50\u679c\u7684\u5834\u666f\uff0c\u4f46\u6027\u80fd\u8f03\u4f4e\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_20","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5982\u679c\u4e0d\u9700\u8981\u7d50\u679c\uff0c\u7981\u7528\u7d50\u679c\u5f8c\u7aef\uff1a</li> </ul> <pre><code>app.conf.task_ignore_result = True\n</code></pre> <ul> <li>\u5c0d\u65bc\u9ad8\u4f75\u767c\u5834\u666f\uff0c\u4f7f\u7528 Redis \u4f5c\u70ba\u7d50\u679c\u5f8c\u7aef\uff0c\u4e26\u8a2d\u5b9a\u9069\u7576\u7684\u904e\u671f\u6642\u9593\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_21","title":"\u6e05\u7406\u7d50\u679c\u6578\u64da","text":"<p>\u5b9a\u671f\u6e05\u7406\u904e\u671f\u7684\u7d50\u679c\u6578\u64da\uff0c\u907f\u514d\u5f8c\u7aef\u8cc7\u6e90\u8017\u76e1\uff1a</p> <pre><code>celery -A your_module purge\n</code></pre>"},{"location":"integration/performance-optimization/#_22","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u7d50\u679c\u904e\u671f\u6642\u9593\uff1a</li> </ul> <pre><code>app.conf.result_expires = 3600  # \u7d50\u679c1\u5c0f\u6642\u5f8c\u904e\u671f\n</code></pre> <ul> <li>\u81ea\u52d5\u5316\u6e05\u7406\u4efb\u52d9\uff0c\u78ba\u4fdd\u5f8c\u7aef\u4e0d\u88ab\u820a\u6578\u64da\u4f54\u6eff\u3002</li> </ul>"},{"location":"integration/performance-optimization/#_23","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u5206\u5c64\u512a\u5316\uff1a\u5f9e Celery Worker\u3001Kombu \u6d88\u606f\u50b3\u8f38\u5230 RabbitMQ \u968a\u5217\u7ba1\u7406\uff0c\u9010\u6b65\u512a\u5316\u6bcf\u4e00\u5c64\u3002</li> <li>\u6e2c\u8a66\u8207\u76e3\u63a7\uff1a\u5728\u512a\u5316\u5f8c\u9032\u884c\u58d3\u529b\u6e2c\u8a66\uff0c\u4e26\u4f7f\u7528\u76e3\u63a7\u5de5\u5177\u89c0\u5bdf\u6548\u679c\u3002</li> <li>\u5e73\u8861\u6027\u80fd\u8207\u53ef\u9760\u6027\uff1a\u5728\u8ffd\u6c42\u6027\u80fd\u6642\uff0c\u907f\u514d\u72a7\u7272\u7cfb\u7d71\u7684\u7a69\u5b9a\u6027\u548c\u6578\u64da\u5b8c\u6574\u6027\u3002</li> <li>\u6301\u7e8c\u8abf\u6574\uff1a\u96a8\u8457\u4efb\u52d9\u91cf\u548c\u7cfb\u7d71\u898f\u6a21\u8b8a\u5316\uff0c\u5b9a\u671f\u91cd\u65b0\u8a55\u4f30\u548c\u8abf\u6574\u914d\u7f6e\u3002</li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u512a\u5316\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u986f\u8457\u63d0\u5347\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\u7684\u6027\u80fd\uff0c\u6eff\u8db3\u4e0d\u540c\u898f\u6a21\u7684\u9700\u6c42\u3002</p>"},{"location":"integration/scalability-design/","title":"\u64f4\u5c55\u6027\u8a2d\u8a08","text":"<p>\u7576\u60a8\u7684\u61c9\u7528\u7a0b\u5f0f\u898f\u6a21\u64f4\u5927\uff0c\u4efb\u52d9\u91cf\u548c\u7528\u6236\u8acb\u6c42\u589e\u52a0\u6642\uff0cCelery\u3001Kombu \u548c RabbitMQ \u7cfb\u7d71\u9700\u8981\u5177\u5099\u826f\u597d\u7684\u64f4\u5c55\u6027\uff0c\u4ee5\u61c9\u5c0d\u66f4\u9ad8\u7684\u8ca0\u8f09\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u8a2d\u8a08\u4e00\u500b\u53ef\u64f4\u5c55\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\uff0c\u5f9e\u67b6\u69cb\u8a2d\u8a08\u5230\u8cc7\u6e90\u5206\u914d\uff0c\u63d0\u4f9b\u5177\u9ad4\u7684\u5efa\u8b70\u3002</p>"},{"location":"integration/scalability-design/#_2","title":"\u67b6\u69cb\u8a2d\u8a08","text":"<p>\u64f4\u5c55\u6027\u7684\u57fa\u790e\u5728\u65bc\u67b6\u69cb\u8a2d\u8a08\uff0c\u5408\u7406\u5283\u5206\u7cfb\u7d71\u7d44\u4ef6\u53ef\u4ee5\u8b93\u7cfb\u7d71\u66f4\u5bb9\u6613\u64f4\u5c55\u3002</p>"},{"location":"integration/scalability-design/#_3","title":"\u5206\u96e2\u95dc\u6ce8\u9ede","text":"<p>\u5c07\u4efb\u52d9\u8655\u7406\u8207\u696d\u52d9\u908f\u8f2f\u5206\u96e2\uff0c\u78ba\u4fdd Celery Worker \u548c Web \u61c9\u7528\u7a0b\u5f0f\u7368\u7acb\u904b\u884c\uff1a</p> <ul> <li>Web \u5c64\uff1a\u8ca0\u8cac\u63a5\u6536\u7528\u6236\u8acb\u6c42\uff0c\u50c5\u767c\u8d77\u7570\u6b65\u4efb\u52d9\u3002</li> <li>\u4efb\u52d9\u8655\u7406\u5c64\uff1a\u7531 Celery Worker \u8ca0\u8cac\u57f7\u884c\u4efb\u52d9\uff0c\u8207 Web \u5c64\u89e3\u8026\u3002</li> </ul>"},{"location":"integration/scalability-design/#_4","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u6d88\u606f\u968a\u5217\uff08\u5982 RabbitMQ\uff09\u4f5c\u70ba\u4e2d\u9593\u5c64\uff0c\u89e3\u8026\u751f\u7522\u8005\uff08Web \u61c9\u7528\uff09\u548c\u6d88\u8cbb\u8005\uff08Worker\uff09\u3002</li> <li>\u907f\u514d\u5728 Web \u61c9\u7528\u4e2d\u57f7\u884c\u9577\u6642\u9593\u4efb\u52d9\uff0c\u78ba\u4fdd\u5feb\u901f\u97ff\u61c9\u7528\u6236\u8acb\u6c42\u3002</li> </ul>"},{"location":"integration/scalability-design/#_5","title":"\u4efb\u52d9\u5206\u985e\u8207\u8def\u7531","text":"<p>\u6839\u64da\u4efb\u52d9\u7684\u985e\u578b\u548c\u512a\u5148\u7d1a\uff0c\u5c07\u4efb\u52d9\u5206\u914d\u5230\u4e0d\u540c\u7684\u968a\u5217\uff1a</p> <pre><code>app.conf.task_routes = {\n    'high_priority_task': {'queue': 'high_priority'},\n    'low_priority_task': {'queue': 'low_priority'}\n}\n</code></pre>"},{"location":"integration/scalability-design/#_6","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u70ba\u9ad8\u512a\u5148\u7d1a\u4efb\u52d9\u5275\u5efa\u5c08\u7528\u968a\u5217\u548c Worker\uff0c\u78ba\u4fdd\u95dc\u9375\u4efb\u52d9\u5feb\u901f\u8655\u7406\u3002</li> <li>\u70ba\u4e0d\u540c\u985e\u578b\u7684\u4efb\u52d9\u5206\u914d\u4e0d\u540c\u7684\u8cc7\u6e90\uff0c\u907f\u514d\u55ae\u4e00\u968a\u5217\u6210\u70ba\u74f6\u9838\u3002</li> </ul>"},{"location":"integration/scalability-design/#_7","title":"\u6c34\u5e73\u64f4\u5c55","text":"<p>\u6c34\u5e73\u64f4\u5c55\u662f\u589e\u52a0\u7cfb\u7d71\u8655\u7406\u80fd\u529b\u7684\u4e3b\u8981\u65b9\u5f0f\uff0c\u901a\u904e\u589e\u52a0 Worker \u548c\u6d88\u606f\u4ee3\u7406\u7bc0\u9ede\u5be6\u73fe\u3002</p>"},{"location":"integration/scalability-design/#celery-worker","title":"\u589e\u52a0 Celery Worker","text":"<p>\u96a8\u8457\u4efb\u52d9\u91cf\u589e\u52a0\uff0c\u555f\u52d5\u66f4\u591a Worker \u4f86\u5206\u64d4\u8ca0\u8f09\uff1a</p> <pre><code>celery -A your_module worker --concurrency=4 -n worker1@%h\ncelery -A your_module worker --concurrency=4 -n worker2@%h\n</code></pre>"},{"location":"integration/scalability-design/#_8","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u5728\u4e0d\u540c\u4f3a\u670d\u5668\u4e0a\u904b\u884c Worker\uff0c\u5145\u5206\u5229\u7528\u786c\u9ad4\u8cc7\u6e90\u3002</li> <li>\u4f7f\u7528\u81ea\u52d5\u5316\u5de5\u5177\uff08\u5982 Kubernetes \u6216 Docker Swarm\uff09\u52d5\u614b\u8abf\u6574 Worker \u6578\u91cf\u3002</li> </ul>"},{"location":"integration/scalability-design/#rabbitmq","title":"RabbitMQ \u96c6\u7fa4","text":"<p>RabbitMQ \u652f\u6301\u96c6\u7fa4\u6a21\u5f0f\uff0c\u5141\u8a31\u591a\u500b\u7bc0\u9ede\u5354\u540c\u5de5\u4f5c\uff0c\u63d0\u9ad8\u541e\u5410\u91cf\u548c\u53ef\u9760\u6027\uff1a</p>"},{"location":"integration/scalability-design/#_9","title":"\u8a2d\u5b9a\u6b65\u9a5f","text":"<ol> <li>\u5728\u591a\u53f0\u4f3a\u670d\u5668\u4e0a\u5b89\u88dd RabbitMQ\u3002</li> <li>\u914d\u7f6e\u96c6\u7fa4\uff0c\u4f7f\u7bc0\u9ede\u4e92\u76f8\u9023\u63a5\uff08\u53c3\u8003 RabbitMQ \u5b98\u65b9\u6587\u6a94\uff09\u3002</li> <li>\u914d\u7f6e\u93e1\u50cf\u968a\u5217\uff0c\u78ba\u4fdd\u6578\u64da\u5728\u7bc0\u9ede\u9593\u540c\u6b65\u3002</li> </ol>"},{"location":"integration/scalability-design/#_10","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u8ca0\u8f09\u5747\u8861\u5668\u5206\u767c\u6d88\u606f\u5230\u4e0d\u540c RabbitMQ \u7bc0\u9ede\u3002</li> <li>\u78ba\u4fdd\u96c6\u7fa4\u7bc0\u9ede\u9593\u7db2\u7d61\u5ef6\u9072\u4f4e\uff0c\u907f\u514d\u540c\u6b65\u5f71\u97ff\u6027\u80fd\u3002</li> </ul>"},{"location":"integration/scalability-design/#_11","title":"\u8cc7\u6e90\u5206\u914d\u8207\u8ca0\u8f09\u5747\u8861","text":"<p>\u5408\u7406\u7684\u8cc7\u6e90\u5206\u914d\u548c\u8ca0\u8f09\u5747\u8861\u53ef\u4ee5\u907f\u514d\u55ae\u9ede\u904e\u8f09\uff0c\u63d0\u9ad8\u7cfb\u7d71\u6548\u7387\u3002</p>"},{"location":"integration/scalability-design/#worker","title":"Worker \u8cc7\u6e90\u5206\u914d","text":"<p>\u6839\u64da\u4efb\u52d9\u9700\u6c42\uff0c\u70ba Worker \u5206\u914d\u9069\u7576\u7684 CPU \u548c\u8a18\u61b6\u9ad4\u8cc7\u6e90\uff1a</p> <ul> <li>CPU \u5bc6\u96c6\u578b\u4efb\u52d9\uff1a\u589e\u52a0 CPU \u6838\u5fc3\u6578\uff0c\u6e1b\u5c11\u4e26\u767c\u6578\u3002</li> <li>I/O \u5bc6\u96c6\u578b\u4efb\u52d9\uff1a\u589e\u52a0\u4e26\u767c\u6578\uff0c\u6e1b\u5c11 CPU \u9700\u6c42\u3002</li> </ul>"},{"location":"integration/scalability-design/#_12","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528\u5bb9\u5668\u5316\u6280\u8853\uff08\u5982 Docker\uff09\u70ba\u6bcf\u500b Worker \u8a2d\u5b9a\u8cc7\u6e90\u9650\u5236\u3002</li> <li>\u76e3\u63a7 Worker \u8cc7\u6e90\u4f7f\u7528\u60c5\u6cc1\uff0c\u52d5\u614b\u8abf\u6574\u5206\u914d\u3002</li> </ul>"},{"location":"integration/scalability-design/#_13","title":"\u968a\u5217\u8ca0\u8f09\u5747\u8861","text":"<p>\u907f\u514d\u55ae\u4e00\u968a\u5217\u6210\u70ba\u74f6\u9838\uff0c\u901a\u904e\u591a\u968a\u5217\u548c\u8def\u7531\u5be6\u73fe\u8ca0\u8f09\u5747\u8861\uff1a</p> <pre><code>app.conf.task_default_queue = 'default'\napp.conf.task_queues = {\n    'high_priority': {'exchange': 'high_priority', 'routing_key': 'high.#'},\n    'default': {'exchange': 'default', 'routing_key': 'default.#'}\n}\n</code></pre>"},{"location":"integration/scalability-design/#_14","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u70ba\u9ad8\u8ca0\u8f09\u4efb\u52d9\u5275\u5efa\u591a\u500b\u968a\u5217\uff0c\u5206\u914d\u5230\u4e0d\u540c Worker\u3002</li> <li>\u4f7f\u7528 RabbitMQ \u7684\u4ea4\u63db\u6a5f\u9032\u884c\u6d88\u606f\u5206\u767c\uff0c\u78ba\u4fdd\u5747\u8861\u3002</li> </ul>"},{"location":"integration/scalability-design/#_15","title":"\u52d5\u614b\u64f4\u5c55\u8207\u81ea\u52d5\u5316","text":"<p>\u96a8\u8457\u8ca0\u8f09\u8b8a\u5316\uff0c\u7cfb\u7d71\u61c9\u80fd\u52d5\u614b\u8abf\u6574\u8cc7\u6e90\uff0c\u5be6\u73fe\u81ea\u52d5\u5316\u64f4\u5c55\u3002</p>"},{"location":"integration/scalability-design/#celery-autoscaler","title":"\u4f7f\u7528 Celery Autoscaler","text":"<p>Celery \u652f\u6301\u81ea\u52d5\u8abf\u6574 Worker \u6578\u91cf\uff0c\u6839\u64da\u968a\u5217\u9577\u5ea6\u52d5\u614b\u64f4\u5c55\uff1a</p> <pre><code>pip install celery[redis]\ncelery -A your_module worker --autoscale=10,3\n</code></pre>"},{"location":"integration/scalability-design/#_16","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u5408\u7406\u7684\u4e0a\u4e0b\u9650\uff0c\u907f\u514d\u904e\u5ea6\u64f4\u5c55\u5c0e\u81f4\u8cc7\u6e90\u6d6a\u8cbb\u3002</li> <li>\u7d50\u5408\u76e3\u63a7\u5de5\u5177\uff0c\u78ba\u4fdd\u81ea\u52d5\u64f4\u5c55\u89f8\u767c\u689d\u4ef6\u5408\u7406\u3002</li> </ul>"},{"location":"integration/scalability-design/#_17","title":"\u5bb9\u5668\u5316\u8207\u7de8\u6392\u5de5\u5177","text":"<p>\u4f7f\u7528 Docker \u548c Kubernetes \u5be6\u73fe\u81ea\u52d5\u5316\u90e8\u7f72\u548c\u64f4\u5c55\uff1a</p>"},{"location":"integration/scalability-design/#_18","title":"\u8a2d\u5b9a\u6b65\u9a5f","text":"<ol> <li>\u5c07 Celery Worker \u548c RabbitMQ \u6253\u5305\u70ba Docker \u6620\u50cf\u3002</li> <li>\u4f7f\u7528 Kubernetes \u8a2d\u5b9a Pod \u81ea\u52d5\u64f4\u5c55\u7b56\u7565\uff0c\u6839\u64da CPU \u6216\u968a\u5217\u9577\u5ea6\u8abf\u6574\u3002</li> </ol>"},{"location":"integration/scalability-design/#_19","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8a2d\u5b9a\u5065\u5eb7\u6aa2\u67e5\uff0c\u78ba\u4fdd\u65b0\u555f\u52d5\u7684 Worker \u6b63\u5e38\u904b\u884c\u3002</li> <li>\u4f7f\u7528 Kubernetes \u7684\u670d\u52d9\u767c\u73fe\uff0c\u52d5\u614b\u9023\u63a5 RabbitMQ \u96c6\u7fa4\u3002</li> </ul>"},{"location":"integration/scalability-design/#_20","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6a21\u584a\u5316\u8a2d\u8a08\uff1a\u5c07\u7cfb\u7d71\u5206\u70ba\u7368\u7acb\u6a21\u584a\uff0c\u65b9\u4fbf\u55ae\u7368\u64f4\u5c55\u3002</li> <li>\u6c34\u5e73\u64f4\u5c55\u512a\u5148\uff1a\u901a\u904e\u589e\u52a0 Worker \u548c RabbitMQ \u7bc0\u9ede\u61c9\u5c0d\u8ca0\u8f09\u589e\u9577\u3002</li> <li>\u52d5\u614b\u8abf\u6574\uff1a\u4f7f\u7528\u81ea\u52d5\u5316\u5de5\u5177\u5be6\u73fe\u8cc7\u6e90\u7684\u52d5\u614b\u5206\u914d\u3002</li> <li>\u76e3\u63a7\u8207\u53cd\u994b\uff1a\u64f4\u5c55\u5f8c\u6301\u7e8c\u76e3\u63a7\u7cfb\u7d71\u6027\u80fd\uff0c\u6839\u64da\u6578\u64da\u8abf\u6574\u7b56\u7565\u3002</li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u8a2d\u8a08\u4e00\u500b\u9ad8\u64f4\u5c55\u6027\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u7cfb\u7d71\uff0c\u61c9\u5c0d\u5f9e\u5c0f\u578b\u61c9\u7528\u5230\u5927\u898f\u6a21\u90e8\u7f72\u7684\u5404\u7a2e\u9700\u6c42\u3002</p>"},{"location":"integration/web-frameworks/","title":"Celery \u8207 Web \u6846\u67b6\u6574\u5408","text":"<p>\u5728\u5be6\u969b\u9805\u76ee\u4e2d\uff0cCelery \u901a\u5e38\u9700\u8981\u8207 Web \u6846\u67b6\uff08\u5982 Django\u3001Flask \u6216 FastAPI\uff09\u6574\u5408\uff0c\u4ee5\u4fbf\u5728\u7528\u6236\u8acb\u6c42\u6642\u89f8\u767c\u7570\u6b65\u4efb\u52d9\uff0c\u4f8b\u5982\u767c\u9001\u96fb\u5b50\u90f5\u4ef6\u3001\u8655\u7406\u9577\u6642\u9593\u904b\u884c\u7684\u8a08\u7b97\u6216\u57f7\u884c\u5f8c\u53f0\u6578\u64da\u8655\u7406\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39\u5982\u4f55\u5c07 Celery \u8207\u5e38\u898b\u7684 Web \u6846\u67b6\u6574\u5408\uff0c\u4e26\u63d0\u4f9b\u6700\u4f73\u5be6\u8e10\u5efa\u8b70\u3002</p>"},{"location":"integration/web-frameworks/#celery-django","title":"Celery \u8207 Django \u6574\u5408","text":"<p>Django \u662f Python \u751f\u614b\u4e2d\u6700\u53d7\u6b61\u8fce\u7684 Web \u6846\u67b6\u4e4b\u4e00\uff0c\u8207 Celery \u7684\u6574\u5408\u975e\u5e38\u81ea\u7136\u3002\u4ee5\u4e0b\u662f\u6574\u5408\u7684\u57fa\u672c\u6b65\u9a5f\u3002</p>"},{"location":"integration/web-frameworks/#_1","title":"\u5b89\u88dd\u8207\u914d\u7f6e","text":"<p>\u9996\u5148\uff0c\u78ba\u4fdd\u60a8\u5df2\u5b89\u88dd\u5fc5\u8981\u7684\u5957\u4ef6\uff1a</p> <pre><code>pip install celery django\n</code></pre> <p>\u5728 Django \u9805\u76ee\u4e2d\uff0c\u5275\u5efa\u4e00\u500b Celery \u914d\u7f6e\u6587\u4ef6\uff08\u4f8b\u5982 <code>your_project/celery.py</code>\uff09\uff1a</p> <pre><code>from celery import Celery\nimport os\n\n# \u8a2d\u5b9a Django \u7684\u74b0\u5883\u8b8a\u6578\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'your_project.settings')\n\n# \u5275\u5efa Celery \u61c9\u7528\napp = Celery('tasks', broker='amqp://localhost')\n\n# \u5f9e Django \u8a2d\u5b9a\u4e2d\u8f09\u5165 Celery \u914d\u7f6e\napp.config_from_object('django.conf:settings', namespace='CELERY')\n\n# \u81ea\u52d5\u767c\u73fe\u4efb\u52d9\napp.autodiscover_tasks()\n</code></pre> <p>\u5728 Django \u7684 <code>settings.py</code> \u4e2d\uff0c\u6dfb\u52a0 Celery \u914d\u7f6e\uff1a</p> <pre><code># Celery \u914d\u7f6e\nCELERY_BROKER_URL = 'amqp://localhost'  # \u4f7f\u7528 RabbitMQ \u4f5c\u70ba\u6d88\u606f\u4ee3\u7406\nCELERY_RESULT_BACKEND = 'rpc://'  # \u7d50\u679c\u5132\u5b58\u5f8c\u7aef\nCELERY_ACCEPT_CONTENT = ['json']  # \u53ea\u63a5\u53d7 JSON \u683c\u5f0f\nCELERY_TASK_SERIALIZER = 'json'  # \u4efb\u52d9\u5e8f\u5217\u5316\u683c\u5f0f\nCELERY_RESULT_SERIALIZER = 'json'  # \u7d50\u679c\u5e8f\u5217\u5316\u683c\u5f0f\n</code></pre>"},{"location":"integration/web-frameworks/#_2","title":"\u5b9a\u7fa9\u4efb\u52d9","text":"<p>\u5728 Django \u61c9\u7528\u4e2d\u5275\u5efa\u4efb\u52d9\uff08\u4f8b\u5982 <code>your_app/tasks.py</code>\uff09\uff1a</p> <pre><code>from celery import shared_task\n\n@shared_task\ndef send_email(to_email, subject, body):\n    # \u6a21\u64ec\u767c\u9001\u96fb\u5b50\u90f5\u4ef6\n    print(f\"\u767c\u9001\u90f5\u4ef6\u5230 {to_email}\uff0c\u4e3b\u984c\uff1a{subject}\")\n    return True\n</code></pre>"},{"location":"integration/web-frameworks/#view","title":"\u5728 View \u4e2d\u8abf\u7528\u4efb\u52d9","text":"<p>\u5728 Django \u7684\u8996\u5716\u4e2d\uff0c\u60a8\u53ef\u4ee5\u7570\u6b65\u8abf\u7528\u4efb\u52d9\uff1a</p> <pre><code>from django.http import HttpResponse\nfrom your_app.tasks import send_email\n\ndef send_email_view(request):\n    send_email.delay('user@example.com', '\u6b61\u8fce', '\u6b61\u8fce\u4f7f\u7528\u6211\u5011\u7684\u670d\u52d9\uff01')\n    return HttpResponse(\"\u90f5\u4ef6\u5df2\u767c\u9001\uff08\u7570\u6b65\u8655\u7406\uff09\")\n</code></pre>"},{"location":"integration/web-frameworks/#_3","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u4f7f\u7528 <code>shared_task</code>\uff1a\u4f7f\u7528 <code>@shared_task</code> \u88dd\u98fe\u5668\u800c\u975e <code>@app.task</code>\uff0c\u4ee5\u907f\u514d\u76f4\u63a5\u4f9d\u8cf4\u7279\u5b9a\u7684 Celery \u61c9\u7528\u5be6\u4f8b\u3002</li> <li>\u8a2d\u5b9a\u7d50\u679c\u5f8c\u7aef\uff1a\u5982\u679c\u9700\u8981\u8ffd\u8e64\u4efb\u52d9\u7d50\u679c\uff0c\u78ba\u4fdd\u8a2d\u5b9a\u4e00\u500b\u7d50\u679c\u5f8c\u7aef\uff08\u5982 Redis \u6216\u8cc7\u6599\u5eab\uff09\u3002</li> <li>\u907f\u514d\u963b\u585e\u8acb\u6c42\uff1a\u78ba\u4fdd\u5728 Web \u8acb\u6c42\u4e2d\u53ea\u8abf\u7528 <code>.delay()</code> \u6216 <code>.apply_async()</code>\uff0c\u907f\u514d\u76f4\u63a5\u57f7\u884c\u4efb\u52d9\u3002</li> </ul>"},{"location":"integration/web-frameworks/#celery-flask","title":"Celery \u8207 Flask \u6574\u5408","text":"<p>Flask \u662f\u4e00\u500b\u8f15\u91cf\u7d1a\u7684 Web \u6846\u67b6\uff0c\u8207 Celery \u7684\u6574\u5408\u540c\u6a23\u7c21\u55ae\uff0c\u4f46\u9700\u8981\u984d\u5916\u8655\u7406 Flask \u7684\u61c9\u7528\u4e0a\u4e0b\u6587\u3002</p>"},{"location":"integration/web-frameworks/#_4","title":"\u5b89\u88dd\u8207\u914d\u7f6e","text":"<p>\u5b89\u88dd\u5fc5\u8981\u7684\u5957\u4ef6\uff1a</p> <pre><code>pip install celery flask\n</code></pre> <p>\u5275\u5efa Celery \u61c9\u7528\uff08\u4f8b\u5982 <code>app/celery_app.py</code>\uff09\uff1a</p> <pre><code>from celery import Celery\n\ndef make_celery(app):\n    celery = Celery(\n        app.import_name,\n        backend=app.config['CELERY_RESULT_BACKEND'],\n        broker=app.config['CELERY_BROKER_URL']\n    )\n    celery.conf.update(app.config)\n\n    class ContextTask(celery.Task):\n        def __call__(self, *args, **kwargs):\n            with app.app_context():\n                return self.run(*args, **kwargs)\n\n    celery.Task = ContextTask\n    return celery\n</code></pre> <p>\u5728 Flask \u61c9\u7528\u4e2d\u521d\u59cb\u5316 Celery\uff08\u4f8b\u5982 <code>app/__init__.py</code>\uff09\uff1a</p> <pre><code>from flask import Flask\nfrom .celery_app import make_celery\n\napp = Flask(__name__)\napp.config.update(\n    CELERY_BROKER_URL='amqp://localhost',\n    CELERY_RESULT_BACKEND='rpc://'\n)\n\ncelery = make_celery(app)\n</code></pre>"},{"location":"integration/web-frameworks/#_5","title":"\u5b9a\u7fa9\u4efb\u52d9","text":"<p>\u5728 <code>app/tasks.py</code> \u4e2d\u5b9a\u7fa9\u4efb\u52d9\uff1a</p> <pre><code>from . import celery\n\n@celery.task()\ndef process_data(data):\n    # \u6a21\u64ec\u8655\u7406\u6578\u64da\n    print(f\"\u8655\u7406\u6578\u64da\uff1a{data}\")\n    return f\"\u5df2\u8655\u7406\uff1a{data}\"\n</code></pre>"},{"location":"integration/web-frameworks/#_6","title":"\u5728\u8def\u7531\u4e2d\u8abf\u7528\u4efb\u52d9","text":"<p>\u5728 Flask \u8def\u7531\u4e2d\u7570\u6b65\u8abf\u7528\u4efb\u52d9\uff1a</p> <pre><code>from flask import jsonify\nfrom .tasks import process_data\n\n@app.route('/process/&lt;data&gt;')\ndef process(data):\n    task = process_data.delay(data)\n    return jsonify({'task_id': task.id, 'status': '\u4efb\u52d9\u5df2\u63d0\u4ea4'})\n</code></pre>"},{"location":"integration/web-frameworks/#_7","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u8655\u7406\u61c9\u7528\u4e0a\u4e0b\u6587\uff1aFlask \u7684\u4efb\u52d9\u9700\u8981\u61c9\u7528\u4e0a\u4e0b\u6587\uff0c\u4f7f\u7528\u4e0a\u8ff0 <code>ContextTask</code> \u985e\u78ba\u4fdd\u4efb\u52d9\u57f7\u884c\u6642\u80fd\u5920\u8a2a\u554f Flask \u7684\u914d\u7f6e\u548c\u8cc7\u6599\u5eab\u3002</li> <li>\u7d50\u679c\u8ffd\u8e64\uff1a\u82e5\u9700\u8981\u7d50\u679c\uff0c\u53ef\u4ee5\u901a\u904e <code>task.get()</code> \u6216 API \u67e5\u8a62\u4efb\u52d9\u72c0\u614b\u3002</li> </ul>"},{"location":"integration/web-frameworks/#celery-fastapi","title":"Celery \u8207 FastAPI \u6574\u5408","text":"<p>FastAPI \u662f\u4e00\u500b\u73fe\u4ee3\u7684\u975e\u540c\u6b65 Web \u6846\u67b6\uff0c\u8207 Celery \u7684\u6574\u5408\u9069\u5408\u9700\u8981\u9ad8\u6027\u80fd\u7684\u61c9\u7528\u3002</p>"},{"location":"integration/web-frameworks/#_8","title":"\u5b89\u88dd\u8207\u914d\u7f6e","text":"<p>\u5b89\u88dd\u5fc5\u8981\u7684\u5957\u4ef6\uff1a</p> <pre><code>pip install celery fastapi uvicorn\n</code></pre> <p>\u5275\u5efa Celery \u61c9\u7528\uff08\u4f8b\u5982 <code>celery_app.py</code>\uff09\uff1a</p> <pre><code>from celery import Celery\n\ncelery = Celery('tasks', broker='amqp://localhost', backend='rpc://')\ncelery.conf.update(\n    task_serializer='json',\n    accept_content=['json'],\n    result_serializer='json',\n)\n</code></pre>"},{"location":"integration/web-frameworks/#_9","title":"\u5b9a\u7fa9\u4efb\u52d9","text":"<p>\u5728 <code>tasks.py</code> \u4e2d\u5b9a\u7fa9\u4efb\u52d9\uff1a</p> <pre><code>from celery_app import celery\n\n@celery.task\ndef long_running_task(data):\n    # \u6a21\u64ec\u9577\u6642\u9593\u4efb\u52d9\n    import time\n    time.sleep(5)\n    return f\"\u8655\u7406\u5b8c\u6210\uff1a{data}\"\n</code></pre>"},{"location":"integration/web-frameworks/#fastapi","title":"\u5728 FastAPI \u4e2d\u8abf\u7528\u4efb\u52d9","text":"<p>\u5728 FastAPI \u61c9\u7528\u4e2d\uff08\u4f8b\u5982 <code>main.py</code>\uff09\uff1a</p> <pre><code>from fastapi import FastAPI, BackgroundTasks\nfrom tasks import long_running_task\n\napp = FastAPI()\n\n@app.post(\"/process/{data}\")\nasync def process_data(data: str, background_tasks: BackgroundTasks):\n    task = long_running_task.delay(data)\n    return {\"task_id\": task.id, \"message\": \"\u4efb\u52d9\u5df2\u63d0\u4ea4\"}\n</code></pre>"},{"location":"integration/web-frameworks/#_10","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u975e\u540c\u6b65\u8abf\u7528\uff1aFastAPI \u662f\u975e\u540c\u6b65\u6846\u67b6\uff0c\u4f46 Celery \u7684 <code>.delay()</code> \u662f\u540c\u6b65\u7684\uff0c\u78ba\u4fdd\u4e0d\u6703\u963b\u585e\u4e3b\u7dda\u7a0b\u3002</li> <li>\u80cc\u666f\u4efb\u52d9\uff1a\u53ef\u4ee5\u4f7f\u7528 FastAPI \u7684 <code>BackgroundTasks</code> \u9032\u4e00\u6b65\u7ba1\u7406\u7570\u6b65\u884c\u70ba\u3002</li> </ul>"},{"location":"integration/web-frameworks/#_11","title":"\u7e3d\u7d50\u8207\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u9078\u64c7\u5408\u9069\u7684\u6846\u67b6\uff1a\u6839\u64da\u60a8\u7684\u9805\u76ee\u9700\u6c42\u9078\u64c7\u6846\u67b6\uff0cDjango \u9069\u5408\u5927\u578b\u9805\u76ee\uff0cFlask \u9069\u5408\u8f15\u91cf\u7d1a\u61c9\u7528\uff0cFastAPI \u9069\u5408\u9ad8\u6027\u80fd\u975e\u540c\u6b65\u61c9\u7528\u3002</li> <li>\u907f\u514d\u963b\u585e\uff1a\u7121\u8ad6\u4f7f\u7528\u54ea\u500b\u6846\u67b6\uff0c\u78ba\u4fdd Web \u8acb\u6c42\u4e0d\u76f4\u63a5\u57f7\u884c\u4efb\u52d9\uff0c\u800c\u662f\u4f7f\u7528 <code>.delay()</code> \u6216 <code>.apply_async()</code>\u3002</li> <li>\u76e3\u63a7\u4efb\u52d9\u72c0\u614b\uff1a\u5728 Web \u61c9\u7528\u4e2d\u63d0\u4f9b\u4efb\u52d9\u72c0\u614b\u67e5\u8a62\u529f\u80fd\uff0c\u63d0\u5347\u7528\u6236\u9ad4\u9a57\u3002</li> <li>\u932f\u8aa4\u8655\u7406\uff1a\u5728\u4efb\u52d9\u4e2d\u52a0\u5165\u932f\u8aa4\u8655\u7406\uff0c\u907f\u514d\u56e0\u4efb\u52d9\u5931\u6557\u5f71\u97ff\u7528\u6236\u9ad4\u9a57\u3002</li> </ul> <p>\u901a\u904e\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u8f15\u9b06\u5c07 Celery \u6574\u5408\u5230 Web \u6846\u67b6\u4e2d\uff0c\u5be6\u73fe\u9ad8\u6548\u7684\u7570\u6b65\u4efb\u52d9\u8655\u7406\u3002</p>"},{"location":"kombu/","title":"Kombu \u6df1\u5165\u5b78\u7fd2","text":""},{"location":"kombu/#kombu_1","title":"Kombu \u662f\u4ec0\u9ebc\uff1f","text":"<p>Kombu \u662f\u4e00\u500b Python \u5de5\u5177\u5eab\uff0c\u5c08\u9580\u7528\u4f86\u8655\u7406\u300c\u6d88\u606f\u50b3\u8f38\u300d\u3002\u7c21\u55ae\u4f86\u8aaa\uff0c\u5b83\u5e6b\u6211\u5011\u5728\u4e0d\u540c\u7684\u7cfb\u7d71\u6216\u96fb\u8166\u4e4b\u9593\u50b3\u905e\u6578\u64da\u6216\u4efb\u52d9\u3002\u5b83\u662f Celery\uff08\u4e00\u500b\u4efb\u52d9\u968a\u5217\u5de5\u5177\uff09\u7684\u6838\u5fc3\u5f15\u64ce\uff0c\u8ca0\u8cac\u78ba\u4fdd\u6d88\u606f\u80fd\u6b63\u78ba\u5730\u767c\u9001\u548c\u63a5\u6536\u3002\u7121\u8ad6\u662f\u8b93\u591a\u53f0\u96fb\u8166\u4e00\u8d77\u8655\u7406\u4efb\u52d9\uff0c\u9084\u662f\u78ba\u4fdd\u4efb\u52d9\u6309\u9806\u5e8f\u5b8c\u6210\uff0cKombu \u90fd\u662f\u80cc\u5f8c\u7684\u91cd\u8981\u63a8\u624b\u3002</p> <p>\u60f3\u50cf\u60a8\u5728\u7d93\u71df\u4e00\u5bb6\u5feb\u905e\u516c\u53f8\uff0cKombu \u5c31\u50cf\u662f\u9019\u5bb6\u516c\u53f8\u7684\u6838\u5fc3\u7cfb\u7d71\uff0c\u8ca0\u8cac\u5b89\u6392\u5305\u88f9\uff08\u6d88\u606f\uff09\u7684\u904b\u9001\u8def\u7dda\u3001\u78ba\u4fdd\u5305\u88f9\u4e0d\u4e1f\u5931\uff0c\u4e26\u4e14\u80fd\u9069\u61c9\u4e0d\u540c\u7684\u904b\u8f38\u65b9\u5f0f\uff08\u50cf\u662f RabbitMQ \u6216 Redis \u9019\u4e9b\u6d88\u606f\u4ee3\u7406\uff09\u3002</p>"},{"location":"kombu/#kombu_2","title":"\u70ba\u4ec0\u9ebc\u8981\u5b78\u7fd2 Kombu\uff1f","text":"<p>\u60a8\u53ef\u80fd\u6703\u60f3\uff1a\u300c\u6211\u76f4\u63a5\u7528 Celery \u4e0d\u5c31\u597d\u4e86\uff0c\u70ba\u4ec0\u9ebc\u8981\u5b78 Kombu\uff1f\u300d\u5176\u5be6\uff0cKombu \u662f Celery \u7684\u300c\u5167\u90e8\u5f15\u64ce\u300d\u3002\u4e86\u89e3 Kombu \u5c31\u50cf\u4e86\u89e3\u6c7d\u8eca\u7684\u5f15\u64ce\u2014\u2014\u96d6\u7136\u4e0d\u4e00\u5b9a\u6bcf\u5929\u90fd\u8981\u4fee\u5f15\u64ce\uff0c\u4f46\u77e5\u9053\u5b83\u5982\u4f55\u904b\u4f5c\u80fd\u8b93\u60a8\u66f4\u597d\u5730\u4f7f\u7528\u5de5\u5177\uff0c\u751a\u81f3\u5728\u51fa\u554f\u984c\u6642\u5feb\u901f\u627e\u5230\u89e3\u6c7a\u65b9\u6cd5\u3002</p> <p>\u5b78\u7fd2 Kombu \u53ef\u4ee5\u5e6b\u52a9\u60a8\uff1a</p> <ul> <li>\u7406\u89e3\u6d88\u606f\u5982\u4f55\u5728\u7cfb\u7d71\u9593\u6d41\u52d5</li> <li>\u89e3\u6c7a Celery \u4f7f\u7528\u4e2d\u7684\u5e95\u5c64\u554f\u984c</li> <li>\u81ea\u5b9a\u7fa9\u6d88\u606f\u8655\u7406\u65b9\u5f0f\uff0c\u6eff\u8db3\u7279\u6b8a\u9700\u6c42</li> </ul>"},{"location":"kombu/#_1","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5728\u672c\u90e8\u5206\u4e2d\uff0c\u6211\u5011\u6703\u5f9e\u57fa\u672c\u6982\u5ff5\u958b\u59cb\uff0c\u9010\u6b65\u5e36\u60a8\u9032\u5165 Kombu \u7684\u4e16\u754c\uff1a</p> <ul> <li>\u641e\u6e05\u695a Kombu \u7684\u57fa\u672c\u7d44\u6210\u90e8\u5206\u548c\u904b\u4f5c\u539f\u7406</li> <li>\u5b78\u6703\u5982\u4f55\u767c\u9001\u548c\u63a5\u6536\u6d88\u606f</li> <li>\u63a2\u7d22\u5982\u4f55\u6839\u64da\u60a8\u7684\u9700\u6c42\u8abf\u6574 Kombu \u7684\u884c\u70ba</li> </ul>"},{"location":"kombu/#_2","title":"\u5167\u5bb9\u5c0e\u89bd","text":"<ul> <li>Kombu \u67b6\u69cb\uff1a\u5b83\u662f\u5982\u4f55\u7d44\u7e54\u7684\uff1f</li> <li>\u6d88\u606f\u5e8f\u5217\u5316\uff1a\u6d88\u606f\u5982\u4f55\u6253\u5305\uff1f</li> <li>\u50b3\u8f38\u5c64\u62bd\u8c61\uff1a\u5982\u4f55\u9069\u914d\u4e0d\u540c\u5de5\u5177\uff1f</li> <li>\u81ea\u5b9a\u7fa9\u6d88\u8cbb\u8005\uff1a\u5982\u4f55\u63a5\u6536\u6d88\u606f\uff1f</li> <li>\u81ea\u5b9a\u7fa9\u751f\u7522\u8005\uff1a\u5982\u4f55\u767c\u9001\u6d88\u606f\uff1f</li> </ul>"},{"location":"kombu/architecture/","title":"Kombu \u67b6\u69cb\uff1a\u5b83\u662f\u5982\u4f55\u7d44\u7e54\u7684\uff1f","text":""},{"location":"kombu/architecture/#kombu_1","title":"Kombu \u7684\u57fa\u672c\u7d50\u69cb","text":"<p>Kombu \u7684\u8a2d\u8a08\u5c31\u50cf\u4e00\u500b\u5feb\u905e\u7cfb\u7d71\uff0c\u76ee\u7684\u662f\u8b93\u6d88\u606f\uff08\u6578\u64da\u6216\u4efb\u52d9\uff09\u80fd\u5f9e\u767c\u9001\u65b9\u9806\u5229\u5230\u9054\u63a5\u6536\u65b9\u3002\u70ba\u4e86\u505a\u5230\u9019\u4e00\u9ede\uff0c\u5b83\u628a\u5de5\u4f5c\u5206\u6210\u5e7e\u500b\u6838\u5fc3\u90e8\u5206\uff0c\u6bcf\u500b\u90e8\u5206\u8ca0\u8cac\u4e0d\u540c\u7684\u4efb\u52d9\u3002\u8b93\u6211\u5011\u4f86\u770b\u770b\u9019\u4e9b\u90e8\u5206\u662f\u4ec0\u9ebc\uff0c\u4ee5\u53ca\u5b83\u5011\u5982\u4f55\u5408\u4f5c\u3002</p>"},{"location":"kombu/architecture/#kombu_2","title":"Kombu \u7684\u6838\u5fc3\u7d44\u6210\u90e8\u5206","text":"<ul> <li>Connection\uff08\u9023\u63a5\uff09\uff1a\u9019\u662f Kombu \u8207\u300c\u6d88\u606f\u4ee3\u7406\u300d\uff08\u50cf\u662f RabbitMQ\uff09\u4e4b\u9593\u7684\u901a\u9053\u3002\u60f3\u50cf\u9019\u662f\u4e00\u689d\u96fb\u8a71\u7dda\uff0c\u78ba\u4fdd\u6211\u5011\u80fd\u8207\u5c0d\u65b9\u806f\u7e6b\u4e0a\u3002</li> <li>Exchange\uff08\u4ea4\u63db\u6a5f\uff09\uff1a\u9019\u662f\u6d88\u606f\u7684\u300c\u5206\u767c\u4e2d\u5fc3\u300d\u3002\u5b83\u6c7a\u5b9a\u6d88\u606f\u61c9\u8a72\u53bb\u54ea\u500b\u5730\u65b9\u3002\u5c31\u50cf\u5feb\u905e\u516c\u53f8\u7684\u5206\u63c0\u4e2d\u5fc3\uff0c\u6839\u64da\u5730\u5740\u628a\u5305\u88f9\u9001\u5230\u6b63\u78ba\u7684\u5730\u9ede\u3002</li> <li>Queue\uff08\u968a\u5217\uff09\uff1a\u9019\u662f\u6d88\u606f\u7684\u300c\u5b58\u5132\u9ede\u300d\u3002\u6d88\u606f\u5728\u9019\u88e1\u7b49\u5f85\uff0c\u76f4\u5230\u6709\u4eba\u4f86\u53d6\u3002\u5c31\u50cf\u60a8\u7684\u90f5\u7bb1\uff0c\u5305\u88f9\u6703\u7559\u5728\u88e1\u9762\u76f4\u5230\u60a8\u6253\u958b\u5b83\u3002</li> <li>Producer\uff08\u751f\u7522\u8005\uff09\uff1a\u9019\u662f\u300c\u767c\u9001\u8005\u300d\uff0c\u8ca0\u8cac\u628a\u6d88\u606f\u9001\u5230\u4ea4\u63db\u6a5f\u3002\u5c31\u50cf\u60a8\u628a\u4fe1\u4ef6\u6295\u5165\u90f5\u7b52\u3002</li> <li>Consumer\uff08\u6d88\u8cbb\u8005\uff09\uff1a\u9019\u662f\u300c\u63a5\u6536\u8005\u300d\uff0c\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u6d88\u606f\u4e26\u8655\u7406\u5b83\u3002\u5c31\u50cf\u60a8\u5f9e\u90f5\u7bb1\u53d6\u51fa\u4fe1\u4ef6\u4e26\u95b1\u8b80\u3002</li> </ul>"},{"location":"kombu/architecture/#kombu_3","title":"Kombu \u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1f","text":"<p>\u8b93\u6211\u5011\u7528\u4e00\u500b\u7c21\u55ae\u7684\u6545\u4e8b\u4f86\u7406\u89e3 Kombu \u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a</p> <ul> <li>\u60a8\uff08Producer\uff09\u5beb\u4e86\u4e00\u5c01\u4fe1\uff08\u6d88\u606f\uff09\uff0c\u4e26\u6295\u5165\u90f5\u7b52\uff08Exchange\uff09\u3002</li> <li>\u90f5\u5c40\uff08Exchange\uff09\u6839\u64da\u4fe1\u4e0a\u7684\u5730\u5740\uff08\u8def\u7531\u898f\u5247\uff09\uff0c\u628a\u4fe1\u9001\u5230\u6b63\u78ba\u7684\u90f5\u7bb1\uff08Queue\uff09\u3002</li> <li>\u6536\u4ef6\u4eba\uff08Consumer\uff09\u6253\u958b\u90f5\u7bb1\uff0c\u53d6\u51fa\u4fe1\u4ef6\u4e26\u95b1\u8b80\uff08\u8655\u7406\u6d88\u606f\uff09\u3002</li> </ul> <p>\u5728 Kombu \u4e2d\uff0c\u5be6\u969b\u6b65\u9a5f\u662f\u9019\u6a23\u7684\uff1a</p> <ul> <li>\u9996\u5148\u5efa\u7acb\u8207\u6d88\u606f\u4ee3\u7406\u7684\u9023\u63a5\uff08Connection\uff09\u3002</li> <li>\u5b9a\u7fa9\u597d\u4ea4\u63db\u6a5f\uff08Exchange\uff09\u548c\u968a\u5217\uff08Queue\uff09\uff0c\u4e26\u8a2d\u5b9a\u597d\u8def\u7531\u898f\u5247\uff08\u6bd4\u5982\u300c\u6240\u6709\u6a19\u8a18\u70ba 'urgent' \u7684\u6d88\u606f\u53bb\u67d0\u500b\u968a\u5217\u300d\uff09\u3002</li> <li>\u751f\u7522\u8005\uff08Producer\uff09\u767c\u9001\u6d88\u606f\u5230\u4ea4\u63db\u6a5f\u3002</li> <li>\u4ea4\u63db\u6a5f\u6839\u64da\u898f\u5247\u628a\u6d88\u606f\u9001\u5230\u6b63\u78ba\u7684\u968a\u5217\u3002</li> <li>\u6d88\u8cbb\u8005\uff08Consumer\uff09\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u6d88\u606f\u4e26\u8655\u7406\u3002</li> </ul>"},{"location":"kombu/architecture/#_1","title":"\u9019\u6a23\u7684\u8a2d\u8a08\u6709\u4ec0\u9ebc\u597d\u8655\uff1f","text":"<ul> <li>\u5206\u5de5\u6e05\u6670\uff1a\u6bcf\u500b\u90e8\u5206\u8ca0\u8cac\u4e00\u500b\u529f\u80fd\uff0c\u5bb9\u6613\u7406\u89e3\u548c\u8abf\u6574\u3002</li> <li>\u9748\u6d3b\u9069\u914d\uff1a\u7121\u8ad6\u7528\u7684\u662f RabbitMQ \u9084\u662f Redis\uff0cKombu \u90fd\u80fd\u901a\u904e\u7d71\u4e00\u7684\u65b9\u5f0f\u5de5\u4f5c\u3002</li> <li>\u8207 Celery \u914d\u5408\uff1aCelery \u5229\u7528 Kombu \u7684\u67b6\u69cb\u4f86\u5be6\u73fe\u4efb\u52d9\u5206\u767c\uff0c\u5b78\u6703 Kombu \u80fd\u8b93\u60a8\u66f4\u597d\u5730\u4f7f\u7528 Celery\u3002</li> </ul>"},{"location":"kombu/custom-consumers/","title":"\u81ea\u5b9a\u7fa9\u6d88\u8cbb\u8005\uff1a\u5982\u4f55\u63a5\u6536\u6d88\u606f\uff1f","text":""},{"location":"kombu/custom-consumers/#_2","title":"\u4ec0\u9ebc\u662f\u6d88\u8cbb\u8005\uff1f","text":"<p>\u5728 Kombu \u4e2d\uff0c\u300c\u6d88\u8cbb\u8005\u300d\uff08Consumer\uff09\u662f\u8ca0\u8cac\u63a5\u6536\u6d88\u606f\u4e26\u8655\u7406\u5b83\u7684\u4e00\u65b9\u3002\u5c31\u50cf\u60a8\u5f9e\u90f5\u7bb1\u53d6\u4fe1\u4e26\u95b1\u8b80\uff0c\u6d88\u8cbb\u8005\u5f9e\u300c\u968a\u5217\u300d\u4e2d\u53d6\u51fa\u6d88\u606f\uff0c\u7136\u5f8c\u505a\u4e00\u4e9b\u4e8b\u60c5\uff08\u6bd4\u5982\u57f7\u884c\u4efb\u52d9\uff09\u3002</p>"},{"location":"kombu/custom-consumers/#_3","title":"\u70ba\u4ec0\u9ebc\u8981\u81ea\u5b9a\u7fa9\u6d88\u8cbb\u8005\uff1f","text":"<p>\u96d6\u7136 Celery \u63d0\u4f9b\u4e86\u73fe\u6210\u7684\u6d88\u8cbb\u8005\uff08Worker\uff09\uff0c\u4f46\u81ea\u5b9a\u7fa9\u6d88\u8cbb\u8005\u8b93\u60a8\u80fd\u5b8c\u5168\u63a7\u5236\u6d88\u606f\u7684\u8655\u7406\u65b9\u5f0f\uff0c\u6bd4\u5982\u6c7a\u5b9a\u4ec0\u9ebc\u6642\u5019\u78ba\u8a8d\u6d88\u606f\u3001\u5982\u4f55\u8655\u7406\u932f\u8aa4\u7b49\u3002\u9019\u5728\u9700\u8981\u7279\u6b8a\u908f\u8f2f\u6642\u7279\u5225\u6709\u7528\u3002</p>"},{"location":"kombu/custom-consumers/#_4","title":"\u7c21\u55ae\u5be6\u8e10\uff1a\u5275\u5efa\u4e00\u500b\u6d88\u8cbb\u8005","text":"<p>\u8b93\u6211\u5011\u5f9e\u6700\u7c21\u55ae\u7684\u4f8b\u5b50\u958b\u59cb\uff1a\u63a5\u6536\u4e00\u689d\u6d88\u606f\u4e26\u6253\u5370\u51fa\u4f86\u3002</p> <pre><code>from kombu import Connection, Consumer, Exchange, Queue\n\n# \u5efa\u7acb\u9023\u63a5\nconn = Connection('amqp://localhost')\nexchange = Exchange('my_exchange', type='direct')\nqueue = Queue('my_queue', exchange, routing_key='greeting')\n\n# \u5b9a\u7fa9\u5982\u4f55\u8655\u7406\u6d88\u606f\ndef process_message(body, message):\n    print(f\"\u6536\u5230\u6d88\u606f\uff1a{body}\")\n    message.ack()  # \u544a\u8a34\u7cfb\u7d71\uff1a\u6211\u5df2\u7d93\u8655\u7406\u5b8c\u4e86\n\n# \u5275\u5efa\u6d88\u8cbb\u8005\u4e26\u958b\u59cb\u63a5\u6536\nwith Consumer(conn, queues=queue, callbacks=[process_message], accept=['json']):\n    conn.drain_events()  # \u7b49\u5f85\u6d88\u606f\uff08\u6703\u4e00\u76f4\u904b\u884c\uff09\n</code></pre> <p>\u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff1a</p> <ol> <li>\u6211\u5011\u9023\u63a5\u5230\u6d88\u606f\u4ee3\u7406\uff08\u9019\u88e1\u7528 RabbitMQ\uff09\u3002</li> <li>\u5b9a\u7fa9\u4e86\u4e00\u500b\u4ea4\u63db\u6a5f\u548c\u968a\u5217\uff0c\u544a\u8a34\u7cfb\u7d71\u6211\u5011\u8981\u5f9e\u54ea\u88e1\u53d6\u6d88\u606f\u3002</li> <li>\u5b9a\u7fa9\u4e86\u4e00\u500b\u51fd\u6578 <code>process_message</code>\uff0c\u544a\u8a34\u7cfb\u7d71\u6536\u5230\u6d88\u606f\u5f8c\u8981\u505a\u4ec0\u9ebc\u3002</li> <li>\u5275\u5efa\u6d88\u8cbb\u8005\uff0c\u958b\u59cb\u7b49\u5f85\u6d88\u606f\u3002</li> </ol>"},{"location":"kombu/custom-consumers/#_5","title":"\u66f4\u9032\u4e00\u6b65\uff1a\u8655\u7406\u932f\u8aa4","text":"<p>\u6709\u6642\u5019\uff0c\u8655\u7406\u6d88\u606f\u53ef\u80fd\u6703\u51fa\u932f\uff08\u6bd4\u5982\u6578\u64da\u683c\u5f0f\u4e0d\u5c0d\uff09\u3002\u6211\u5011\u53ef\u4ee5\u544a\u8a34\u7cfb\u7d71\uff0c\u5982\u679c\u51fa\u932f\uff0c\u61c9\u8a72\u628a\u6d88\u606f\u653e\u56de\u53bb\u91cd\u65b0\u8655\u7406\uff1a</p> <pre><code>def process_message(body, message):\n    try:\n        print(f\"\u8655\u7406\u6d88\u606f\uff1a{body}\")\n        # \u6a21\u64ec\u932f\u8aa4\n        if 'error' in body:\n            raise ValueError(\"\u51fa\u932f\u4e86\uff01\")\n        message.ack()  # \u6210\u529f\u5c31\u78ba\u8a8d\n    except Exception as e:\n        print(f\"\u932f\u8aa4\uff1a{e}\")\n        message.reject(requeue=True)  # \u51fa\u932f\u5c31\u653e\u56de\u53bb\n</code></pre>"},{"location":"kombu/custom-consumers/#_6","title":"\u5c0f\u6280\u5de7","text":"<ul> <li>\u78ba\u8a8d\u6d88\u606f\uff1a\u8655\u7406\u5b8c\u4e00\u5b9a\u8981\u8abf\u7528 <code>message.ack()</code>\uff0c\u4e0d\u7136\u6d88\u606f\u6703\u4e00\u76f4\u7559\u5728\u968a\u5217\u4e2d\u3002</li> <li>\u591a\u500b\u6d88\u606f\uff1a\u53ef\u4ee5\u8a2d\u7f6e <code>prefetch_count</code> \u4e00\u6b21\u8655\u7406\u591a\u689d\u6d88\u606f\uff0c\u52a0\u5feb\u901f\u5ea6\u3002</li> <li>\u505c\u6b62\u63a5\u6536\uff1a\u53ef\u4ee5\u7528 <code>consumer.cancel()</code> \u505c\u6b62\u6d88\u8cbb\u8005\u3002</li> </ul>"},{"location":"kombu/custom-consumers/#_7","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u4e0d\u8981\u5fd8\u8a18\u78ba\u8a8d\u6d88\u606f\uff0c\u5426\u5247\u968a\u5217\u6703\u8d8a\u7a4d\u8d8a\u591a\u3002</li> <li>\u5982\u679c\u6d88\u8cbb\u8005\u904b\u884c\u5f88\u4e45\uff0c\u53ef\u80fd\u6703\u5360\u7528\u5f88\u591a\u5167\u5b58\uff0c\u8a18\u5f97\u5076\u723e\u91cd\u555f\u3002</li> <li>\u8a18\u9304\u932f\u8aa4\u4fe1\u606f\uff0c\u65b9\u4fbf\u67e5\u627e\u554f\u984c\u3002</li> </ul> <p>\u901a\u904e\u9019\u500b\u7ae0\u7bc0\uff0c\u60a8\u5df2\u7d93\u5b78\u6703\u4e86\u5982\u4f55\u63a5\u6536\u4e26\u8655\u7406\u6d88\u606f\u3002\u4e0b\u4e00\u7ae0\u6211\u5011\u6703\u770b\u770b\u5982\u4f55\u767c\u9001\u6d88\u606f\uff01</p>"},{"location":"kombu/custom-producers/","title":"\u81ea\u5b9a\u7fa9\u751f\u7522\u8005\uff1a\u5982\u4f55\u767c\u9001\u6d88\u606f\uff1f","text":""},{"location":"kombu/custom-producers/#_2","title":"\u4ec0\u9ebc\u662f\u751f\u7522\u8005\uff1f","text":"<p>\u5728 Kombu \u4e2d\uff0c\u300c\u751f\u7522\u8005\u300d\uff08Producer\uff09\u662f\u8ca0\u8cac\u767c\u9001\u6d88\u606f\u7684\u4e00\u65b9\u3002\u5c31\u50cf\u60a8\u628a\u4fe1\u6295\u5165\u90f5\u7b52\uff0c\u751f\u7522\u8005\u628a\u6d88\u606f\u9001\u5230\u300c\u4ea4\u63db\u6a5f\u300d\uff0c\u7136\u5f8c\u7cfb\u7d71\u6703\u5e6b\u5fd9\u5206\u767c\u5230\u6b63\u78ba\u7684\u5730\u65b9\u3002</p>"},{"location":"kombu/custom-producers/#_3","title":"\u70ba\u4ec0\u9ebc\u8981\u81ea\u5b9a\u7fa9\u751f\u7522\u8005\uff1f","text":"<p>\u96d6\u7136 Celery \u63d0\u4f9b\u4e86\u7c21\u55ae\u7684\u65b9\u5f0f\uff08\u6bd4\u5982 <code>@app.task</code>\uff09\u4f86\u767c\u9001\u4efb\u52d9\uff0c\u4f46\u81ea\u5b9a\u7fa9\u751f\u7522\u8005\u8b93\u60a8\u80fd\u66f4\u7cbe\u7d30\u5730\u63a7\u5236\u6d88\u606f\uff0c\u6bd4\u5982\u6c7a\u5b9a\u6d88\u606f\u53bb\u54ea\u88e1\u3001\u5982\u4f55\u6253\u5305\u3001\u662f\u5426\u9700\u8981\u6301\u4e45\u4fdd\u5b58\u7b49\u3002</p>"},{"location":"kombu/custom-producers/#_4","title":"\u7c21\u55ae\u5be6\u8e10\uff1a\u5275\u5efa\u4e00\u500b\u751f\u7522\u8005","text":"<p>\u8b93\u6211\u5011\u5f9e\u6700\u7c21\u55ae\u7684\u4f8b\u5b50\u958b\u59cb\uff1a\u767c\u9001\u4e00\u689d\u6d88\u606f\u3002</p> <pre><code>from kombu import Connection, Producer, Exchange\n\n# \u5efa\u7acb\u9023\u63a5\nconn = Connection('amqp://localhost')\nexchange = Exchange('my_exchange', type='direct')\n\n# \u5275\u5efa\u751f\u7522\u8005\nproducer = Producer(conn, exchange, routing_key='greeting')\n\n# \u767c\u9001\u6d88\u606f\nproducer.publish({'name': 'Alice', 'message': 'Hello!'}, serializer='json')\nprint(\"\u6d88\u606f\u5df2\u767c\u9001\uff01\")\n</code></pre> <p>\u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff1a</p> <ol> <li>\u6211\u5011\u9023\u63a5\u5230\u6d88\u606f\u4ee3\u7406\u3002</li> <li>\u5b9a\u7fa9\u4e86\u4e00\u500b\u4ea4\u63db\u6a5f\uff0c\u544a\u8a34\u7cfb\u7d71\u6d88\u606f\u8981\u53bb\u54ea\u500b\u300c\u5206\u767c\u4e2d\u5fc3\u300d\u3002</li> <li>\u5275\u5efa\u751f\u7522\u8005\uff0c\u4e26\u6307\u5b9a\u6d88\u606f\u7684\u300c\u5730\u5740\u300d\uff08routing_key\uff09\u3002</li> <li>\u767c\u9001\u6d88\u606f\uff0c\u7cfb\u7d71\u6703\u5e6b\u6211\u5011\u5206\u767c\u3002</li> </ol>"},{"location":"kombu/custom-producers/#_5","title":"\u66f4\u9032\u4e00\u6b65\uff1a\u78ba\u4fdd\u6d88\u606f\u4e0d\u4e1f\u5931","text":"<p>\u6709\u6642\u5019\uff0c\u6d88\u606f\u4ee3\u7406\u53ef\u80fd\u6703\u91cd\u555f\uff0c\u6211\u5011\u5e0c\u671b\u6d88\u606f\u4e0d\u8981\u4e1f\u5931\u3002\u9019\u6642\u53ef\u4ee5\u8a2d\u7f6e\u300c\u6301\u4e45\u5316\u300d\uff1a</p> <pre><code># \u767c\u9001\u6301\u4e45\u5316\u6d88\u606f\nproducer.publish(\n    {'name': 'Alice', 'message': 'Important!'},\n    serializer='json',\n    routing_key='greeting',\n    delivery_mode=2  # 2 \u8868\u793a\u6301\u4e45\u5316\n)\n</code></pre>"},{"location":"kombu/custom-producers/#_6","title":"\u5c0f\u6280\u5de7","text":"<ul> <li>\u91cd\u8a66\u6a5f\u5236\uff1a\u5982\u679c\u767c\u9001\u5931\u6557\uff0c\u53ef\u4ee5\u8a2d\u7f6e <code>retry=True</code> \u8b93 Kombu \u81ea\u52d5\u91cd\u8a66\u3002</li> <li>\u512a\u5148\u7d1a\uff1a\u53ef\u4ee5\u8a2d\u7f6e <code>priority</code> \u8b93\u91cd\u8981\u6d88\u606f\u512a\u5148\u8655\u7406\uff08\u5982\u679c\u6d88\u606f\u4ee3\u7406\u652f\u6301\uff09\u3002</li> <li>\u591a\u500b\u4ea4\u63db\u6a5f\uff1a\u53ef\u4ee5\u6839\u64da\u9700\u6c42\u628a\u6d88\u606f\u767c\u9001\u5230\u4e0d\u540c\u7684\u4ea4\u63db\u6a5f\u3002</li> </ul>"},{"location":"kombu/custom-producers/#_7","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u78ba\u4fdd\u4ea4\u63db\u6a5f\u548c\u968a\u5217\u5df2\u7d93\u8a2d\u7f6e\u597d\uff0c\u4e0d\u7136\u6d88\u606f\u53ef\u80fd\u9001\u4e0d\u5230\u3002</li> <li>\u6d88\u606f\u592a\u5927\u53ef\u80fd\u5f71\u97ff\u901f\u5ea6\uff0c\u5efa\u8b70\u9069\u7576\u58d3\u7e2e\u6216\u62c6\u5206\u3002</li> <li>\u8a18\u9304\u767c\u9001\u5931\u6557\u7684\u60c5\u6cc1\uff0c\u65b9\u4fbf\u6392\u67e5\u554f\u984c\u3002</li> </ul> <p>\u901a\u904e\u9019\u500b\u7ae0\u7bc0\uff0c\u60a8\u5df2\u7d93\u5b78\u6703\u4e86\u5982\u4f55\u767c\u9001\u6d88\u606f\u3002\u7d50\u5408\u524d\u9762\u7684\u5167\u5bb9\uff0c\u60a8\u53ef\u4ee5\u958b\u59cb\u69cb\u5efa\u81ea\u5df1\u7684\u6d88\u606f\u7cfb\u7d71\u4e86\uff01</p>"},{"location":"kombu/message-serialization/","title":"\u6d88\u606f\u5e8f\u5217\u5316\uff1a\u6d88\u606f\u5982\u4f55\u6253\u5305\uff1f","text":""},{"location":"kombu/message-serialization/#_2","title":"\u4ec0\u9ebc\u662f\u6d88\u606f\u5e8f\u5217\u5316\uff1f","text":"<p>\u5728\u7db2\u7d61\u4e0a\u50b3\u8f38\u6578\u64da\u6642\uff0c\u6211\u5011\u9700\u8981\u628a Python \u4e2d\u7684\u6578\u64da\uff08\u6bd4\u5982\u4e00\u500b\u5b57\u5178\uff09\u8f49\u63db\u6210\u80fd\u5728\u7db2\u7d61\u4e0a\u50b3\u9001\u7684\u683c\u5f0f\uff0c\u7136\u5f8c\u5728\u53e6\u4e00\u7aef\u518d\u628a\u5b83\u8f49\u56de\u4f86\u3002\u9019\u500b\u904e\u7a0b\u5c31\u53eb\u505a\u300c\u5e8f\u5217\u5316\u300d\uff08\u6253\u5305\uff09\u548c\u300c\u53cd\u5e8f\u5217\u5316\u300d\uff08\u89e3\u5305\uff09\u3002</p> <p>\u5728 Kombu \u4e2d\uff0c\u6d88\u606f\u5e8f\u5217\u5316\u5c31\u662f\u628a\u60a8\u7684\u6578\u64da\uff08\u6bd4\u5982\u4efb\u52d9\u53c3\u6578\uff09\u6253\u5305\u6210\u80fd\u5728\u7db2\u7d61\u4e0a\u50b3\u8f38\u7684\u683c\u5f0f\uff0c\u7136\u5f8c\u5728\u63a5\u6536\u7aef\u89e3\u5305\u9084\u539f\u3002</p>"},{"location":"kombu/message-serialization/#kombu","title":"Kombu \u652f\u6301\u54ea\u4e9b\u6253\u5305\u65b9\u5f0f\uff1f","text":"<p>Kombu \u63d0\u4f9b\u4e86\u5e7e\u7a2e\u4e0d\u540c\u7684\u300c\u6253\u5305\u5de5\u5177\u300d\uff0c\u6bcf\u7a2e\u90fd\u6709\u81ea\u5df1\u7684\u7279\u9ede\uff1a</p> <ul> <li>JSON\uff1a\u9019\u662f\u6700\u5e38\u7528\u7684\u683c\u5f0f\uff0c\u5bb9\u6613\u8b80\u61c2\uff0c\u9069\u5408\u5927\u591a\u6578\u60c5\u6cc1\u3002\u7279\u5225\u662f\u7576\u60a8\u9700\u8981\u8207\u5176\u4ed6\u8a9e\u8a00\u7684\u7cfb\u7d71\u4ea4\u4e92\u6642\uff0cJSON \u662f\u500b\u597d\u9078\u64c7\u3002</li> <li>Pickle\uff1a\u9019\u662f Python \u5c08\u7528\u7684\u6253\u5305\u65b9\u5f0f\uff0c\u80fd\u8655\u7406\u5f88\u8907\u96dc\u7684\u6578\u64da\uff0c\u4f46\u6709\u5b89\u5168\u98a8\u96aa\uff08\u4e0d\u5efa\u8b70\u7528\u65bc\u4e0d\u53d7\u4fe1\u4efb\u7684\u74b0\u5883\uff09\u3002</li> <li>YAML\uff1a\u985e\u4f3c JSON\uff0c\u4f46\u66f4\u9069\u5408\u4eba\u985e\u95b1\u8b80\uff0c\u901f\u5ea6\u7a0d\u6162\u3002</li> <li>MessagePack\uff1a\u9019\u662f\u4e00\u7a2e\u9ad8\u6548\u7684\u683c\u5f0f\uff0c\u6578\u64da\u5c0f\u3001\u901f\u5ea6\u5feb\uff0c\u9069\u5408\u9700\u8981\u9ad8\u6027\u80fd\u7684\u5834\u666f\u3002</li> </ul>"},{"location":"kombu/message-serialization/#_3","title":"\u5982\u4f55\u9078\u64c7\u6253\u5305\u65b9\u5f0f\uff1f","text":"<p>\u9078\u64c7\u6253\u5305\u65b9\u5f0f\u5c31\u50cf\u9078\u64c7\u5bc4\u5305\u88f9\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>\u5982\u679c\u5305\u88f9\u8981\u9001\u5230\u5916\u570b\uff08\u8de8\u8a9e\u8a00\u7cfb\u7d71\uff09\uff0c\u7528 JSON\uff0c\u56e0\u70ba\u5927\u5bb6\u90fd\u8a8d\u8b58\u3002</li> <li>\u5982\u679c\u5305\u88f9\u5f88\u5c0f\u4f46\u8981\u5feb\uff08\u9ad8\u6027\u80fd\u9700\u6c42\uff09\uff0c\u7528 MessagePack\u3002</li> <li>\u5982\u679c\u5305\u88f9\u662f\u7d66\u81ea\u5df1\u4eba\uff08\u7d14 Python \u74b0\u5883\uff09\uff0c\u53ef\u4ee5\u7528 Pickle\uff0c\u4f46\u8981\u5c0f\u5fc3\u5b89\u5168\u554f\u984c\u3002</li> </ul>"},{"location":"kombu/message-serialization/#json","title":"\u7c21\u55ae\u5be6\u8e10\uff1a\u7528 JSON \u6253\u5305\u6d88\u606f","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u500b\u7c21\u55ae\u7684\u4f8b\u5b50\uff0c\u5c55\u793a\u5982\u4f55\u7528 JSON \u683c\u5f0f\u767c\u9001\u6d88\u606f\uff1a</p> <pre><code>from kombu import Connection, Producer, Exchange\n\n# \u5efa\u7acb\u9023\u63a5\nconn = Connection('amqp://localhost')\nexchange = Exchange('my_exchange', type='direct')\n\n# \u5275\u5efa\u751f\u7522\u8005\uff0c\u7528 JSON \u6253\u5305\nproducer = Producer(conn, exchange, serializer='json')\n\n# \u767c\u9001\u6d88\u606f\nproducer.publish({'name': 'Alice', 'age': 25}, routing_key='greeting')\nprint(\"\u6d88\u606f\u5df2\u767c\u9001\uff01\")\n</code></pre> <p>\u63a5\u6536\u7aef\u4e5f\u9700\u8981\u7528\u540c\u6a23\u7684\u65b9\u5f0f\u89e3\u5305\uff1a</p> <pre><code>from kombu import Connection, Consumer, Exchange, Queue\n\nconn = Connection('amqp://localhost')\nexchange = Exchange('my_exchange', type='direct')\nqueue = Queue('my_queue', exchange, routing_key='greeting')\n\ndef process_message(body, message):\n    print(f\"\u6536\u5230\u6d88\u606f\uff1a{body}\")\n    message.ack()  # \u78ba\u8a8d\u6536\u5230\n\n# \u5275\u5efa\u6d88\u8cbb\u8005\uff0c\u6307\u5b9a\u63a5\u53d7 JSON \u683c\u5f0f\nwith Consumer(conn, queues=queue, callbacks=[process_message], accept=['json']):\n    conn.drain_events()  # \u958b\u59cb\u63a5\u6536\n</code></pre>"},{"location":"kombu/message-serialization/#_4","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u4e00\u81f4\u6027\uff1a\u767c\u9001\u548c\u63a5\u6536\u8981\u7528\u540c\u6a23\u7684\u6253\u5305\u65b9\u5f0f\uff0c\u4e0d\u7136\u5c0d\u65b9\u770b\u4e0d\u61c2\u3002</li> <li>\u5b89\u5168\u6027\uff1a\u4e0d\u8981\u96a8\u4fbf\u7528 Pickle \u63a5\u6536\u964c\u751f\u6d88\u606f\uff0c\u53ef\u80fd\u6703\u6709\u5371\u96aa\u4ee3\u78bc\u3002</li> <li>\u5927\u5c0f\u8207\u901f\u5ea6\uff1a\u5982\u679c\u6d88\u606f\u5f88\u591a\u6216\u5f88\u5927\uff0c\u8003\u616e\u7528 MessagePack \u7bc0\u7701\u7a7a\u9593\u548c\u6642\u9593\u3002</li> </ul> <p>\u901a\u904e\u9019\u500b\u7ae0\u7bc0\uff0c\u60a8\u61c9\u8a72\u5df2\u7d93\u660e\u767d\u4e86\u6d88\u606f\u6253\u5305\u7684\u57fa\u672c\u6982\u5ff5\u3002\u63a5\u4e0b\u4f86\u6211\u5011\u6703\u63a2\u7d22\u66f4\u591a Kombu \u7684\u529f\u80fd\uff01</p>"},{"location":"kombu/transport-abstraction/","title":"\u50b3\u8f38\u5c64\u62bd\u8c61\uff1a\u5982\u4f55\u9069\u914d\u4e0d\u540c\u5de5\u5177\uff1f","text":""},{"location":"kombu/transport-abstraction/#_2","title":"\u4ec0\u9ebc\u662f\u50b3\u8f38\u5c64\u62bd\u8c61\uff1f","text":"<p>Kombu \u7684\u4e00\u5927\u7279\u9ede\u662f\u300c\u50b3\u8f38\u5c64\u62bd\u8c61\u300d\u3002\u9019\u610f\u5473\u8457\u60a8\u53ef\u4ee5\u7528\u7d71\u4e00\u7684\u65b9\u5f0f\u767c\u9001\u6d88\u606f\uff0c\u800c\u4e0d\u7528\u7ba1\u5e95\u4e0b\u7528\u7684\u662f\u4ec0\u9ebc\u5de5\u5177\uff08\u6bd4\u5982 RabbitMQ \u6216 Redis\uff09\u3002\u5c31\u50cf\u60a8\u53ef\u4ee5\u7528\u540c\u4e00\u500b\u624b\u6a5f App \u53eb\u4e0d\u540c\u54c1\u724c\u7684\u8a08\u7a0b\u8eca\uff0cKombu \u5e6b\u60a8\u8655\u7406\u8207\u4e0d\u540c\u300c\u6d88\u606f\u4ee3\u7406\u300d\u7684\u6e9d\u901a\u7d30\u7bc0\u3002</p> <p>\u7c21\u55ae\u4f86\u8aaa\uff0cKombu \u63d0\u4f9b\u4e86\u4e00\u500b\u300c\u901a\u7528\u63a5\u53e3\u300d\uff0c\u8b93\u60a8\u5c08\u6ce8\u65bc\u6d88\u606f\u672c\u8eab\uff0c\u800c\u4e0d\u7528\u64d4\u5fc3\u5de5\u5177\u7684\u5dee\u7570\u3002</p>"},{"location":"kombu/transport-abstraction/#kombu","title":"Kombu \u652f\u6301\u54ea\u4e9b\u5de5\u5177\uff1f","text":"<p>Kombu \u53ef\u4ee5\u8207\u5f88\u591a\u4e0d\u540c\u7684\u300c\u6d88\u606f\u4ee3\u7406\u300d\u5408\u4f5c\uff0c\u5305\u62ec\uff1a</p> <ul> <li>RabbitMQ\uff1a\u529f\u80fd\u5f37\u5927\uff0c\u652f\u6301\u8907\u96dc\u7684\u5206\u767c\u898f\u5247\uff0c\u9069\u5408\u5927\u591a\u6578\u5834\u666f\u3002</li> <li>Redis\uff1a\u7c21\u55ae\u5feb\u901f\uff0c\u9069\u5408\u8f15\u91cf\u7d1a\u4efb\u52d9\u3002</li> <li>Amazon SQS\uff1a\u96f2\u7aef\u670d\u52d9\uff0c\u9069\u5408\u5728 AWS \u4e0a\u4f7f\u7528\u3002</li> <li>\u5176\u4ed6\uff1a\u9084\u6709 Zookeeper\u3001MongoDB \u7b49\uff0c\u9069\u61c9\u4e0d\u540c\u9700\u6c42\u3002</li> </ul>"},{"location":"kombu/transport-abstraction/#kombu_1","title":"\u5982\u4f55\u544a\u8a34 Kombu \u7528\u54ea\u500b\u5de5\u5177\uff1f","text":"<p>\u60a8\u53ea\u9700\u8981\u5728\u300c\u9023\u63a5\u5b57\u7b26\u4e32\u300d\u4e2d\u6307\u5b9a\u5de5\u5177\uff0cKombu \u5c31\u6703\u81ea\u52d5\u9069\u914d\u3002\u4ee5\u4e0b\u662f\u5e7e\u500b\u4f8b\u5b50\uff1a</p> <pre><code>from kombu import Connection\n\n# \u7528 RabbitMQ\nconn_rabbitmq = Connection('amqp://user:pass@localhost:5672//')\n\n# \u7528 Redis\nconn_redis = Connection('redis://localhost:6379/0')\n\n# \u7528 Amazon SQS\nconn_sqs = Connection('sqs://aws_access_key:aws_secret_key@')\n</code></pre>"},{"location":"kombu/transport-abstraction/#_3","title":"\u70ba\u4ec0\u9ebc\u50b3\u8f38\u5c64\u62bd\u8c61\u6709\u7528\uff1f","text":"<ul> <li>\u9748\u6d3b\u6027\uff1a\u5982\u679c\u60a8\u539f\u672c\u7528 RabbitMQ\uff0c\u5f8c\u4f86\u60f3\u6539\u7528 Redis\uff0c\u53ea\u9700\u6539\u9023\u63a5\u5b57\u7b26\u4e32\uff0c\u4e0d\u7528\u6539\u5176\u4ed6\u4ee3\u78bc\u3002</li> <li>\u7c21\u55ae\u6027\uff1a\u60a8\u4e0d\u7528\u5b78\u7fd2\u6bcf\u7a2e\u5de5\u5177\u7684\u7d30\u7bc0\uff0cKombu \u5e6b\u60a8\u8655\u7406\u3002</li> <li>\u4e00\u81f4\u6027\uff1a\u4e0d\u7ba1\u7528\u54ea\u7a2e\u5de5\u5177\uff0c\u767c\u9001\u548c\u63a5\u6536\u6d88\u606f\u7684\u65b9\u5f0f\u90fd\u4e00\u6a23\u3002</li> </ul>"},{"location":"kombu/transport-abstraction/#_4","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u4e0d\u540c\u5de5\u5177\u7684\u529f\u80fd\u4e0d\u540c\uff1aRabbitMQ \u652f\u6301\u8907\u96dc\u898f\u5247\uff0cRedis \u5247\u6bd4\u8f03\u7c21\u55ae\u3002\u9078\u5de5\u5177\u6642\u8981\u8003\u616e\u60a8\u7684\u9700\u6c42\u3002</li> <li>\u6027\u80fd\u5dee\u7570\uff1a\u6709\u4e9b\u5de5\u5177\u5feb\uff0c\u6709\u4e9b\u6162\uff0c\u6839\u64da\u60a8\u7684\u6d88\u606f\u91cf\u548c\u901f\u5ea6\u8981\u6c42\u9078\u64c7\u3002</li> </ul> <p>\u901a\u904e\u9019\u500b\u6982\u5ff5\uff0c\u60a8\u53ef\u4ee5\u5c08\u6ce8\u65bc\u6d88\u606f\u672c\u8eab\uff0c\u800c\u4e0d\u7528\u64d4\u5fc3\u5e95\u5c64\u5de5\u5177\u7684\u5dee\u7570\u3002\u4e0b\u4e00\u7ae0\u6211\u5011\u6703\u770b\u770b\u5982\u4f55\u81ea\u5df1\u63a5\u6536\u6d88\u606f\uff01</p>"},{"location":"rabbitmq/","title":"RabbitMQ \u6838\u5fc3","text":"<p>\u6b61\u8fce\u4f86\u5230\u300cRabbitMQ \u6838\u5fc3\u300d\u7ae0\u7bc0\uff01RabbitMQ \u662f\u4e00\u500b\u529f\u80fd\u5f37\u5927\u7684\u958b\u6e90\u6d88\u606f\u968a\u5217\u7cfb\u7d71\uff0c\u5ee3\u6cdb\u61c9\u7528\u65bc\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u3002\u672c\u7ae0\u7bc0\u5c07\u7cfb\u7d71\u4ecb\u7d39 RabbitMQ \u7684\u57fa\u672c\u6982\u5ff5\u3001\u5de5\u4f5c\u539f\u7406\u8207\u914d\u7f6e\u65b9\u6cd5\uff0c\u5e6b\u52a9\u60a8\u638c\u63e1\u9019\u4e00\u95dc\u9375\u6280\u8853\uff0c\u70ba\u5f8c\u7e8c\u5b78\u7fd2 Celery \u6253\u4e0b\u5805\u5be6\u57fa\u790e\u3002</p>"},{"location":"rabbitmq/#rabbitmq_1","title":"\u4ec0\u9ebc\u662f RabbitMQ\uff1f","text":"<p>RabbitMQ \u662f\u4e00\u500b\u57fa\u65bc AMQP\uff08\u9032\u968e\u6d88\u606f\u968a\u5217\u5354\u8b70\uff09\u7684\u6d88\u606f\u4e2d\u9593\u4ef6\uff0c\u5145\u7576\u751f\u7522\u8005\u8207\u6d88\u8cbb\u8005\u4e4b\u9593\u7684\u6a4b\u6a11\u3002\u5b83\u5141\u8a31\u61c9\u7528\u7a0b\u5e8f\u901a\u904e\u968a\u5217\u767c\u9001\u548c\u63a5\u6536\u6d88\u606f\uff0c\u5be6\u73fe\u7570\u6b65\u8655\u7406\u8207\u7cfb\u7d71\u89e3\u8026\u3002</p> <ul> <li>\u89d2\u8272\uff1a\u6d88\u606f\u4ee3\u7406\uff08Broker\uff09\uff0c\u8ca0\u8cac\u5b58\u5132\u548c\u5206\u767c\u6d88\u606f\u3002</li> <li>\u6838\u5fc3\u529f\u80fd\uff1a\u652f\u6301\u591a\u7a2e\u6d88\u606f\u8def\u7531\u898f\u5247\u3001\u6301\u4e45\u5316\u6a5f\u5236\u548c\u9ad8\u53ef\u7528\u6027\u914d\u7f6e\u3002</li> <li>\u61c9\u7528\u5834\u666f\uff1a\u7570\u6b65\u4efb\u52d9\u8655\u7406\u3001\u8ca0\u8f09\u5747\u8861\u3001\u4e8b\u4ef6\u9a45\u52d5\u67b6\u69cb\u3002</li> </ul>"},{"location":"rabbitmq/#_1","title":"\u672c\u7ae0\u7bc0\u5167\u5bb9\u6982\u8ff0","text":"<p>\u5728\u672c\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u4ee5\u4e0b\u6838\u5fc3\u4e3b\u984c\uff1a</p> <ul> <li>AMQP \u5354\u8b70\u7406\u89e3\uff1a\u5b78\u7fd2 RabbitMQ \u5e95\u5c64\u901a\u4fe1\u5354\u8b70\u7684\u57fa\u672c\u6982\u5ff5\u3002</li> <li>RabbitMQ \u5b89\u88dd\u8207\u914d\u7f6e\uff1a\u6307\u5c0e\u5982\u4f55\u5728\u672c\u5730\u74b0\u5883\u4e2d\u5b89\u88dd\u548c\u8a2d\u7f6e RabbitMQ\u3002</li> <li>\u4ea4\u63db\u6a5f\uff08Exchange\uff09\u985e\u578b\u8207\u7528\u9014\uff1a\u6df1\u5165\u63a2\u8a0e\u4e0d\u540c\u985e\u578b\u7684\u4ea4\u63db\u6a5f\u53ca\u5176\u61c9\u7528\u5834\u666f\u3002</li> <li>\u968a\u5217\uff08Queue\uff09\u7ba1\u7406\uff1a\u4e86\u89e3\u968a\u5217\u7684\u5c6c\u6027\u8207\u914d\u7f6e\u65b9\u6cd5\u3002</li> <li>\u6d88\u606f\u6301\u4e45\u5316\uff1a\u5b78\u7fd2\u5982\u4f55\u78ba\u4fdd\u6d88\u606f\u5728\u6545\u969c\u6642\u4e0d\u4e1f\u5931\u3002</li> <li>RabbitMQ \u76e3\u63a7\u8207\u7ba1\u7406\u5de5\u5177\uff1a\u4ecb\u7d39\u5982\u4f55\u76e3\u63a7\u7cfb\u7d71\u72c0\u614b\u8207\u7ba1\u7406\u8cc7\u6e90\u3002</li> </ul>"},{"location":"rabbitmq/#_2","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5b8c\u6210\u672c\u7ae0\u7bc0\u5f8c\uff0c\u60a8\u5c07\u80fd\u5920\uff1a - \u7406\u89e3 RabbitMQ \u5728\u5206\u6563\u5f0f\u7cfb\u7d71\u4e2d\u7684\u4f5c\u7528\u8207\u5de5\u4f5c\u539f\u7406\u3002 - \u6210\u529f\u5b89\u88dd\u4e26\u914d\u7f6e RabbitMQ \u74b0\u5883\u3002 - \u638c\u63e1\u4ea4\u63db\u6a5f\u8207\u968a\u5217\u7684\u642d\u914d\u4f7f\u7528\uff0c\u8a2d\u8a08\u9748\u6d3b\u7684\u6d88\u606f\u8def\u7531\u65b9\u6848\u3002 - \u78ba\u4fdd\u6d88\u606f\u50b3\u8f38\u7684\u53ef\u9760\u6027\u8207\u7cfb\u7d71\u7a69\u5b9a\u6027\u3002</p> <p>\u8b93\u6211\u5011\u5f9e\u300cAMQP \u5354\u8b70\u7406\u89e3\u300d\u958b\u59cb\uff0c\u9010\u6b65\u63a2\u7d22 RabbitMQ \u7684\u6838\u5fc3\u529f\u80fd\uff01</p> <p>\u63d0\u793a\uff1a\u672c\u7ae0\u7bc0\u9069\u5408\u521d\u5b78\u8005\u95b1\u8b80\uff0c\u7121\u9700\u4e8b\u5148\u5177\u5099 RabbitMQ \u77e5\u8b58\u3002\u82e5\u60a8\u5df2\u6709\u76f8\u95dc\u7d93\u9a57\uff0c\u53ef\u5feb\u901f\u700f\u89bd\u4ee5\u978f\u56fa\u57fa\u790e\u3002</p>"},{"location":"rabbitmq/amqp-protocol/","title":"AMQP \u5354\u8b70\u7406\u89e3","text":"<p>AMQP\uff08\u9032\u968e\u6d88\u606f\u968a\u5217\u5354\u8b70\uff0cAdvanced Message Queuing Protocol\uff09\u662f RabbitMQ \u7684\u6838\u5fc3\u901a\u4fe1\u5354\u8b70\u3002\u672c\u6587\u5c07\u4ecb\u7d39 AMQP \u7684\u57fa\u672c\u6982\u5ff5\u8207\u7d44\u6210\uff0c\u5e6b\u52a9\u60a8\u7406\u89e3 RabbitMQ \u5982\u4f55\u8655\u7406\u6d88\u606f\u3002</p>"},{"location":"rabbitmq/amqp-protocol/#amqp_1","title":"\u4ec0\u9ebc\u662f AMQP\uff1f","text":"<p>AMQP \u662f\u4e00\u500b\u958b\u653e\u6a19\u6e96\u5354\u8b70\uff0c\u7528\u65bc\u5728\u5206\u6563\u5f0f\u7cfb\u7d71\u4e2d\u50b3\u905e\u6d88\u606f\u3002\u5b83\u5b9a\u7fa9\u4e86\u6d88\u606f\u5982\u4f55\u7d50\u69cb\u5316\u3001\u50b3\u8f38\u548c\u8def\u7531\uff0c\u78ba\u4fdd\u4e0d\u540c\u7cfb\u7d71\u9593\u7684\u4e92\u64cd\u4f5c\u6027\u3002RabbitMQ \u662f AMQP \u5354\u8b70\u7684\u5be6\u73fe\u4e4b\u4e00\u3002</p> <ul> <li>\u7248\u672c\uff1aAMQP 0-9-1 \u662f RabbitMQ \u4e3b\u8981\u652f\u63f4\u7684\u7248\u672c\u3002</li> <li>\u76ee\u6a19\uff1a\u5be6\u73fe\u53ef\u9760\u3001\u9ad8\u6548\u7684\u6d88\u606f\u50b3\u8f38\uff0c\u652f\u63f4\u7570\u6b65\u901a\u4fe1\u3002</li> </ul>"},{"location":"rabbitmq/amqp-protocol/#amqp_2","title":"AMQP \u7684\u6838\u5fc3\u6982\u5ff5","text":"<ul> <li>\u6d88\u606f\uff08Message\uff09\uff1a\u50b3\u8f38\u7684\u6578\u64da\u55ae\u4f4d\uff0c\u5305\u542b\u5167\u5bb9\uff08Payload\uff09\u548c\u5143\u6578\u64da\uff08\u5982\u6a19\u982d\u3001\u5c6c\u6027\uff09\u3002</li> <li>\u751f\u7522\u8005\uff08Producer\uff09\uff1a\u767c\u9001\u6d88\u606f\u7684\u61c9\u7528\u6216\u9032\u7a0b\u3002</li> <li>\u6d88\u8cbb\u8005\uff08Consumer\uff09\uff1a\u63a5\u6536\u4e26\u8655\u7406\u6d88\u606f\u7684\u61c9\u7528\u6216\u9032\u7a0b\u3002</li> <li>\u4ea4\u63db\u6a5f\uff08Exchange\uff09\uff1a\u63a5\u6536\u6d88\u606f\u4e26\u6839\u64da\u898f\u5247\u5206\u767c\u5230\u968a\u5217\u3002</li> <li>\u968a\u5217\uff08Queue\uff09\uff1a\u5b58\u5132\u6d88\u606f\u7684\u7de9\u885d\u5340\uff0c\u7b49\u5f85\u6d88\u8cbb\u8005\u8655\u7406\u3002</li> <li>\u7d81\u5b9a\uff08Binding\uff09\uff1a\u4ea4\u63db\u6a5f\u8207\u968a\u5217\u4e4b\u9593\u7684\u95dc\u806f\u898f\u5247\uff0c\u6c7a\u5b9a\u6d88\u606f\u5982\u4f55\u8def\u7531\u3002</li> </ul>"},{"location":"rabbitmq/amqp-protocol/#amqp_3","title":"AMQP \u901a\u4fe1\u6d41\u7a0b","text":"<ol> <li>\u751f\u7522\u8005\u5c07\u6d88\u606f\u767c\u9001\u5230\u4ea4\u63db\u6a5f\uff0c\u6d88\u606f\u5305\u542b\u8def\u7531\u9375\uff08Routing Key\uff09\u3002</li> <li>\u4ea4\u63db\u6a5f\u6839\u64da\u7d81\u5b9a\u898f\u5247\uff0c\u5c07\u6d88\u606f\u5206\u767c\u5230\u4e00\u500b\u6216\u591a\u500b\u968a\u5217\u3002</li> <li>\u968a\u5217\u5b58\u5132\u6d88\u606f\uff0c\u76f4\u5230\u6d88\u8cbb\u8005\u8a02\u95b1\u4e26\u53d6\u51fa\u3002</li> <li>\u6d88\u8cbb\u8005\u8655\u7406\u6d88\u606f\u5f8c\uff0c\u53ef\u9078\u64c7\u78ba\u8a8d\uff08Ack\uff09\u6216\u62d2\u7d55\uff08Nack\uff09\uff0c\u4ee5\u4fbf\u968a\u5217\u6c7a\u5b9a\u662f\u5426\u79fb\u9664\u6d88\u606f\u3002</li> </ol>"},{"location":"rabbitmq/amqp-protocol/#amqp_4","title":"AMQP \u7684\u512a\u52e2","text":"<ul> <li>\u6a19\u6e96\u5316\uff1a\u4e0d\u540c\u6d88\u606f\u7cfb\u7d71\u9593\u53ef\u4e92\u64cd\u4f5c\uff0c\u964d\u4f4e\u6280\u8853\u9396\u5b9a\u98a8\u96aa\u3002</li> <li>\u9748\u6d3b\u6027\uff1a\u652f\u63f4\u591a\u7a2e\u6d88\u606f\u6a21\u5f0f\uff08\u5982\u9ede\u5c0d\u9ede\u3001\u767c\u5e03/\u8a02\u95b1\uff09\u3002</li> <li>\u53ef\u9760\u6027\uff1a\u63d0\u4f9b\u6d88\u606f\u78ba\u8a8d\u8207\u6301\u4e45\u5316\u6a5f\u5236\uff0c\u78ba\u4fdd\u6578\u64da\u4e0d\u4e1f\u5931\u3002</li> </ul>"},{"location":"rabbitmq/amqp-protocol/#amqp-rabbitmq","title":"AMQP \u5728 RabbitMQ \u4e2d\u7684\u61c9\u7528","text":"<p>\u5728 RabbitMQ \u4e2d\uff0cAMQP \u5354\u8b70\u5b9a\u7fa9\u4e86\u6d88\u606f\u5982\u4f55\u5f9e\u751f\u7522\u8005\u6d41\u5411\u6d88\u8cbb\u8005\u3002\u5f8c\u7e8c\u7ae0\u7bc0\u5c07\u6df1\u5165\u63a2\u8a0e\u300c\u4ea4\u63db\u6a5f\u8207\u968a\u5217\u300d\u5982\u4f55\u5be6\u73fe AMQP \u7684\u8def\u7531\u908f\u8f2f\u3002</p>"},{"location":"rabbitmq/amqp-protocol/#_1","title":"\u5c0f\u7d50","text":"<p>AMQP \u662f RabbitMQ \u904b\u4f5c\u7684\u57fa\u790e\u5354\u8b70\uff0c\u7406\u89e3\u5176\u6838\u5fc3\u6982\u5ff5\u6709\u52a9\u65bc\u638c\u63e1\u6d88\u606f\u968a\u5217\u7684\u5de5\u4f5c\u539f\u7406\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cRabbitMQ \u5b89\u88dd\u8207\u914d\u7f6e\u300d\uff0c\u5e6b\u52a9\u60a8\u642d\u5efa\u672c\u5730\u6d88\u606f\u4ee3\u7406\u74b0\u5883\u3002</p> <p>\u63d0\u793a\uff1aAMQP \u662f\u4e00\u500b\u62bd\u8c61\u5354\u8b70\uff0c\u5be6\u969b\u61c9\u7528\u4e2d\u60a8\u901a\u5e38\u901a\u904e\u7a0b\u5f0f\u5eab\uff08\u5982 Python \u7684 <code>pika</code>\uff09\u8207 RabbitMQ \u4ea4\u4e92\uff0c\u7121\u9700\u76f4\u63a5\u8655\u7406\u5354\u8b70\u7d30\u7bc0\u3002</p>"},{"location":"rabbitmq/installation-configuration/","title":"RabbitMQ \u5b89\u88dd\u8207\u914d\u7f6e","text":"<p>RabbitMQ \u662f\u4e00\u500b\u529f\u80fd\u5f37\u5927\u7684\u958b\u6e90\u6d88\u606f\u968a\u5217\u7cfb\u7d71\uff0c\u672c\u6587\u5c07\u6307\u5c0e\u60a8\u5982\u4f55\u5728\u672c\u5730\u74b0\u5883\u4e2d\u5b89\u88dd\u548c\u914d\u7f6e RabbitMQ\uff0c\u70ba\u5f8c\u7e8c\u5b78\u7fd2\u8207\u5be6\u8e10\u505a\u597d\u6e96\u5099\u3002</p>"},{"location":"rabbitmq/installation-configuration/#rabbitmq_1","title":"RabbitMQ \u5b89\u88dd\u6b65\u9a5f","text":"<p>\u4ee5\u4e0b\u662f\u4ee5 Ubuntu \u7cfb\u7d71\u70ba\u4f8b\u7684\u5b89\u88dd\u6307\u5357\uff0c\u5176\u4ed6\u7cfb\u7d71\uff08\u5982 Windows \u6216 macOS\uff09\u53ef\u53c3\u8003\u5b98\u65b9\u6587\u4ef6\uff08RabbitMQ \u5b89\u88dd\u6307\u5357\uff09\u3002</p>"},{"location":"rabbitmq/installation-configuration/#1","title":"\u6b65\u9a5f 1\uff1a\u66f4\u65b0\u7cfb\u7d71\u5305","text":"<pre><code>sudo apt update\nsudo apt upgrade\n</code></pre>"},{"location":"rabbitmq/installation-configuration/#2-rabbitmq","title":"\u6b65\u9a5f 2\uff1a\u5b89\u88dd RabbitMQ \u4f3a\u670d\u5668","text":"<pre><code>sudo apt install rabbitmq-server\n</code></pre>"},{"location":"rabbitmq/installation-configuration/#3-rabbitmq","title":"\u6b65\u9a5f 3\uff1a\u555f\u52d5 RabbitMQ \u670d\u52d9","text":"<pre><code>sudo systemctl start rabbitmq-server\nsudo systemctl enable rabbitmq-server\n</code></pre>"},{"location":"rabbitmq/installation-configuration/#4","title":"\u6b65\u9a5f 4\uff1a\u6aa2\u67e5\u670d\u52d9\u72c0\u614b","text":"<p><pre><code>sudo systemctl status rabbitmq-server\n</code></pre> \u5982\u679c\u670d\u52d9\u6b63\u5e38\u904b\u884c\uff0c\u6703\u986f\u793a <code>active (running)</code>\u3002</p>"},{"location":"rabbitmq/installation-configuration/#5","title":"\u6b65\u9a5f 5\uff1a\u555f\u7528\u7ba1\u7406\u63d2\u4ef6\uff08\u53ef\u9078\uff09","text":"<p>RabbitMQ \u63d0\u4f9b\u4e00\u500b Web \u7ba1\u7406\u754c\u9762\uff0c\u65b9\u4fbf\u67e5\u770b\u968a\u5217\u8207\u6d88\u606f\u72c0\u614b\u3002 <pre><code>sudo rabbitmq-plugins enable rabbitmq_management\n</code></pre> \u555f\u7528\u5f8c\uff0c\u901a\u904e\u700f\u89bd\u5668\u8a2a\u554f <code>http://localhost:15672</code>\uff0c\u9810\u8a2d\u7528\u6236\u540d\u8207\u5bc6\u78bc\u70ba <code>guest</code>/<code>guest</code>\u3002</p>"},{"location":"rabbitmq/installation-configuration/#_1","title":"\u57fa\u672c\u74b0\u5883\u6e2c\u8a66","text":"<p>\u5b89\u88dd\u5b8c\u6210\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6e2c\u8a66 RabbitMQ \u662f\u5426\u6b63\u5e38\u904b\u884c\uff1a <pre><code>rabbitmqctl status\n</code></pre> \u8f38\u51fa\u4e2d\u61c9\u5305\u542b\u7bc0\u9ede\u8cc7\u8a0a\u8207\u904b\u884c\u72c0\u614b\u3002</p>"},{"location":"rabbitmq/installation-configuration/#rabbitmq_2","title":"RabbitMQ \u57fa\u672c\u914d\u7f6e","text":"<p>RabbitMQ \u7684\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u4f4d\u65bc <code>/etc/rabbitmq/rabbitmq.conf</code>\uff08\u5177\u9ad4\u8def\u5f91\u4f9d\u7cfb\u7d71\u800c\u7570\uff09\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u898b\u914d\u7f6e\u9805\uff1a</p> <ul> <li>\u76e3\u807d\u7aef\u53e3\uff1a\u9810\u8a2d\u70ba 5672\uff08AMQP \u5354\u8b70\uff09\u548c 15672\uff08\u7ba1\u7406\u754c\u9762\uff09\u3002   <pre><code>listeners.tcp.default = 5672\n</code></pre></li> <li>\u7528\u6236\u8207\u6b0a\u9650\uff1a\u9810\u8a2d\u7528\u6236\u70ba <code>guest</code>\uff0c\u5efa\u8b70\u5275\u5efa\u65b0\u7528\u6236\u4e26\u8a2d\u7f6e\u6b0a\u9650\u3002   <pre><code># \u5275\u5efa\u65b0\u7528\u6236\nsudo rabbitmqctl add_user myuser mypassword\n# \u8a2d\u7f6e\u7ba1\u7406\u54e1\u6b0a\u9650\nsudo rabbitmqctl set_user_tags myuser administrator\n# \u8a2d\u7f6e\u865b\u64ec\u4e3b\u6a5f\u6b0a\u9650\nsudo rabbitmqctl set_permissions -p / myuser \".*\" \".*\" \".*\"\n</code></pre></li> <li>\u865b\u64ec\u4e3b\u6a5f\uff08Virtual Host\uff09\uff1a\u7528\u65bc\u9694\u96e2\u4e0d\u540c\u61c9\u7528\u74b0\u5883\uff0c\u9810\u8a2d\u70ba <code>/</code>\u3002   <pre><code>sudo rabbitmqctl add_vhost myvhost\n</code></pre></li> </ul>"},{"location":"rabbitmq/installation-configuration/#_2","title":"\u5c0f\u7d50","text":"<p>\u901a\u904e\u5b89\u88dd\u8207\u57fa\u672c\u914d\u7f6e\uff0c\u60a8\u5df2\u7d93\u642d\u5efa\u4e86\u4e00\u500b\u672c\u5730 RabbitMQ \u74b0\u5883\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u4ea4\u63db\u6a5f\uff08Exchange\uff09\u985e\u578b\u8207\u7528\u9014\u300d\uff0c\u63a2\u7d22 RabbitMQ \u4e2d\u6d88\u606f\u5206\u767c\u7684\u6838\u5fc3\u6a5f\u5236\u3002</p> <p>\u63d0\u793a\uff1a\u8a18\u9304\u5b89\u88dd\u904e\u7a0b\u4e2d\u7684\u4efb\u4f55\u554f\u984c\uff08\u5982\u7aef\u53e3\u885d\u7a81\uff09\uff0c\u53ef\u53c3\u8003\u5b98\u65b9\u6587\u4ef6\u6216\u793e\u7fa4\u8cc7\u6e90\u89e3\u6c7a\u3002</p>"},{"location":"rabbitmq/message-persistence/","title":"\u6d88\u606f\u6301\u4e45\u5316","text":"<p>\u5728\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u4e2d\uff0c\u78ba\u4fdd\u6d88\u606f\u5728\u4f3a\u670d\u5668\u6545\u969c\u6216\u91cd\u555f\u6642\u4e0d\u4e1f\u5931\u81f3\u95dc\u91cd\u8981\u3002RabbitMQ \u63d0\u4f9b\u4e86\u6d88\u606f\u6301\u4e45\u5316\u6a5f\u5236\u4f86\u4fdd\u8b49\u53ef\u9760\u6027\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u6301\u4e45\u5316\u7684\u539f\u7406\u8207\u914d\u7f6e\u65b9\u6cd5\u3002</p>"},{"location":"rabbitmq/message-persistence/#_2","title":"\u4ec0\u9ebc\u662f\u6d88\u606f\u6301\u4e45\u5316\uff1f","text":"<p>\u6d88\u606f\u6301\u4e45\u5316\u662f\u6307\u78ba\u4fdd\u6d88\u606f\u548c\u968a\u5217\u7d50\u69cb\u5728\u4f3a\u670d\u5668\u91cd\u555f\u6216\u6545\u969c\u6642\u5f97\u4ee5\u4fdd\u7559\u7684\u529f\u80fd\u3002RabbitMQ \u901a\u904e\u4ee5\u4e0b\u5169\u65b9\u9762\u5be6\u73fe\u6301\u4e45\u5316\uff1a</p>"},{"location":"rabbitmq/message-persistence/#1","title":"1. \u968a\u5217\u6301\u4e45\u5316","text":"<ul> <li>\u8a2d\u5b9a\uff1a\u5ba3\u544a\u968a\u5217\u6642\u8a2d\u7f6e <code>durable=True</code>\uff0c\u78ba\u4fdd\u968a\u5217\u7d50\u69cb\u5728\u91cd\u555f\u5f8c\u4fdd\u7559\u3002</li> <li>\u6ce8\u610f\uff1a\u50c5\u6301\u4e45\u5316\u968a\u5217\u7d50\u69cb\uff0c\u4e0d\u5305\u62ec\u5176\u4e2d\u7684\u6d88\u606f\uff0c\u9700\u8207\u6d88\u606f\u6301\u4e45\u5316\u7d50\u5408\u4f7f\u7528\u3002</li> </ul>"},{"location":"rabbitmq/message-persistence/#2","title":"2. \u6d88\u606f\u6301\u4e45\u5316","text":"<ul> <li>\u8a2d\u5b9a\uff1a\u767c\u9001\u6d88\u606f\u6642\u8a2d\u7f6e <code>delivery_mode=2</code>\uff08\u6216\u5728 <code>pika</code> \u4e2d\u4f7f\u7528 <code>persistent=True</code>\uff09\uff0c\u5c07\u6d88\u606f\u6a19\u8a18\u70ba\u6301\u4e45\u5316\u3002</li> <li>\u539f\u7406\uff1a\u6d88\u606f\u6703\u88ab\u5beb\u5165\u78c1\u76e4\uff0c\u800c\u975e\u50c5\u5b58\u65bc\u8a18\u61b6\u9ad4\uff0c\u53ea\u6709\u5728\u78c1\u76e4\u5beb\u5165\u5b8c\u6210\u5f8c\u624d\u7b97\u6210\u529f\u767c\u9001\u3002</li> </ul>"},{"location":"rabbitmq/message-persistence/#python-pika","title":"\u914d\u7f6e\u793a\u4f8b\uff08Python <code>pika</code>\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Python <code>pika</code> \u7a0b\u5f0f\u5eab\u914d\u7f6e\u6301\u4e45\u5316\u968a\u5217\u8207\u6d88\u606f\u7684\u7c21\u55ae\u793a\u4f8b\uff1a <pre><code>import pika\n\n# \u5efa\u7acb\u9023\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\n# \u5ba3\u544a\u6301\u4e45\u5316\u968a\u5217\nchannel.queue_declare(queue='durable_queue', durable=True)\n\n# \u767c\u9001\u6301\u4e45\u5316\u6d88\u606f\nchannel.basic_publish(\n    exchange='',\n    routing_key='durable_queue',\n    body='Hello, RabbitMQ!',\n    properties=pika.BasicProperties(delivery_mode=2)  # \u6301\u4e45\u5316\n)\n\nprint(\"\u6301\u4e45\u5316\u6d88\u606f\u5df2\u767c\u9001\")\nconnection.close()\n</code></pre></p>"},{"location":"rabbitmq/message-persistence/#_3","title":"\u78ba\u8a8d\u6a5f\u5236\u8207\u6301\u4e45\u5316\u7684\u7d50\u5408","text":"<p>\u6301\u4e45\u5316\u78ba\u4fdd\u6d88\u606f\u4e0d\u56e0\u4f3a\u670d\u5668\u6545\u969c\u800c\u4e1f\u5931\uff0c\u4f46\u7121\u6cd5\u4fdd\u8b49\u6d88\u606f\u662f\u5426\u5230\u9054\u968a\u5217\u3002RabbitMQ \u63d0\u4f9b\u767c\u9001\u65b9\u78ba\u8a8d\uff08Publisher Confirms\uff09\u6a5f\u5236\uff0c\u78ba\u4fdd\u6d88\u606f\u6210\u529f\u5b58\u5132\uff1a - \u8a2d\u5b9a\uff1a\u555f\u7528 <code>confirm_delivery</code> \u6a21\u5f0f\uff0cRabbitMQ \u6703\u56de\u50b3\u78ba\u8a8d\u8a0a\u606f\u3002 - \u793a\u4f8b\uff1a   <pre><code>channel.confirm_delivery()\nif channel.basic_publish(exchange='', routing_key='durable_queue', body='Test'):\n    print(\"\u6d88\u606f\u78ba\u8a8d\u6210\u529f\")\nelse:\n    print(\"\u6d88\u606f\u767c\u9001\u5931\u6557\")\n</code></pre></p>"},{"location":"rabbitmq/message-persistence/#_4","title":"\u6301\u4e45\u5316\u7684\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>\u6027\u80fd\u5f71\u97ff\uff1a\u6301\u4e45\u5316\u6d88\u606f\u9700\u8981\u5beb\u5165\u78c1\u76e4\uff0c\u6703\u964d\u4f4e\u541e\u5410\u91cf\uff0c\u9069\u5408\u53ef\u9760\u6027\u8981\u6c42\u9ad8\u7684\u5834\u666f\u3002</li> <li>\u968a\u5217\u8207\u6d88\u606f\u4e00\u81f4\u6027\uff1a\u968a\u5217\u8207\u6d88\u606f\u5747\u9700\u8a2d\u7f6e\u6301\u4e45\u5316\uff0c\u5426\u5247\u91cd\u555f\u5f8c\u53ef\u80fd\u5c0e\u81f4\u6578\u64da\u4e0d\u4e00\u81f4\u3002</li> <li>\u78c1\u76e4\u7a7a\u9593\uff1a\u6301\u4e45\u5316\u6d88\u606f\u53ef\u80fd\u4f54\u7528\u5927\u91cf\u78c1\u76e4\u7a7a\u9593\uff0c\u9700\u5b9a\u671f\u6e05\u7406\u6216\u8a2d\u7f6e TTL\u3002</li> </ul>"},{"location":"rabbitmq/message-persistence/#_5","title":"\u5c0f\u7d50","text":"<p>\u6d88\u606f\u6301\u4e45\u5316\u662f RabbitMQ \u78ba\u4fdd\u53ef\u9760\u6027\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u901a\u904e\u914d\u7f6e\u6301\u4e45\u5316\u968a\u5217\u8207\u6d88\u606f\uff0c\u60a8\u53ef\u4ee5\u907f\u514d\u56e0\u6545\u969c\u5c0e\u81f4\u7684\u6578\u64da\u4e1f\u5931\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cRabbitMQ \u76e3\u63a7\u8207\u7ba1\u7406\u5de5\u5177\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u512a\u5316\u8207\u7dad\u8b77 RabbitMQ \u7cfb\u7d71\u3002</p> <p>\u63d0\u793a\uff1a\u5728\u9ad8\u53ef\u9760\u6027\u9700\u6c42\u7684\u5834\u666f\u4e2d\uff0c\u5efa\u8b70\u7d50\u5408\u6301\u4e45\u5316\u8207\u78ba\u8a8d\u6a5f\u5236\u4f7f\u7528\u3002</p>"},{"location":"rabbitmq/monitoring-management/","title":"RabbitMQ \u76e3\u63a7\u8207\u7ba1\u7406\u5de5\u5177","text":"<p>RabbitMQ \u7684\u6548\u80fd\u8207\u53ef\u9760\u6027\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u6c7a\u65bc\u6709\u6548\u7684\u76e3\u63a7\u8207\u7ba1\u7406\u3002\u672c\u6587\u5c07\u4ecb\u7d39 RabbitMQ \u63d0\u4f9b\u7684\u76e3\u63a7\u548c\u7ba1\u7406\u5de5\u5177\uff0c\u4ee5\u53ca\u5e38\u898b\u7684\u6700\u4f73\u5be6\u8e10\uff0c\u5e6b\u52a9\u60a8\u69cb\u5efa\u7a69\u5b9a\u7684\u6d88\u606f\u7cfb\u7d71\u3002</p>"},{"location":"rabbitmq/monitoring-management/#rabbitmq_1","title":"RabbitMQ \u7ba1\u7406\u754c\u9762","text":"<p>RabbitMQ \u63d0\u4f9b\u4e86\u4e00\u500b\u5167\u5efa\u7684 Web \u7ba1\u7406\u754c\u9762\uff0c\u65b9\u4fbf\u67e5\u770b\u7cfb\u7d71\u72c0\u614b\u8207\u914d\u7f6e\u8cc7\u6e90\u3002</p> <ul> <li>\u555f\u7528\u65b9\u5f0f\uff1a\u5b89\u88dd\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u555f\u7528\u7ba1\u7406\u63d2\u4ef6\uff1a   <pre><code>sudo rabbitmq-plugins enable rabbitmq_management\n</code></pre></li> <li>\u8a2a\u554f\u65b9\u5f0f\uff1a\u901a\u904e\u700f\u89bd\u5668\u8a2a\u554f <code>http://localhost:15672</code>\uff0c\u9810\u8a2d\u7528\u6236\u540d\u8207\u5bc6\u78bc\u70ba <code>guest</code>/<code>guest</code>\u3002</li> <li>\u529f\u80fd\uff1a</li> <li>\u67e5\u770b\u968a\u5217\u3001\u4ea4\u63db\u6a5f\u8207\u7d81\u5b9a\u95dc\u4fc2\u3002</li> <li>\u76e3\u63a7\u6d88\u606f\u901f\u7387\u8207\u968a\u5217\u9577\u5ea6\u3002</li> <li>\u624b\u52d5\u5275\u5efa\u6216\u522a\u9664\u8cc7\u6e90\u3002</li> <li>\u7ba1\u7406\u7528\u6236\u8207\u6b0a\u9650\u3002</li> </ul>"},{"location":"rabbitmq/monitoring-management/#rabbitmq-rabbitmqctl","title":"RabbitMQ \u547d\u4ee4\u884c\u5de5\u5177\uff08rabbitmqctl\uff09","text":"<p><code>rabbitmqctl</code> \u662f RabbitMQ \u63d0\u4f9b\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u65bc\u7ba1\u7406\u4f3a\u670d\u5668\u8207\u8cc7\u6e90\u3002</p> <ul> <li>\u67e5\u770b\u7cfb\u7d71\u72c0\u614b\uff1a   <pre><code>sudo rabbitmqctl status\n</code></pre></li> <li>\u5217\u51fa\u968a\u5217\uff1a   <pre><code>sudo rabbitmqctl list_queues\n</code></pre></li> <li>\u5217\u51fa\u4ea4\u63db\u6a5f\uff1a   <pre><code>sudo rabbitmqctl list_exchanges\n</code></pre></li> <li>\u7ba1\u7406\u7528\u6236\uff1a   <pre><code>sudo rabbitmqctl add_user myuser mypassword\nsudo rabbitmqctl set_user_tags myuser administrator\n</code></pre></li> <li>\u7ba1\u7406\u865b\u64ec\u4e3b\u6a5f\uff1a   <pre><code>sudo rabbitmqctl add_vhost myvhost\nsudo rabbitmqctl set_permissions -p myvhost myuser \".*\" \".*\" \".*\"\n</code></pre></li> </ul>"},{"location":"rabbitmq/monitoring-management/#_1","title":"\u76e3\u63a7\u6307\u6a19\u8207\u5de5\u5177","text":"<p>\u70ba\u4e86\u78ba\u4fdd RabbitMQ \u7684\u7a69\u5b9a\u904b\u884c\uff0c\u9700\u5b9a\u671f\u76e3\u63a7\u95dc\u9375\u6307\u6a19\uff1a</p> <ul> <li>\u968a\u5217\u9577\u5ea6\uff1a\u904e\u9577\u53ef\u80fd\u8868\u793a\u6d88\u8cbb\u8005\u8655\u7406\u901f\u5ea6\u4e0d\u8db3\u3002</li> <li>\u6d88\u606f\u901f\u7387\uff1a\u767c\u9001\u8207\u6d88\u8cbb\u901f\u7387\u662f\u5426\u5e73\u8861\u3002</li> <li>\u9023\u63a5\u6578\u91cf\uff1a\u904e\u591a\u9023\u63a5\u53ef\u80fd\u5c0e\u81f4\u8cc7\u6e90\u8017\u76e1\u3002</li> <li>\u8a18\u61b6\u9ad4\u8207\u78c1\u76e4\u4f7f\u7528\uff1a\u907f\u514d\u8cc7\u6e90\u904e\u8f09\u5c0e\u81f4\u7cfb\u7d71\u5d29\u6f70\u3002</li> </ul>"},{"location":"rabbitmq/monitoring-management/#_2","title":"\u7b2c\u4e09\u65b9\u76e3\u63a7\u5de5\u5177","text":"<ul> <li>Prometheus + Grafana\uff1a\u901a\u904e RabbitMQ \u7684 Prometheus \u63d2\u4ef6\u6536\u96c6\u6307\u6a19\uff0c\u4e26\u4f7f\u7528 Grafana \u53ef\u8996\u5316\u3002</li> <li>\u555f\u7528\u63d2\u4ef6\uff1a     <pre><code>sudo rabbitmq-plugins enable rabbitmq_prometheus\n</code></pre></li> <li>\u8a2a\u554f\u6307\u6a19\uff1a<code>http://localhost:15692/metrics</code></li> <li>Datadog/Zabbix\uff1a\u652f\u63f4 RabbitMQ \u76e3\u63a7\u7684\u5546\u696d\u89e3\u6c7a\u65b9\u6848\u3002</li> </ul>"},{"location":"rabbitmq/monitoring-management/#_3","title":"\u6700\u4f73\u5be6\u8e10","text":"<ul> <li>\u7528\u6236\u5b89\u5168\uff1a\u7981\u7528\u9810\u8a2d <code>guest</code> \u7528\u6236\uff0c\u5275\u5efa\u65b0\u7528\u6236\u4e26\u8a2d\u7f6e\u8907\u96dc\u5bc6\u78bc\u3002   <pre><code>sudo rabbitmqctl delete_user guest\n</code></pre></li> <li>\u8cc7\u6e90\u9650\u5236\uff1a\u70ba\u968a\u5217\u8a2d\u7f6e\u6700\u5927\u9577\u5ea6\u8207 TTL\uff0c\u907f\u514d\u7121\u9650\u589e\u9577\u3002</li> <li>\u9ad8\u53ef\u7528\u6027\uff1a\u914d\u7f6e RabbitMQ \u96c6\u7fa4\uff0c\u5be6\u73fe\u6545\u969c\u8f49\u79fb\uff08\u9032\u968e\u4e3b\u984c\uff0c\u5f8c\u7e8c\u4ecb\u7d39\uff09\u3002</li> <li>\u65e5\u8a8c\u7ba1\u7406\uff1a\u5b9a\u671f\u6aa2\u67e5 RabbitMQ \u65e5\u8a8c\uff08\u901a\u5e38\u4f4d\u65bc <code>/var/log/rabbitmq/</code>\uff09\uff0c\u6392\u67e5\u6f5b\u5728\u554f\u984c\u3002</li> </ul>"},{"location":"rabbitmq/monitoring-management/#_4","title":"\u5c0f\u7d50","text":"<p>RabbitMQ \u63d0\u4f9b\u591a\u7a2e\u76e3\u63a7\u8207\u7ba1\u7406\u5de5\u5177\uff0c\u5e6b\u52a9\u60a8\u638c\u63e1\u7cfb\u7d71\u72c0\u614b\u4e26\u53ca\u6642\u89e3\u6c7a\u554f\u984c\u3002\u901a\u904e\u5408\u7406\u914d\u7f6e\u8207\u76e3\u63a7\uff0c\u60a8\u53ef\u4ee5\u78ba\u4fdd\u6d88\u606f\u7cfb\u7d71\u7684\u7a69\u5b9a\u6027\u8207\u9ad8\u6548\u6027\u3002\u672c\u7ae0\u7bc0\u7d50\u675f\u4e86\u300cRabbitMQ \u6838\u5fc3\u300d\u7684\u5b78\u7fd2\uff0c\u4e0b\u4e00\u968e\u6bb5\u6211\u5011\u5c07\u9032\u5165 Celery \u7684\u76f8\u95dc\u5167\u5bb9\uff0c\u63a2\u7d22\u5982\u4f55\u57fa\u65bc RabbitMQ \u5be6\u73fe\u5206\u6563\u5f0f\u4efb\u52d9\u8655\u7406\u3002</p> <p>\u63d0\u793a\uff1a\u5b9a\u671f\u76e3\u63a7\u968a\u5217\u9577\u5ea6\u8207\u7cfb\u7d71\u8cc7\u6e90\u662f\u907f\u514d RabbitMQ \u554f\u984c\u7684\u95dc\u9375\uff0c\u5efa\u8b70\u7d50\u5408\u81ea\u52d5\u5316\u5de5\u5177\u5be6\u73fe\u5be6\u6642\u544a\u8b66\u3002</p>"},{"location":"rabbitmq/queue-management/","title":"\u968a\u5217\uff08Queue\uff09\u7ba1\u7406","text":"<p>\u968a\u5217\uff08Queue\uff09\u662f RabbitMQ \u4e2d\u5b58\u5132\u6d88\u606f\u7684\u7de9\u885d\u5340\uff0c\u6d88\u8cbb\u8005\u5f9e\u968a\u5217\u4e2d\u53d6\u51fa\u6d88\u606f\u9032\u884c\u8655\u7406\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u968a\u5217\u7684\u57fa\u672c\u5c6c\u6027\u3001\u914d\u7f6e\u65b9\u6cd5\u53ca\u7ba1\u7406\u6280\u5de7\uff0c\u5e6b\u52a9\u60a8\u8a2d\u8a08\u9ad8\u6548\u7684\u6d88\u606f\u8655\u7406\u7cfb\u7d71\u3002</p>"},{"location":"rabbitmq/queue-management/#_1","title":"\u4ec0\u9ebc\u662f\u968a\u5217\uff1f","text":"<p>\u968a\u5217\u662f RabbitMQ \u4e2d\u7528\u65bc\u66ab\u5b58\u6d88\u606f\u7684\u7d44\u4ef6\uff0c\u751f\u7522\u8005\u901a\u904e\u4ea4\u63db\u6a5f\u5c07\u6d88\u606f\u5206\u767c\u5230\u968a\u5217\uff0c\u6d88\u8cbb\u8005\u8a02\u95b1\u968a\u5217\u4ee5\u8655\u7406\u6d88\u606f\u3002\u6bcf\u500b\u968a\u5217\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u5c6c\u6027\u8207\u884c\u70ba\uff0c\u9069\u61c9\u5404\u7a2e\u61c9\u7528\u9700\u6c42\u3002</p>"},{"location":"rabbitmq/queue-management/#_2","title":"\u968a\u5217\u7684\u6838\u5fc3\u5c6c\u6027","text":"<ul> <li>\u8010\u4e45\u6027\uff08Durable\uff09\uff1a\u968a\u5217\u662f\u5426\u5728\u4f3a\u670d\u5668\u91cd\u555f\u5f8c\u4fdd\u7559\u3002\u8a2d\u70ba <code>durable=True</code> \u53ef\u6301\u4e45\u5316\u968a\u5217\u7d50\u69cb\uff08\u4e0d\u5305\u62ec\u6d88\u606f\uff09\u3002</li> <li>\u81ea\u52d5\u522a\u9664\uff08Auto-Delete\uff09\uff1a\u968a\u5217\u5728\u6700\u5f8c\u4e00\u500b\u6d88\u8cbb\u8005\u65b7\u958b\u5f8c\u662f\u5426\u81ea\u52d5\u522a\u9664\uff0c\u9069\u5408\u81e8\u6642\u968a\u5217\u3002</li> <li>\u6392\u4ed6\u6027\uff08Exclusive\uff09\uff1a\u968a\u5217\u662f\u5426\u50c5\u9650\u55ae\u4e00\u9023\u63a5\u4f7f\u7528\uff0c\u9023\u63a5\u65b7\u958b\u5f8c\u81ea\u52d5\u522a\u9664\uff0c\u9069\u5408\u81e8\u6642\u6703\u8a71\u3002</li> <li>\u6700\u5927\u9577\u5ea6\uff08Max Length\uff09\uff1a\u9650\u5236\u968a\u5217\u4e2d\u6d88\u606f\u6578\u91cf\uff0c\u907f\u514d\u5167\u5b58\u904e\u8f09\u3002</li> <li>\u6d88\u606f\u751f\u5b58\u6642\u9593\uff08Message TTL\uff09\uff1a\u8a2d\u7f6e\u6d88\u606f\u5728\u968a\u5217\u4e2d\u7684\u6700\u9577\u5b58\u6d3b\u6642\u9593\uff0c\u904e\u671f\u5f8c\u81ea\u52d5\u79fb\u9664\u3002</li> <li>\u6b7b\u4fe1\u4ea4\u63db\u6a5f\uff08Dead Letter Exchange, DLE\uff09\uff1a\u7576\u6d88\u606f\u88ab\u62d2\u7d55\u6216\u904e\u671f\u6642\uff0c\u8f49\u767c\u5230\u6307\u5b9a\u4ea4\u63db\u6a5f\u9032\u884c\u8655\u7406\u3002</li> </ul>"},{"location":"rabbitmq/queue-management/#python-pika","title":"\u968a\u5217\u914d\u7f6e\u793a\u4f8b\uff08Python <code>pika</code>\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Python <code>pika</code> \u7a0b\u5f0f\u5eab\u914d\u7f6e\u968a\u5217\u7684\u7c21\u55ae\u793a\u4f8b\uff1a <pre><code>import pika\n\n# \u5efa\u7acb\u9023\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\n# \u5ba3\u544a\u6301\u4e45\u5316\u968a\u5217\nchannel.queue_declare(queue='task_queue', durable=True)\n\n# \u5ba3\u544a\u5e36 TTL \u548c\u6700\u5927\u9577\u5ea6\u7684\u968a\u5217\nargs = {'x-message-ttl': 60000, 'x-max-length': 100}  # TTL 60\u79d2\uff0c\u6700\u5927\u9577\u5ea6100\nchannel.queue_declare(queue='limited_queue', arguments=args)\n\nprint(\"\u968a\u5217\u5df2\u5ba3\u544a\")\nconnection.close()\n</code></pre></p>"},{"location":"rabbitmq/queue-management/#_3","title":"\u968a\u5217\u7ba1\u7406\u6280\u5de7","text":"<ul> <li>\u968a\u5217\u547d\u540d\uff1a\u4f7f\u7528\u6709\u610f\u7fa9\u7684\u540d\u7a31\uff08\u5982 <code>email_tasks</code>\u3001<code>error_logs</code>\uff09\uff0c\u4fbf\u65bc\u8b58\u5225\u8207\u8abf\u8a66\u3002</li> <li>\u8cc7\u6e90\u9650\u5236\uff1a\u8a2d\u7f6e\u6700\u5927\u9577\u5ea6\u6216 TTL\uff0c\u907f\u514d\u968a\u5217\u7121\u9650\u589e\u9577\u5c0e\u81f4\u8a18\u61b6\u9ad4\u554f\u984c\u3002</li> <li>\u6b7b\u4fe1\u8655\u7406\uff1a\u914d\u7f6e\u6b7b\u4fe1\u4ea4\u63db\u6a5f\u8207\u968a\u5217\uff0c\u8655\u7406\u5931\u6557\u6216\u904e\u671f\u7684\u6d88\u606f\u3002   <pre><code>args = {'x-dead-letter-exchange': 'dlx_exchange'}\nchannel.queue_declare(queue='main_queue', arguments=args)\n</code></pre></li> <li>\u968a\u5217\u76e3\u63a7\uff1a\u5b9a\u671f\u6aa2\u67e5\u968a\u5217\u9577\u5ea6\u8207\u6d88\u606f\u8655\u7406\u901f\u5ea6\uff0c\u53ca\u6642\u8abf\u6574\u6d88\u8cbb\u8005\u6578\u91cf\u3002</li> </ul>"},{"location":"rabbitmq/queue-management/#rabbitmq-cli","title":"\u968a\u5217\u64cd\u4f5c\u547d\u4ee4\uff08RabbitMQ CLI\uff09","text":"<p>\u4f7f\u7528 <code>rabbitmqctl</code> \u5de5\u5177\u7ba1\u7406\u968a\u5217\uff1a - \u5217\u51fa\u6240\u6709\u968a\u5217\uff1a   <pre><code>sudo rabbitmqctl list_queues\n</code></pre> - \u522a\u9664\u968a\u5217\uff1a   <pre><code>sudo rabbitmqctl delete_queue task_queue\n</code></pre> - \u6e05\u9664\u968a\u5217\u6d88\u606f\uff1a   <pre><code>sudo rabbitmqctl purge_queue task_queue\n</code></pre></p>"},{"location":"rabbitmq/queue-management/#_4","title":"\u5c0f\u7d50","text":"<p>\u968a\u5217\u662f RabbitMQ \u4e2d\u6d88\u606f\u5b58\u5132\u8207\u8655\u7406\u7684\u57fa\u790e\uff0c\u901a\u904e\u5408\u7406\u914d\u7f6e\u968a\u5217\u5c6c\u6027\u8207\u7ba1\u7406\u7b56\u7565\uff0c\u60a8\u53ef\u4ee5\u8a2d\u8a08\u9ad8\u6548\u53ef\u9760\u7684\u6d88\u606f\u7cfb\u7d71\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300c\u6d88\u606f\u6301\u4e45\u5316\u300d\uff0c\u63a2\u7d22\u5982\u4f55\u78ba\u4fdd\u6d88\u606f\u5728\u6545\u969c\u6642\u4e0d\u4e1f\u5931\u3002</p> <p>\u63d0\u793a\uff1a\u968a\u5217\u5c6c\u6027\u914d\u7f6e\u9700\u6839\u64da\u696d\u52d9\u9700\u6c42\u8b39\u614e\u9078\u64c7\uff0c\u907f\u514d\u904e\u5ea6\u9650\u5236\u6216\u8cc7\u6e90\u6d6a\u8cbb\u3002</p>"},{"location":"rabbitmq/exchanges/","title":"\u4ea4\u63db\u6a5f\uff08Exchange\uff09\u985e\u578b\u8207\u7528\u9014","text":"<p>\u4ea4\u63db\u6a5f\uff08Exchange\uff09\u662f RabbitMQ \u4e2d\u8ca0\u8cac\u63a5\u6536\u6d88\u606f\u4e26\u6c7a\u5b9a\u5982\u4f55\u5206\u767c\u5230\u968a\u5217\u7684\u6838\u5fc3\u7d44\u4ef6\u3002\u672c\u7ae0\u7bc0\u5c07\u4ecb\u7d39 RabbitMQ \u652f\u63f4\u7684\u4e0d\u540c\u4ea4\u63db\u6a5f\u985e\u578b\u53ca\u5176\u5177\u9ad4\u7528\u9014\uff0c\u5e6b\u52a9\u60a8\u6839\u64da\u9700\u6c42\u8a2d\u8a08\u9748\u6d3b\u7684\u6d88\u606f\u8def\u7531\u65b9\u6848\u3002</p>"},{"location":"rabbitmq/exchanges/#_1","title":"\u4ec0\u9ebc\u662f\u4ea4\u63db\u6a5f\uff1f","text":"<p>\u4ea4\u63db\u6a5f\u662f RabbitMQ \u4e2d\u6d88\u606f\u50b3\u8f38\u7684\u5165\u53e3\u9ede\uff0c\u751f\u7522\u8005\u5c07\u6d88\u606f\u767c\u9001\u5230\u4ea4\u63db\u6a5f\uff0c\u800c\u975e\u76f4\u63a5\u767c\u9001\u5230\u968a\u5217\u3002\u4ea4\u63db\u6a5f\u6839\u64da\u7d81\u5b9a\u898f\u5247\uff08Binding\uff09\u548c\u8def\u7531\u9375\uff08Routing Key\uff09\u6216\u6a19\u982d\uff08Headers\uff09\uff0c\u6c7a\u5b9a\u6d88\u606f\u61c9\u5206\u767c\u5230\u54ea\u4e9b\u968a\u5217\u3002</p>"},{"location":"rabbitmq/exchanges/#_2","title":"\u4ea4\u63db\u6a5f\u985e\u578b\u6982\u8ff0","text":"<p>RabbitMQ \u652f\u63f4\u4ee5\u4e0b\u4e3b\u8981\u4ea4\u63db\u6a5f\u985e\u578b\uff0c\u6bcf\u7a2e\u985e\u578b\u9069\u7528\u65bc\u4e0d\u540c\u5834\u666f\uff1a</p> <ul> <li>Direct Exchange\uff08\u76f4\u63a5\u4ea4\u63db\u6a5f\uff09\uff1a\u6839\u64da\u8def\u7531\u9375\u7cbe\u78ba\u5339\u914d\uff0c\u5c07\u6d88\u606f\u767c\u9001\u5230\u7d81\u5b9a\u7684\u968a\u5217\u3002\u9069\u5408\u9ede\u5c0d\u9ede\u901a\u4fe1\u3002</li> <li>Topic Exchange\uff08\u4e3b\u984c\u4ea4\u63db\u6a5f\uff09\uff1a\u6839\u64da\u8def\u7531\u9375\u7684\u6a21\u5f0f\u5339\u914d\uff0c\u5c07\u6d88\u606f\u767c\u9001\u5230\u7b26\u5408\u689d\u4ef6\u7684\u968a\u5217\u3002\u9069\u5408\u8907\u96dc\u8def\u7531\u9700\u6c42\u3002</li> <li>Fanout Exchange\uff08\u6247\u5f62\u4ea4\u63db\u6a5f\uff09\uff1a\u7121\u8996\u8def\u7531\u9375\uff0c\u5c07\u6d88\u606f\u5ee3\u64ad\u5230\u6240\u6709\u7d81\u5b9a\u7684\u968a\u5217\u3002\u9069\u5408\u767c\u5e03/\u8a02\u95b1\u6a21\u5f0f\u3002</li> <li>Headers Exchange\uff08\u6a19\u982d\u4ea4\u63db\u6a5f\uff09\uff1a\u57fa\u65bc\u6d88\u606f\u6a19\u982d\u800c\u975e\u8def\u7531\u9375\u9032\u884c\u5339\u914d\uff0c\u9748\u6d3b\u6027\u66f4\u9ad8\u4f46\u6027\u80fd\u7a0d\u4f4e\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/#_3","title":"\u672c\u7ae0\u7bc0\u5167\u5bb9\u6982\u8ff0","text":"<p>\u5728\u4ee5\u4e0b\u5b50\u7ae0\u7bc0\u4e2d\uff0c\u6211\u5011\u5c07\u8a73\u7d30\u4ecb\u7d39\u6bcf\u4e00\u7a2e\u4ea4\u63db\u6a5f\u985e\u578b\u7684\u5de5\u4f5c\u539f\u7406\u8207\u61c9\u7528\u5834\u666f\uff1a - Direct Exchange - Topic Exchange - Fanout Exchange - Headers Exchange</p>"},{"location":"rabbitmq/exchanges/#_4","title":"\u5b78\u7fd2\u76ee\u6a19","text":"<p>\u5b8c\u6210\u672c\u7ae0\u7bc0\u5f8c\uff0c\u60a8\u5c07\u80fd\u5920\uff1a - \u7406\u89e3\u4e0d\u540c\u4ea4\u63db\u6a5f\u985e\u578b\u7684\u5de5\u4f5c\u6a5f\u5236\u3002 - \u6839\u64da\u61c9\u7528\u5834\u666f\u9078\u64c7\u5408\u9069\u7684\u4ea4\u63db\u6a5f\u985e\u578b\u3002 - \u8a2d\u8a08\u9748\u6d3b\u7684\u6d88\u606f\u8def\u7531\u65b9\u6848\u3002</p> <p>\u8b93\u6211\u5011\u5f9e\u300cDirect Exchange\u300d\u958b\u59cb\uff0c\u9010\u6b65\u63a2\u7d22\u4ea4\u63db\u6a5f\u7684\u529f\u80fd\u8207\u7528\u6cd5\uff01</p> <p>\u63d0\u793a\uff1a\u4ea4\u63db\u6a5f\u662f RabbitMQ \u5be6\u73fe\u9748\u6d3b\u8def\u7531\u7684\u95dc\u9375\uff0c\u5408\u7406\u9078\u64c7\u4ea4\u63db\u6a5f\u985e\u578b\u53ef\u4ee5\u986f\u8457\u63d0\u5347\u7cfb\u7d71\u6548\u7387\u3002</p>"},{"location":"rabbitmq/exchanges/direct/","title":"Direct Exchange\uff08\u76f4\u63a5\u4ea4\u63db\u6a5f\uff09","text":"<p>Direct Exchange\uff08\u76f4\u63a5\u4ea4\u63db\u6a5f\uff09\u662f RabbitMQ \u4e2d\u6700\u7c21\u55ae\u7684\u4ea4\u63db\u6a5f\u985e\u578b\uff0c\u7528\u65bc\u7cbe\u78ba\u5339\u914d\u8def\u7531\u9375\u7684\u6d88\u606f\u5206\u767c\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u5176\u5de5\u4f5c\u539f\u7406\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"rabbitmq/exchanges/direct/#_1","title":"\u5de5\u4f5c\u539f\u7406","text":"<ul> <li>\u8def\u7531\u898f\u5247\uff1aDirect Exchange \u6839\u64da\u6d88\u606f\u7684\u8def\u7531\u9375\uff08Routing Key\uff09\u8207\u968a\u5217\u7d81\u5b9a\u6642\u6307\u5b9a\u7684\u9375\u9032\u884c\u5b8c\u5168\u5339\u914d\u3002</li> <li>\u5206\u767c\u908f\u8f2f\uff1a\u53ea\u6709\u7576\u8def\u7531\u9375\u8207\u7d81\u5b9a\u9375\u5b8c\u5168\u4e00\u81f4\u6642\uff0c\u6d88\u606f\u624d\u6703\u88ab\u5206\u767c\u5230\u5c0d\u61c9\u968a\u5217\u3002</li> <li>\u7279\u9ede\uff1a\u7c21\u55ae\u9ad8\u6548\uff0c\u9069\u5408\u9ede\u5c0d\u9ede\u901a\u4fe1\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/direct/#python-pika","title":"\u914d\u7f6e\u793a\u4f8b\uff08Python <code>pika</code>\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Python <code>pika</code> \u7a0b\u5f0f\u5eab\u914d\u7f6e Direct Exchange \u7684\u7c21\u55ae\u793a\u4f8b\uff1a <pre><code>import pika\n\n# \u5efa\u7acb\u9023\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\n# \u5ba3\u544a Direct Exchange\nchannel.exchange_declare(exchange='direct_tasks', exchange_type='direct')\n\n# \u5ba3\u544a\u968a\u5217\nchannel.queue_declare(queue='email_queue')\n\n# \u7d81\u5b9a\u968a\u5217\u5230\u4ea4\u63db\u6a5f\uff0c\u6307\u5b9a\u8def\u7531\u9375\nchannel.queue_bind(exchange='direct_tasks', queue='email_queue', routing_key='email')\n\n# \u767c\u9001\u6d88\u606f\nchannel.basic_publish(exchange='direct_tasks', routing_key='email', body='Send email task')\n\nprint(\"\u6d88\u606f\u5df2\u767c\u9001\")\nconnection.close()\n</code></pre></p>"},{"location":"rabbitmq/exchanges/direct/#_2","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u4efb\u52d9\u5206\u914d\uff1a\u5c07\u7279\u5b9a\u985e\u578b\u7684\u4efb\u52d9\uff08\u5982 <code>email</code> \u6216 <code>report</code>\uff09\u767c\u9001\u5230\u5c08\u7528\u968a\u5217\uff0c\u7531\u7279\u5b9a\u6d88\u8cbb\u8005\u8655\u7406\u3002</li> <li>\u7c21\u55ae\u8def\u7531\uff1a\u9700\u8981\u7cbe\u78ba\u63a7\u5236\u6d88\u606f\u6d41\u5411\u7684\u5834\u666f\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u5ee3\u64ad\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/direct/#_3","title":"\u5c0f\u7d50","text":"<p>Direct Exchange \u901a\u904e\u7cbe\u78ba\u5339\u914d\u8def\u7531\u9375\u5be6\u73fe\u7c21\u55ae\u9ad8\u6548\u7684\u6d88\u606f\u5206\u767c\uff0c\u9069\u5408\u9700\u8981\u9ede\u5c0d\u9ede\u901a\u4fe1\u7684\u5834\u666f\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cTopic Exchange\u300d\uff0c\u63a2\u7d22\u66f4\u9748\u6d3b\u7684\u6a21\u5f0f\u5339\u914d\u8def\u7531\u6a5f\u5236\u3002</p> <p>\u63d0\u793a\uff1aDirect Exchange \u662f\u6700\u5e38\u7528\u7684\u4ea4\u63db\u6a5f\u985e\u578b\u4e4b\u4e00\uff0c\u9069\u5408\u5927\u591a\u6578\u7c21\u55ae\u4efb\u52d9\u5206\u767c\u9700\u6c42\u3002</p>"},{"location":"rabbitmq/exchanges/fanout/","title":"Fanout Exchange\uff08\u6247\u5f62\u4ea4\u63db\u6a5f\uff09","text":"<p>Fanout Exchange\uff08\u6247\u5f62\u4ea4\u63db\u6a5f\uff09\u662f RabbitMQ \u4e2d\u7528\u65bc\u5ee3\u64ad\u6d88\u606f\u7684\u4ea4\u63db\u6a5f\u985e\u578b\uff0c\u9069\u5408\u767c\u5e03/\u8a02\u95b1\u6a21\u5f0f\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u5176\u5de5\u4f5c\u539f\u7406\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"rabbitmq/exchanges/fanout/#_1","title":"\u5de5\u4f5c\u539f\u7406","text":"<ul> <li>\u8def\u7531\u898f\u5247\uff1aFanout Exchange \u7121\u8996\u8def\u7531\u9375\uff08Routing Key\uff09\uff0c\u5c07\u6d88\u606f\u5206\u767c\u5230\u6240\u6709\u7d81\u5b9a\u7684\u968a\u5217\u3002</li> <li>\u5206\u767c\u908f\u8f2f\uff1a\u53ea\u8981\u968a\u5217\u8207\u4ea4\u63db\u6a5f\u7d81\u5b9a\uff0c\u6240\u6709\u6d88\u606f\u90fd\u6703\u88ab\u8907\u88fd\u4e26\u767c\u9001\u5230\u9019\u4e9b\u968a\u5217\u3002</li> <li>\u7279\u9ede\uff1a\u7c21\u55ae\u9ad8\u6548\uff0c\u9069\u5408\u5ee3\u64ad\u901a\u4fe1\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/fanout/#python-pika","title":"\u914d\u7f6e\u793a\u4f8b\uff08Python <code>pika</code>\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Python <code>pika</code> \u7a0b\u5f0f\u5eab\u914d\u7f6e Fanout Exchange \u7684\u7c21\u55ae\u793a\u4f8b\uff1a <pre><code>import pika\n\n# \u5efa\u7acb\u9023\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\n# \u5ba3\u544a Fanout Exchange\nchannel.exchange_declare(exchange='fanout_notifications', exchange_type='fanout')\n\n# \u5ba3\u544a\u968a\u5217\nchannel.queue_declare(queue='notification_queue1')\nchannel.queue_declare(queue='notification_queue2')\n\n# \u7d81\u5b9a\u968a\u5217\u5230\u4ea4\u63db\u6a5f\uff08\u7121\u9700\u8def\u7531\u9375\uff09\nchannel.queue_bind(exchange='fanout_notifications', queue='notification_queue1')\nchannel.queue_bind(exchange='fanout_notifications', queue='notification_queue2')\n\n# \u767c\u9001\u6d88\u606f\nchannel.basic_publish(exchange='fanout_notifications', routing_key='', body='System notification')\n\nprint(\"\u6d88\u606f\u5df2\u767c\u9001\")\nconnection.close()\n</code></pre></p>"},{"location":"rabbitmq/exchanges/fanout/#_2","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u7cfb\u7d71\u901a\u77e5\uff1a\u5c07\u901a\u77e5\u6d88\u606f\u5ee3\u64ad\u5230\u6240\u6709\u8a02\u95b1\u8005\uff0c\u5982\u61c9\u7528\u66f4\u65b0\u6216\u7cfb\u7d71\u7dad\u8b77\u516c\u544a\u3002</li> <li>\u5373\u6642\u66f4\u65b0\uff1a\u5c07\u72c0\u614b\u8b8a\u5316\u901a\u77e5\u6240\u6709\u76f8\u95dc\u7d44\u4ef6\uff0c\u5982\u50f9\u683c\u8b8a\u52d5\u6216\u5eab\u5b58\u66f4\u65b0\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/fanout/#_3","title":"\u5c0f\u7d50","text":"<p>Fanout Exchange \u901a\u904e\u5ee3\u64ad\u6a5f\u5236\u5be6\u73fe\u7c21\u55ae\u9ad8\u6548\u7684\u6d88\u606f\u5206\u767c\uff0c\u9069\u5408\u767c\u5e03/\u8a02\u95b1\u6a21\u5f0f\u7684\u5834\u666f\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cHeaders Exchange\u300d\uff0c\u63a2\u7d22\u57fa\u65bc\u6a19\u982d\u7684\u8def\u7531\u6a5f\u5236\u3002</p> <p>\u63d0\u793a\uff1aFanout Exchange \u9069\u5408\u9700\u8981\u5ee3\u64ad\u7684\u5834\u666f\uff0c\u4f46\u53ef\u80fd\u5c0e\u81f4\u6d88\u606f\u904e\u591a\uff0c\u9700\u5408\u7406\u63a7\u5236\u8a02\u95b1\u8005\u6578\u91cf\u3002</p>"},{"location":"rabbitmq/exchanges/headers/","title":"Headers Exchange\uff08\u6a19\u982d\u4ea4\u63db\u6a5f\uff09","text":"<p>Headers Exchange\uff08\u6a19\u982d\u4ea4\u63db\u6a5f\uff09\u662f RabbitMQ \u4e2d\u57fa\u65bc\u6d88\u606f\u6a19\u982d\u9032\u884c\u8def\u7531\u7684\u4ea4\u63db\u6a5f\u985e\u578b\uff0c\u9069\u5408\u9700\u8981\u9ad8\u9748\u6d3b\u6027\u7684\u5834\u666f\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u5176\u5de5\u4f5c\u539f\u7406\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"rabbitmq/exchanges/headers/#_1","title":"\u5de5\u4f5c\u539f\u7406","text":"<ul> <li>\u8def\u7531\u898f\u5247\uff1aHeaders Exchange \u6839\u64da\u6d88\u606f\u7684\u6a19\u982d\uff08Headers\uff09\u800c\u975e\u8def\u7531\u9375\u9032\u884c\u5339\u914d\u3002</li> <li>\u5206\u767c\u908f\u8f2f\uff1a\u968a\u5217\u7d81\u5b9a\u6642\u6307\u5b9a\u6a19\u982d\u689d\u4ef6\uff0c\u6d88\u606f\u6a19\u982d\u7b26\u5408\u689d\u4ef6\u6642\u6703\u88ab\u5206\u767c\u5230\u5c0d\u61c9\u968a\u5217\u3002</li> <li>\u5339\u914d\u6a21\u5f0f\uff1a</li> <li><code>x-match=all</code>\uff1a\u6d88\u606f\u6a19\u982d\u5fc5\u9808\u5b8c\u5168\u7b26\u5408\u6240\u6709\u6307\u5b9a\u689d\u4ef6\u3002</li> <li><code>x-match=any</code>\uff1a\u6d88\u606f\u6a19\u982d\u7b26\u5408\u4efb\u4e00\u689d\u4ef6\u5373\u53ef\u3002</li> <li>\u7279\u9ede\uff1a\u9748\u6d3b\u6027\u9ad8\uff0c\u4f46\u6027\u80fd\u76f8\u5c0d\u5176\u4ed6\u4ea4\u63db\u6a5f\u985e\u578b\u7a0d\u4f4e\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/headers/#python-pika","title":"\u914d\u7f6e\u793a\u4f8b\uff08Python <code>pika</code>\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Python <code>pika</code> \u7a0b\u5f0f\u5eab\u914d\u7f6e Headers Exchange \u7684\u7c21\u55ae\u793a\u4f8b\uff1a <pre><code>import pika\n\n# \u5efa\u7acb\u9023\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\n# \u5ba3\u544a Headers Exchange\nchannel.exchange_declare(exchange='headers_tasks', exchange_type='headers')\n\n# \u5ba3\u544a\u968a\u5217\nchannel.queue_declare(queue='priority_tasks')\n\n# \u7d81\u5b9a\u968a\u5217\u5230\u4ea4\u63db\u6a5f\uff0c\u6307\u5b9a\u6a19\u982d\u689d\u4ef6\nbind_args = {'x-match': 'all', 'priority': 'high', 'type': 'urgent'}\nchannel.queue_bind(exchange='headers_tasks', queue='priority_tasks', arguments=bind_args)\n\n# \u767c\u9001\u6d88\u606f\uff0c\u8a2d\u7f6e\u6a19\u982d\nheaders = {'priority': 'high', 'type': 'urgent'}\nchannel.basic_publish(\n    exchange='headers_tasks',\n    routing_key='',\n    body='Urgent high-priority task',\n    properties=pika.BasicProperties(headers=headers)\n)\n\nprint(\"\u6d88\u606f\u5df2\u767c\u9001\")\nconnection.close()\n</code></pre></p>"},{"location":"rabbitmq/exchanges/headers/#_2","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u8907\u96dc\u689d\u4ef6\u8def\u7531\uff1a\u6839\u64da\u591a\u500b\u6d88\u606f\u5c6c\u6027\uff08\u5982\u512a\u5148\u7d1a\u3001\u985e\u578b\uff09\u9032\u884c\u7cbe\u7d30\u5206\u767c\u3002</li> <li>\u696d\u52d9\u908f\u8f2f\u5206\u767c\uff1a\u6839\u64da\u6d88\u606f\u5143\u6578\u64da\uff08\u5982\u4f86\u6e90\u3001\u7248\u672c\uff09\u6c7a\u5b9a\u8655\u7406\u8def\u5f91\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/headers/#_3","title":"\u5c0f\u7d50","text":"<p>Headers Exchange \u901a\u904e\u6a19\u982d\u5339\u914d\u5be6\u73fe\u9ad8\u5ea6\u9748\u6d3b\u7684\u6d88\u606f\u5206\u767c\uff0c\u9069\u5408\u8907\u96dc\u689d\u4ef6\u8def\u7531\u7684\u5834\u666f\u3002\u96d6\u7136\u6027\u80fd\u7a0d\u4f4e\uff0c\u4f46\u5728\u9700\u8981\u57fa\u65bc\u591a\u5c6c\u6027\u6c7a\u7b56\u6642\u975e\u5e38\u6709\u7528\u3002</p> <p>\u63d0\u793a\uff1aHeaders Exchange \u9069\u5408\u7279\u5b9a\u9700\u6c42\u5834\u666f\uff0c\u82e5\u8def\u7531\u9700\u6c42\u7c21\u55ae\uff0c\u5efa\u8b70\u512a\u5148\u8003\u616e\u5176\u4ed6\u4ea4\u63db\u6a5f\u985e\u578b\u4ee5\u63d0\u5347\u6027\u80fd\u3002</p>"},{"location":"rabbitmq/exchanges/topic/","title":"Topic Exchange\uff08\u4e3b\u984c\u4ea4\u63db\u6a5f\uff09","text":"<p>Topic Exchange\uff08\u4e3b\u984c\u4ea4\u63db\u6a5f\uff09\u662f RabbitMQ \u4e2d\u7528\u65bc\u6a21\u5f0f\u5339\u914d\u7684\u6d88\u606f\u5206\u767c\u7d44\u4ef6\uff0c\u9069\u5408\u8907\u96dc\u8def\u7531\u9700\u6c42\u3002\u672c\u6587\u5c07\u4ecb\u7d39\u5176\u5de5\u4f5c\u539f\u7406\u8207\u61c9\u7528\u5834\u666f\u3002</p>"},{"location":"rabbitmq/exchanges/topic/#_1","title":"\u5de5\u4f5c\u539f\u7406","text":"<ul> <li>\u8def\u7531\u898f\u5247\uff1aTopic Exchange \u6839\u64da\u8def\u7531\u9375\u7684\u6a21\u5f0f\u5339\u914d\u9032\u884c\u6d88\u606f\u5206\u767c\uff0c\u652f\u6301\u901a\u914d\u7b26 <code>*</code>\uff08\u5339\u914d\u55ae\u8a5e\uff09\u548c <code>#</code>\uff08\u5339\u914d\u591a\u8a5e\uff09\u3002</li> <li>\u5206\u767c\u908f\u8f2f\uff1a\u968a\u5217\u7d81\u5b9a\u6642\u6307\u5b9a\u6a21\u5f0f\uff0c\u6d88\u606f\u7684\u8def\u7531\u9375\u7b26\u5408\u6a21\u5f0f\u6642\u6703\u88ab\u5206\u767c\u5230\u5c0d\u61c9\u968a\u5217\u3002</li> <li>\u7279\u9ede\uff1a\u9748\u6d3b\u5f37\u5927\uff0c\u9069\u5408\u591a\u5c64\u6b21\u7684\u4e8b\u4ef6\u5206\u985e\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/topic/#_2","title":"\u901a\u914d\u7b26\u8aaa\u660e","text":"<ul> <li><code>*</code>\uff1a\u5339\u914d\u55ae\u500b\u8a5e\uff0c\u4f8b\u5982 <code>log.*</code> \u53ef\u5339\u914d <code>log.error</code> \u6216 <code>log.info</code>\uff0c\u4f46\u4e0d\u5339\u914d <code>log.error.critical</code>\u3002</li> <li><code>#</code>\uff1a\u5339\u914d\u96f6\u500b\u6216\u591a\u500b\u8a5e\uff0c\u4f8b\u5982 <code>user.#</code> \u53ef\u5339\u914d <code>user.login</code> \u6216 <code>user.login.success</code>\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/topic/#python-pika","title":"\u914d\u7f6e\u793a\u4f8b\uff08Python <code>pika</code>\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Python <code>pika</code> \u7a0b\u5f0f\u5eab\u914d\u7f6e Topic Exchange \u7684\u7c21\u55ae\u793a\u4f8b\uff1a <pre><code>import pika\n\n# \u5efa\u7acb\u9023\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\n# \u5ba3\u544a Topic Exchange\nchannel.exchange_declare(exchange='topic_logs', exchange_type='topic')\n\n# \u5ba3\u544a\u968a\u5217\nchannel.queue_declare(queue='error_logs')\n\n# \u7d81\u5b9a\u968a\u5217\u5230\u4ea4\u63db\u6a5f\uff0c\u6307\u5b9a\u6a21\u5f0f\nchannel.queue_bind(exchange='topic_logs', queue='error_logs', routing_key='*.error')\n\n# \u767c\u9001\u6d88\u606f\nchannel.basic_publish(exchange='topic_logs', routing_key='app.error', body='Error log message')\n\nprint(\"\u6d88\u606f\u5df2\u767c\u9001\")\nconnection.close()\n</code></pre></p>"},{"location":"rabbitmq/exchanges/topic/#_3","title":"\u61c9\u7528\u5834\u666f","text":"<ul> <li>\u65e5\u8a8c\u7cfb\u7d71\uff1a\u6839\u64da\u65e5\u8a8c\u7b49\u7d1a\u6216\u4f86\u6e90\u5206\u767c\u6d88\u606f\uff0c\u5982 <code>app.error</code> \u6216 <code>server.warning</code>\u3002</li> <li>\u4e8b\u4ef6\u901a\u77e5\uff1a\u6839\u64da\u4e8b\u4ef6\u985e\u578b\u6216\u5c64\u6b21\u7d50\u69cb\u5206\u767c\u6d88\u606f\uff0c\u5982 <code>user.login.success</code> \u6216 <code>user.logout</code>\u3002</li> </ul>"},{"location":"rabbitmq/exchanges/topic/#_4","title":"\u5c0f\u7d50","text":"<p>Topic Exchange \u901a\u904e\u6a21\u5f0f\u5339\u914d\u5be6\u73fe\u9748\u6d3b\u7684\u6d88\u606f\u5206\u767c\uff0c\u9069\u5408\u9700\u8981\u5206\u985e\u6216\u5c64\u6b21\u5316\u8def\u7531\u7684\u5834\u666f\u3002\u4e0b\u4e00\u7ae0\u7bc0\uff0c\u6211\u5011\u5c07\u4ecb\u7d39\u300cFanout Exchange\u300d\uff0c\u63a2\u7d22\u5ee3\u64ad\u5f0f\u6d88\u606f\u5206\u767c\u6a5f\u5236\u3002</p> <p>\u63d0\u793a\uff1aTopic Exchange \u662f\u8655\u7406\u8907\u96dc\u8def\u7531\u9700\u6c42\u7684\u6700\u4f73\u9078\u64c7\uff0c\u4f46\u6a21\u5f0f\u8a2d\u8a08\u9700\u8b39\u614e\u4ee5\u907f\u514d\u904e\u5ea6\u5339\u914d\u3002</p>"}]}